---
aliases: [Transpilers, Транспиляторы, Транспиляция кода, Компиляторы]
tags: [frontend, architecture, build-tools, javascript]
---

# Транспиляторы

## Обзор

Транспиляторы - это инструменты, которые преобразуют код из одного языка программирования в другой язык на том же уровне абстракции. В контексте фронтенд-разработки транспиляторы обычно преобразуют современный JavaScript (ES2015+) в более совместимые версии, а также могут конвертировать TypeScript, JSX и другие синтаксические расширения.

## Основные функции транспиляторов

- **Преобразование синтаксиса** - конвертация современных фич в совместимые
- **Поддержка синтаксических расширений** - JSX, TypeScript и т.д.
- **Полифилы** - добавление отсутствующих функций
- **Модульная система** - преобразование ES-модулей в другие форматы
- **Оптимизация кода** - удаление неиспользуемых частей

## Популярные транспиляторы

### 1. Babel

> [!info] Babel
> Один из самых популярных транспиляторов JavaScript, поддерживающий современные фичи и синтаксические расширения.

```javascript
// .babelrc.js
module.exports = {
  presets: [
    ['@babel/preset-env', {
      targets: {
        browsers: ['> 1%', 'last 2 versions']
      },
      useBuiltIns: 'usage',
      corejs: 3
    }],
    '@babel/preset-react',
    '@babel/preset-typescript'
  ],
  plugins: [
    '@babel/plugin-proposal-class-properties',
    '@babel/plugin-proposal-private-methods',
    ['@babel/plugin-transform-runtime', {
      regenerator: true
    }]
  ]
};
```

Пример транспиляции:

```javascript
// До (ES2015+)
const numbers = [1, 2, 3];
const doubled = numbers.map(n => n * 2);
const user = { name: 'John', age: 30 };
const { name } = user;

// После транспиляции Babel
var numbers = [1, 2, 3];
var doubled = numbers.map(function(n) { return n * 2; });
var user = { name: 'John', age: 30 };
var name = user.name;
```

### 2. TypeScript

> [!info] TypeScript
> Транспилятор, который добавляет статическую типизацию к JavaScript и преобразует TypeScript в JavaScript.

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "lib": ["ES2020", "DOM"],
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "moduleResolution": "node",
    "allowSyntheticDefaultImports": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true
  },
  "include": ["src"]
}
```

Пример транспиляции TypeScript:

```typescript
// До (TypeScript)
interface User {
  name: string;
  age: number;
}

const greet = (user: User): string => {
  return `Hello, ${user.name}!`;
};

// После транспиляции (JavaScript)
const greet = (user) => {
  return `Hello, ${user.name}!`;
};
```

### 3. SWC (Speedy Web Compiler)

> [!info] SWC
> Современный транспилятор, написанный на Rust, обеспечивающий высокую производительность.

```javascript
// .swcrc
{
  "jsc": {
    "parser": {
      "syntax": "typescript",
      "tsx": true,
      "decorators": true,
      "dynamicImport": true
    },
    "transform": {
      "react": {
        "runtime": "automatic"
      }
    },
    "target": "es2020"
  },
  "module": {
    "type": "es6"
  }
}
```

### 4. Sucrase

> [!info] Sucrase
> Быстрый транспилятор, ориентированный на современные проекты, который пропускает сложные преобразования.

```javascript
// Пример использования в сборке
const sucrase = require('@sucrase/jest-plugin');

module.exports = {
  transform: {
    '\\.(js|jsx|ts|tsx)$': sucrase
  }
};
```

## Настройка транспиляции

### Поддержка браузеров

```json
// browserslist в package.json
{
  "browserslist": [
    "> 1%",
    "last 2 versions",
    "not dead"
  ]
}
```

### Полифилы и runtime

```javascript
// Использование @babel/runtime для изолированных полифилов
{
  "presets": [
    ["@babel/preset-env", {
      "useBuiltIns": "usage",
      "corejs": 3
    }]
  ],
  "plugins": [
    ["@babel/plugin-transform-runtime", {
      "regenerator": true
    }]
  ]
}
```

## Транспиляция JSX

```javascript
// До (JSX)
const App = () => (
  <div className="app">
    <h1>Hello World</h1>
  </div>
);

// После транспиляции Babel
const App = () => /*#__PURE__*/React.createElement("div", {
  className: "app"
}, /*#__PURE__*/React.createElement("h1", null, "Hello World"));
```

## Современные фичи и их транспиляция

### Async/Await

```javascript
// До
async function fetchData() {
  const response = await fetch('/api/data');
  const data = await response.json();
  return data;
}

// После транспиляции (с использованием regeneratorRuntime)
function fetchData() {
  return _fetchData.apply(this, arguments);
}

function _fetchData() {
  _fetchData = _asyncToGenerator(function* () {
    const response = yield fetch('/api/data');
    const data = yield response.json();
    return data;
  });
  return _fetchData.apply(this, arguments);
}
```

### Деструктуризация

```javascript
// До
const { name, age } = user;
const [first, ...rest] = items;

// После транспиляции
const name = user.name;
const age = user.age;
const first = items[0];
const rest = items.slice(1);
```

## Интеграция с системами сборки

### Webpack

```javascript
// webpack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.(js|jsx)$/,
        exclude: /node_modules/,
        use: {
          loader: 'babel-loader'
        }
      }
    ]
  }
};
```

### Vite

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()] // Включает транспиляцию JSX
});
```

## Лучшие практики

1. **Используйте современные фичи** с правильной настройкой транспиляции
2. **Ограничьте цели поддержки** для оптимизации бандла
3. **Используйте изолированные полифилы** вместо глобальных
4. **Проверяйте производительность** транспиляции в процессе разработки
5. **Обновляйте конфигурацию** по мере изменения целей поддержки

## Сравнение транспиляторов

| Транспилятор | Скорость | Функции | Сложность | Использование |
|--------------|----------|---------|------------|----------------|
| Babel | Средняя | Все фичи | Средняя | Универсальный выбор |
| TypeScript | Средняя | Типизация | Средняя | TypeScript проекты |
| SWC | Высокая | Основные фичи | Низкая | Современные проекты |
| Sucrase | Очень высокая | Основные фичи | Низкая | Быстрая разработка |

## См. также

- [[Системы-сборки]]
- [[Бандлеры]]
- [[Линтеры]]
- [[Форматтеры]]
- [[Webpack]]
- [[TypeScript]]
- [[Babel]]

## Ключевые выводы

- Транспиляторы обеспечивают совместимость современного кода с браузерами
- Выбор транспилятора зависит от требований к производительности и функциональности
- Правильная настройка транспиляции критична для производительности и совместимости