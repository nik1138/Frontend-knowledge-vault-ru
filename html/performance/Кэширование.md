---
aliases: [HTTP-кеширование, Кеширование ресурсов, Браузерное кэширование]
tags: [html, performance, caching, web-development, frontend]
---

# Кэширование

Кэширование - один из самых эффективных способов улучшить производительность веб-сайтов. Правильная настройка кэширования позволяет избежать повторных загрузок ресурсов, что особенно важно в условиях российского интернета с его особенностями пропускной способности и надежности соединений.

## Введение

Кэширование позволяет браузеру хранить копии ресурсов (HTML, CSS, JavaScript, изображения) локально, чтобы не загружать их снова при следующем посещении страницы. Это значительно ускоряет время загрузки и уменьшает трафик.

## Типы кэширования

### 1. Браузерное кэширование

Браузерное кэширование использует HTTP-заголовки для определения срока действия ресурсов:

- **Cache-Control** - основной заголовок для управления кэшированием
- **Expires** - устаревший заголовок, но все еще используется
- **ETag** - проверка целостности ресурса
- **Last-Modified** - дата последнего изменения

### 2. Кэширование на уровне сервера

- Кэширование на уровне HTTP-сервера (nginx, Apache)
- Кэширование на уровне приложения
- Кэширование на уровне базы данных

### 3. CDN-кеширование

- Глобальные и локальные CDN-провайдеры
- Кэширование на границе сети (edge caching)

## HTTP-заголовки кэширования

### Cache-Control

Наиболее важный заголовок для управления кэшированием:

```http
Cache-Control: max-age=3600
```

Основные директивы:

- `max-age=<seconds>` - время жизни ресурса в секундах
- `public` - ресурс может быть закеширован любым кешем
- `private` - ресурс кешируется только браузером
- `no-cache` - перед использованием нужно проверить актуальность
- `no-store` - не кешировать вообще
- `must-revalidate` - обязательная проверка при истечении max-age

### Практические примеры настройки

#### Для статических ресурсов (CSS, JS, изображения):

```http
Cache-Control: public, max-age=31536000, immutable
```

#### Для HTML-файлов:

```http
Cache-Control: public, max-age=0, must-revalidate
```

#### Для API-ответов:

```http
Cache-Control: private, max-age=600
```

## Стратегии кэширования

### 1. Стратегия "Cache-First"

- Сначала проверяется кэш
- Если ресурс отсутствует в кэше, загружается с сервера
- Подходит для статических ресурсов

### 2. Стратегия "Network-First"

- Сначала делается запрос к сети
- Если сеть недоступна, используется кэш
- Подходит для актуального контента

### 3. Стратегия "Stale-While-Revalidate"

- Используется устаревший кэш, но фоном обновляется
- Обеспечивает быструю загрузку и актуальность данных

## Service Worker и Application Cache

### Service Worker

Современный подход к кэшированию:

```javascript
const CACHE_NAME = 'my-site-v1';
const urlsToCache = [
  '/',
  '/styles/main.css',
  '/script/main.js'
];

self.addEventListener('install', function(event) {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(function(cache) {
        return cache.addAll(urlsToCache);
      })
  );
});
```

### Application Cache (устаревший)

Не рекомендуется использовать, так как имеет много ограничений и проблем.

## Кэширование в российских условиях

### Особенности российского интернета

- Нестабильное соединение в некоторых регионах
- Ограничения пропускной способности
- Необходимость учета времени на доставку пакетов

### Рекомендации для российских разработчиков

- Использовать локальные CDN для ускорения доставки
- Увеличивать сроки кэширования для статических ресурсов
- Обеспечивать резервные копии критических ресурсов
- Использовать прогрессивное кэширование

### Российские CDN-провайдеры

- [[CDN-провайдеры-в-России]]
- Использование локальных решений для улучшения производительности
- Резервирование ресурсов на случай блокировок

## Типичные ошибки при настройке кэширования

### 1. Слишком короткие сроки кэширования

- Увеличивает количество HTTP-запросов
- Увеличивает нагрузку на сервер
- Замедляет загрузку страниц

### 2. Отсутствие версионирования ресурсов

- Изменения не отображаются у пользователей
- Необходимость принудительного обновления

### 3. Неправильное кэширование динамического контента

- Пользователи видят устаревшую информацию
- Проблемы с актуальностью данных

## Практические рекомендации

### 1. Использование версионирования ресурсов

```html
<link rel="stylesheet" href="/styles/main.css?v=1.2.3">
<script src="/script/main.js?version=20250101"></script>
```

Или через хэши:

```html
<link rel="stylesheet" href="/styles/main.a1b2c3d4.css">
<script src="/script/main.e5f6g7h8.js"></script>
```

### 2. Настройка кэширования для разных типов файлов

| Тип файла | Рекомендуемый Cache-Control |
|-----------|----------------------------|
| HTML | no-cache, must-revalidate |
| CSS/JS | max-age=31536000, immutable |
| Изображения | max-age=31536000 |
| Шрифты | max-age=31536000 |
| API-ответы | max-age=300-600 |

### 3. Мониторинг эффективности кэширования

- Анализ HTTP-заголовков в DevTools
- Использование инструментов аналитики
- Проверка Hit Rate кэша

## Современные подходы

### HTTP/2 Server Push

Позволяет серверу отправить ресурсы до того, как браузер запросит их:

```nginx
location / {
    http2_push /styles/main.css;
    http2_push /script/main.js;
}
```

### Cache Digest

Экспериментальная технология для более эффективного управления кэшем.

## Заключение

Правильное кэширование - один из самых эффективных способов улучшить производительность веб-сайтов. Особенно в российских условиях, где стабильность и скорость интернет-соединения могут варьироваться, грамотная настройка кэширования позволяет значительно улучшить пользовательский опыт.

## См. также

- [[Приоритезация-ресурсов]]
- [[Оптимизация-рендеринга]]
- [[Производительность-и-SEO]]
- [[Мониторинг-производительности]]
- [[CDN-провайдеры-в-России]]
- [[Сжатие-ресурсов]]

#html #performance #caching #web-development #frontend