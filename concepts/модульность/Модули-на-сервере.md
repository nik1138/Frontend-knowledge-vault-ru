---
aliases: ["Серверные модули", "Модули Node.js", "Backend модули"]
tags: [javascript, nodejs, модульность, сервер, бэкенд, фронтенд]
---

# Модули на сервере

**Модули на сервере** - это подход к организации кода на серверной стороне, позволяющий разделять функциональность на независимые, переиспользуемые части. В контексте веб-разработки модули на сервере играют важную роль в построении масштабируемых и поддерживаемых приложений.

## Основные понятия

Серверные модули позволяют:
- Разделять код на логические блоки
- Управлять зависимостями между частями приложения
- Повторно использовать код в разных проектах
- Изолировать функциональность для лучшей тестируемости

## Типы серверных модулей

### 1. Встроенные модули Node.js

Node.js поставляется с множеством встроенных модулей, таких как:
- `fs` - для работы с файловой системой
- `http` - для создания HTTP-серверов
- `path` - для работы с путями файлов
- `crypto` - для криптографических операций

```javascript
// Пример использования встроенного модуля
const fs = require('fs');
const path = require('path');

// Асинхронное чтение файла
fs.readFile(path.join(__dirname, 'data.txt'), 'utf8', (err, data) => {
  if (err) throw err;
  console.log(data);
});
```

### 2. Модули CommonJS

Это стандартная система модулей для Node.js, использующая `require()` и `module.exports`.

```javascript
// math.js - экспорт функций
function add(a, b) {
  return a + b;
}

function subtract(a, b) {
  return a - b;
}

module.exports = {
  add,
  subtract
};

// app.js - импорт и использование
const math = require('./math');
console.log(math.add(5, 3)); // 8
```

### 3. Модули ES6 (ESM)

Современная система модулей, использующая `import` и `export`.

```javascript
// utils.js
export const formatDate = (date) => {
  return date.toLocaleDateString();
};

export const validateEmail = (email) => {
  const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return re.test(email);
};

export default function greet(name) {
  return `Привет, ${name}!`;
}

// main.js
import greet, { formatDate, validateEmail } from './utils.js';

console.log(greet('Алексей'));
console.log(formatDate(new Date()));
console.log(validateEmail('test@example.com'));
```

## Практическое применение в фронтенд-разработке

### 1. Модули API

Создание модулей для работы с API позволяет централизовать логику запросов:

```javascript
// api.js
class ApiClient {
  constructor(baseURL) {
    this.baseURL = baseURL;
  }

  async get(endpoint) {
    const response = await fetch(`${this.baseURL}${endpoint}`);
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    return await response.json();
  }

  async post(endpoint, data) {
    const response = await fetch(`${this.baseURL}${endpoint}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    });
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    return await response.json();
  }
}

export default ApiClient;
```

### 2. Модули конфигурации

```javascript
// config.js
const config = {
  apiUrl: process.env.NODE_ENV === 'production' 
    ? 'https://api.example.com' 
    : 'http://localhost:3000',
  timeout: 5000,
  retries: 3
};

export default config;
```

### 3. Модули middleware

В фреймворках типа Express.js:

```javascript
// middleware/auth.js
export const authenticate = (req, res, next) => {
  const token = req.headers.authorization;
  
  if (!token) {
    return res.status(401).json({ error: 'Токен аутентификации отсутствует' });
  }
  
  try {
    // Проверка токена
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded;
    next();
  } catch (error) {
    res.status(401).json({ error: 'Невалидный токен' });
  }
};
```

## Сравнение систем модулей

| Характеристика | CommonJS | ES Modules |
|----------------|----------|------------|
| Синтаксис | require()/module.exports | import/export |
| Загрузка | Runtime | Compile-time |
| Поддержка циклических зависимостей | Да | Да, но по-разному |
| Поддержка в Node.js | С рождения | С версии 12+ |
| Поддержка в браузерах | Нет | Да |

## Лучшие практики

1. **Используйте ES Modules** при возможности, так как это стандарт будущего
2. **Организуйте код по функциональным модулям** - аутентификация, работа с данными, утилиты
3. **Избегайте циклических зависимостей** - они усложняют понимание и тестирование кода
4. **Документируйте публичные API модулей** - экспортимые функции и их параметры
5. **Разделяйте конфигурацию и бизнес-логику** - модули конфигурации не должны содержать сложной логики

## Паттерны организации модулей

### 1. Модуль-фасад

```javascript
// api/index.js
import userApi from './user.js';
import productApi from './product.js';
import orderApi from './order.js';

export default {
  user: userApi,
  product: productApi,
  order: orderApi
};
```

### 2. Модуль-фабрика

```javascript
// database.js
export const createDatabaseConnection = (config) => {
  return {
    connect: () => { /* логика подключения */ },
    query: (sql) => { /* логика запроса */ },
    disconnect: () => { /* логика отключения */ }
  };
};
```

## Связанные концепции

- [[Модульные-системы]]
- [[Динамические-импорты]]
- [[Компонентная-архитектура]]
- [[Функциональное-программирование]]
- [[Серверный рендеринг]]

## Внешние ресурсы

- [Node.js Modules Documentation](https://nodejs.org/api/modules.html)
- [ES Modules in Node.js](https://nodejs.org/api/esm.html)
- [CommonJS Specification](http://wiki.commonjs.org/wiki/Modules/1.1)