# Тестирование производительности

## Свойства
```yaml
tags: [testing, frontend, performance-testing, optimization, metrics]
aliases: [Performance Testing, Тестирование производительности веб-приложений]
```

## Обзор
Тестирование производительности — это вид тестирования, направленный на оценку скорости, стабильности, масштабируемости и других характеристик производительности приложения. В контексте фронтенд-разработки это включает в себя измерение времени загрузки страниц, времени отклика интерфейса, использования памяти, энергопотребления и других метрик, влияющих на пользовательский опыт.

## Подробности

### Что тестируется
- Время загрузки страницы (LCP, FCP, FID)
- Время отклика интерфейса
- Использование памяти
- Потребление CPU
- Энергопотребление
- Стабильность приложения при высокой нагрузке

### Принципы
- **Метрики**: использовать стандартные метрики веб-производительности
- **Сравнение**: сравнивать результаты с предыдущими версиями
- **Реальные условия**: тестировать в условиях, близких к реальным
- **Автоматизация**: интегрировать в CI/CD процессы
- **Мониторинг**: отслеживать производительность в production

### Популярные инструменты
- Lighthouse
- WebPageTest
- Chrome DevTools
- Performance API
- Puppeteer/Playwright (для автоматизированных тестов)
- Web Vitals

### Примеры

#### Автоматизированный тест с Puppeteer
```javascript
// performance.test.js
const puppeteer = require('puppeteer');

async function measurePerformance(url) {
  const browser = await puppeteer.launch();
  const page = await browser.newPage();
  
  // Включаем трассировку производительности
  await page.tracing.start({ path: 'trace.json' });
  await page.goto(url);
  await page.tracing.stop();
  
  // Получаем метрики производительности
  const metrics = await page.metrics();
  console.log('Performance metrics:', metrics);
  
  await browser.close();
}

measurePerformance('https://example.com');
```

#### Измерение Web Vitals
```javascript
// web-vitals.js
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

function sendToAnalytics(metric) {
  // Отправляем метрики в аналитическую систему
  console.log(metric);
}

getCLS(sendToAnalytics);
getFID(sendToAnalytics);
getFCP(sendToAnalytics);
getLCP(sendToAnalytics);
getTTFB(sendToAnalytics);
```

#### Тест с использованием Lighthouse CI
```javascript
// lighthouse.test.js
const lighthouse = require('lighthouse');
const chromeLauncher = require('chrome-launcher');

async function runLighthouse(url) {
  const chrome = await chromeLauncher.launch({ chromeFlags: ['--headless'] });
  const options = { logLevel: 'info', output: 'html', onlyCategories: ['performance'] };
  const runnerResult = await lighthouse(url, options);

  // Отчет о производительности
  console.log('Lighthouse score:', runnerResult.lhr.categories.performance.score);
  
  await chrome.kill();
}

runLighthouse('https://example.com');
```

### Лучшие практики
- Устанавливайте пороговые значения для ключевых метрик
- Тестируйте на разных устройствах и сетевых условиях
- Интегрируйте тесты производительности в CI/CD
- Мониторьте производительность в production
- Используйте Core Web Vitals как основные метрики

## Связанные темы
- [[Производительность]]
- [[Оптимизация загрузки страниц]]
- [[Unit-тесты]]
- [[E2E-тесты]]
- [[Мониторинг]]
- [[CI/CD]]

> [!tip] Совет
> Используйте Core Web Vitals (LCP, FID, CLS) как основные метрики производительности для оценки пользовательского опыта.

> [!warning] Важно
> Не игнорируйте тестирование производительности, так как это напрямую влияет на пользовательский опыт и SEO.

## Заключение
Тестирование производительности является критическим аспектом фронтенд-разработки, обеспечивающим быструю и плавную работу приложения для пользователей.