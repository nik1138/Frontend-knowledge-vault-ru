---
aliases: ["Обработка ошибок в JavaScript", "Ошибки и исключения", "Управление ошибками"]
tags: [javascript, frontend, error-handling, exceptions]
---

# Обработка ошибок

Обработка ошибок — это важный аспект разработки программного обеспечения, особенно в JavaScript, где ошибки могут происходить как во время выполнения, так и во время взаимодействия с пользователем. Правильная обработка ошибок позволяет обеспечить стабильность приложения и улучшить пользовательский опыт.

## Основные понятия

В JavaScript ошибки представлены объектами, которые могут быть выброшены с помощью ключевого слова `throw`. Обработка ошибок осуществляется с помощью блоков `try-catch-finally`, которые позволяют перехватывать и обрабатывать исключения.

## Типы ошибок

JavaScript различает несколько типов ошибок:

- **Синтаксические ошибки (SyntaxError)** — ошибки, возникающие при нарушении синтаксиса JavaScript
- **Типизированные ошибки (TypeError)** — ошибки, возникающие при попытке выполнить операцию над значением несовместимого типа
- **Ссылочные ошибки (ReferenceError)** — ошибки, возникающие при обращении к несуществующей переменной
- **Ошибки значений (RangeError)** — ошибки, возникающие при выходе значения за допустимый диапазон

## Принципы обработки ошибок

### 1. Предотвращение ошибок

Лучший способ обработки ошибок — это их предотвращение. Используйте проверки типов, валидацию данных и защиту от непредвиденных значений:

```javascript
function divide(a, b) {
  if (typeof a !== 'number' || typeof b !== 'number') {
    throw new TypeError('Аргументы должны быть числами');
  }
  
  if (b === 0) {
    throw new Error('Деление на ноль невозможно');
  }
  
  return a / b;
}
```

### 2. Централизованная обработка ошибок

Для крупных приложений рекомендуется использовать централизованную систему обработки ошибок:

```javascript
class ErrorHandler {
  static handle(error, context = '') {
    console.error(`Ошибка${context ? ` в ${context}` : ''}:`, error);
    
    // Отправка ошибки в систему мониторинга
    if (typeof window !== 'undefined') {
      // В браузере
      fetch('/api/errors', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          message: error.message,
          stack: error.stack,
          timestamp: new Date().toISOString(),
          userAgent: navigator.userAgent,
          url: window.location.href
        })
      }).catch(console.error);
    } else {
      // В Node.js
      console.error('Ошибка сервера:', error);
    }
  }
}
```

### 3. Информирование пользователя

Пользователь должен получать понятные сообщения об ошибках, а не технические детали:

```javascript
async function fetchUserData(userId) {
  try {
    const response = await fetch(`/api/users/${userId}`);
    
    if (!response.ok) {
      throw new Error(`Сервер вернул статус ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    // В реальном приложении используйте i18n для локализации
    throw new Error('Не удалось загрузить данные пользователя. Пожалуйста, попробуйте позже.');
  }
}
```

## Практические рекомендации

### Используйте специфичные типы ошибок

Вместо использования общего `Error`, создавайте специфичные типы ошибок для разных сценариев:

```javascript
class ValidationError extends Error {
  constructor(message) {
    super(message);
    this.name = 'ValidationError';
  }
}

class NetworkError extends Error {
  constructor(message) {
    super(message);
    this.name = 'NetworkError';
  }
}
```

### Логируйте ошибки с контекстом

При логировании ошибок всегда включайте контекст, чтобы облегчить отладку:

```javascript
function processUserData(userData) {
  try {
    // Обработка данных пользователя
    validateUserData(userData);
    saveUserData(userData);
  } catch (error) {
    console.error('Ошибка при обработке данных пользователя:', {
      error: error.message,
      userData: userData,
      timestamp: new Date().toISOString()
    });
    throw error;
  }
}
```

### Обработка ошибок в циклах

При обработке массива данных с возможными ошибками используйте подход, позволяющий продолжить обработку:

```javascript
function processUsers(users) {
  const results = [];
  const errors = [];

  for (const user of users) {
    try {
      const processedUser = processUser(user);
      results.push(processedUser);
    } catch (error) {
      errors.push({ user, error: error.message });
      // Продолжаем обработку следующего пользователя
    }
  }

  return { results, errors };
}
```

## Обработка ошибок в асинхронном коде

Для асинхронного кода используйте `async/await` с блоками `try-catch`:

```javascript
async function handleAsyncOperation() {
  try {
    const data = await fetchData();
    return processResult(data);
  } catch (error) {
    console.error('Асинхронная операция завершилась с ошибкой:', error);
    // Обработка ошибки
    return null;
  }
}
```

## Заключение

Обработка ошибок — это не просто техническая необходимость, а важная часть пользовательского опыта. Хорошо спроектированная система обработки ошибок делает приложение более надежным и предсказуемым.

См. также:
- [[Try-Catch-Finally]]
- [[Асинхронные-исключения]]
- [[Кастомные-ошибки]]
- [[Обработка-ошибок-в-компонентах]]
- [[Дебаггинг]]
- [[Тестирование]]