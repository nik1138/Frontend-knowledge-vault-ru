---
aliases: [Компонентные библиотеки, UI библиотеки]
tags: [frontend, components, library, design-system]
---

# Компонентные библиотеки

Компонентные библиотеки — это коллекции переиспользуемых UI-компонентов, которые обеспечивают согласованность интерфейса, ускоряют разработку и упрощают поддержку приложений. Они являются ключевым элементом современной фронтенд-архитектуры.

## Определение и назначение

Компонентная библиотека — это набор стандартизированных компонентов, которые можно использовать в различных частях приложения или даже в разных приложениях. Она обеспечивает единообразие пользовательского интерфейса и упрощает разработку новых функций.

## Архитектура компонентной библиотеки

### 1. Структура проекта

```
component-library/
├── src/
│   ├── components/
│   │   ├── Button/
│   │   │   ├── Button.jsx
│   │   │   ├── Button.module.css
│   │   │   └── index.js
│   │   ├── Input/
│   │   │   ├── Input.jsx
│   │   │   ├── Input.module.css
│   │   │   └── index.js
│   │   └── ...
│   ├── themes/
│   │   ├── default.js
│   │   └── dark.js
│   ├── utils/
│   │   ├── constants.js
│   │   └── helpers.js
│   └── index.js
├── stories/
│   ├── Button.stories.js
│   └── Input.stories.js
├── docs/
├── package.json
└── README.md
```

### 2. Типы компонентов

#### Примитивные компоненты
- Button
- Input
- Text
- Icon

#### Составные компоненты
- Form
- Modal
- Card
- Navigation

#### Контекстные компоненты
- ThemeProvider
- LocaleProvider
- AuthProvider

## Создание компонентной библиотеки

### 1. Пример примитивного компонента

```jsx
// src/components/Button/Button.jsx
import React from 'react';
import PropTypes from 'prop-types';
import classnames from 'classnames';
import styles from './Button.module.css';

const Button = ({
  children,
  variant = 'primary',
  size = 'medium',
  disabled = false,
  onClick,
  className,
  ...props
}) => {
  const buttonClass = classnames(
    styles.button,
    styles[variant],
    styles[size],
    { [styles.disabled]: disabled },
    className
  );

  return (
    <button
      className={buttonClass}
      disabled={disabled}
      onClick={onClick}
      {...props}
    >
      {children}
    </button>
  );
};

Button.propTypes = {
  children: PropTypes.node.isRequired,
  variant: PropTypes.oneOf(['primary', 'secondary', 'danger', 'outline']),
  size: PropTypes.oneOf(['small', 'medium', 'large']),
  disabled: PropTypes.bool,
  onClick: PropTypes.func,
  className: PropTypes.string
};

export default Button;
```

```css
/* src/components/Button/Button.module.css */
.button {
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-family: inherit;
  transition: all 0.2s ease;
}

.button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.primary {
  background-color: #007bff;
  color: white;
  padding: 8px 16px;
}

.primary:hover:not(:disabled) {
  background-color: #0056b3;
}

.secondary {
  background-color: #6c757d;
  color: white;
}

.secondary:hover:not(:disabled) {
  background-color: #545b62;
}

.danger {
  background-color: #dc3545;
  color: white;
}

.danger:hover:not(:disabled) {
  background-color: #c82333;
}

.outline {
  background-color: transparent;
  color: #007bff;
  border: 1px solid #007bff;
}

.outline:hover:not(:disabled) {
  background-color: #007bff;
  color: white;
}

.small {
  font-size: 12px;
  padding: 4px 8px;
}

.medium {
  font-size: 14px;
  padding: 8px 16px;
}

.large {
  font-size: 16px;
  padding: 12px 24px;
}
```

### 2. Пример составного компонента

```jsx
// src/components/Modal/Modal.jsx
import React, { useEffect } from 'react';
import PropTypes from 'prop-types';
import classnames from 'classnames';
import styles from './Modal.module.css';

const Modal = ({ isOpen, onClose, title, children, className }) => {
  useEffect(() => {
    const handleEscape = (event) => {
      if (event.key === 'Escape') onClose();
    };

    if (isOpen) {
      document.addEventListener('keydown', handleEscape);
      document.body.style.overflow = 'hidden';
    }

    return () => {
      document.removeEventListener('keydown', handleEscape);
      document.body.style.overflow = 'unset';
    };
  }, [isOpen, onClose]);

  if (!isOpen) return null;

  return (
    <div className={styles.overlay} onClick={onClose}>
      <div 
        className={classnames(styles.modal, className)} 
        onClick={(e) => e.stopPropagation()}
      >
        <div className={styles.header}>
          <h3 className={styles.title}>{title}</h3>
          <button className={styles.closeButton} onClick={onClose}>
            ×
          </button>
        </div>
        <div className={styles.content}>
          {children}
        </div>
      </div>
    </div>
  );
};

Modal.propTypes = {
  isOpen: PropTypes.bool.isRequired,
  onClose: PropTypes.func.isRequired,
  title: PropTypes.string,
  children: PropTypes.node,
  className: PropTypes.string
};

export default Modal;
```

### 3. Экспорт компонентов

```javascript
// src/index.js
export { default as Button } from './components/Button';
export { default as Input } from './components/Input';
export { default as Modal } from './components/Modal';
export { default as Card } from './components/Card';
// ... другие компоненты

// Также экспортируем темы и утилиты
export { default as ThemeProvider } from './context/ThemeProvider';
export { default as theme } from './themes/default';
```

## Практические рекомендации

### 1. Создание документации с Storybook

```javascript
// stories/Button.stories.js
import React from 'react';
import Button from '../src/components/Button/Button';

export default {
  title: 'Components/Button',
  component: Button,
  argTypes: {
    variant: {
      control: { type: 'select' },
      options: ['primary', 'secondary', 'danger', 'outline']
    },
    size: {
      control: { type: 'radio' },
      options: ['small', 'medium', 'large']
    }
  }
};

const Template = (args) => <Button {...args} />;

export const Primary = Template.bind({});
Primary.args = {
  children: 'Primary Button',
  variant: 'primary'
};

export const Disabled = Template.bind({});
Disabled.args = {
  children: 'Disabled Button',
  disabled: true
};
```

### 2. Тестирование компонентов

```javascript
// tests/Button.test.js
import React from 'react';
import { render, fireEvent } from '@testing-library/react';
import Button from '../src/components/Button';

describe('Button', () => {
  test('рендерит текст кнопки', () => {
    const { getByText } = render(<Button>Click me</Button>);
    expect(getByText('Click me')).toBeInTheDocument();
  });

  test('вызывает onClick при клике', () => {
    const onClick = jest.fn();
    const { getByRole } = render(<Button onClick={onClick}>Click me</Button>);
    
    fireEvent.click(getByRole('button'));
    expect(onClick).toHaveBeenCalledTimes(1);
  });

  test('отключена при disabled=true', () => {
    const onClick = jest.fn();
    const { getByRole } = render(
      <Button disabled onClick={onClick}>Click me</Button>
    );
    
    const button = getByRole('button');
    expect(button).toBeDisabled();
    
    fireEvent.click(button);
    expect(onClick).not.toHaveBeenCalled();
  });
});
```

### 3. Типизация с TypeScript

```typescript
// src/components/Button/Button.types.ts
export interface ButtonProps {
  children: React.ReactNode;
  variant?: 'primary' | 'secondary' | 'danger' | 'outline';
  size?: 'small' | 'medium' | 'large';
  disabled?: boolean;
  onClick?: () => void;
  className?: string;
  type?: 'button' | 'submit' | 'reset';
}

// src/components/Button/Button.tsx
import React from 'react';
import { ButtonProps } from './Button.types';
import classnames from 'classnames';
import styles from './Button.module.css';

const Button: React.FC<ButtonProps> = ({
  children,
  variant = 'primary',
  size = 'medium',
  disabled = false,
  onClick,
  className,
  type = 'button',
  ...props
}) => {
  const buttonClass = classnames(
    styles.button,
    styles[variant],
    styles[size],
    { [styles.disabled]: disabled },
    className
  );

  return (
    <button
      className={buttonClass}
      disabled={disabled}
      onClick={onClick}
      type={type}
      {...props}
    >
      {children}
    </button>
  );
};

export default Button;
```

## Публикация компонентной библиотеки

### 1. Конфигурация сборки

```json
// package.json
{
  "name": "@company/ui-components",
  "version": "1.0.0",
  "main": "dist/cjs/index.js",
  "module": "dist/esm/index.js",
  "types": "dist/types/index.d.ts",
  "files": [
    "dist/**/*"
  ],
  "scripts": {
    "build": "rollup -c",
    "dev": "rollup -c -w",
    "storybook": "start-storybook -p 6006",
    "build-storybook": "build-storybook"
  },
  "peerDependencies": {
    "react": "^17.0.0 || ^18.0.0",
    "react-dom": "^17.0.0 || ^18.0.0"
  },
  "devDependencies": {
    "@rollup/plugin-commonjs": "^21.0.0",
    "@rollup/plugin-node-resolve": "^13.0.0",
    "@rollup/plugin-replace": "^4.0.0",
    "rollup": "^2.60.0",
    "rollup-plugin-peer-deps-external": "^2.2.4",
    "rollup-plugin-postcss": "^4.0.0"
  }
}
```

### 2. Rollup конфигурация

```javascript
// rollup.config.js
import resolve from '@rollup/plugin-node-resolve';
import commonjs from '@rollup/plugin-commonjs';
import postcss from 'rollup-plugin-postcss';
import peerDepsExternal from 'rollup-plugin-peer-deps-external';
import replace from '@rollup/plugin-replace';

const packageJson = require('./package.json');

export default {
  input: 'src/index.js',
  output: [
    {
      file: packageJson.main,
      format: 'cjs',
      sourcemap: true
    },
    {
      file: packageJson.module,
      format: 'esm',
      sourcemap: true
    }
  ],
  plugins: [
    peerDepsExternal(),
    resolve(),
    commonjs(),
    postcss({
      modules: true,
      use: ['sass']
    }),
    replace({
      preventAssignment: true,
      'process.env.NODE_ENV': JSON.stringify('production')
    })
  ],
  external: ['react', 'react-dom']
};
```

## Лучшие практики

1. **Согласованность**: Все компоненты должны следовать одинаковым принципам именования и архитектуры
2. **Документация**: Каждый компонент должен быть хорошо документирован с примерами использования
3. **Тестирование**: Все компоненты должны быть покрыты тестами
4. **Доступность**: Компоненты должны соответствовать стандартам доступности (a11y)
5. **Адаптивность**: Компоненты должны корректно отображаться на разных устройствах
6. **Темизация**: Компоненты должны поддерживать темы и кастомизацию

## Интеграция с дизайном

Компонентные библиотеки тесно связаны с дизайнерскими системами:
- Компоненты реализуют дизайнерские паттерны
- Обеспечивают единообразие интерфейса
- Упрощают сотрудничество между дизайнерами и разработчиками

## Связанные концепции

- [[Архитектурные-паттерны-компонентов]]
- [[Микрофронтенды]]
- [[Архитектура-UI-компонентов]]
- [[Дизайн-системы-и-архитектура]]

## Теги

#frontend #components #library #design-system #ui #react #storybook #testing