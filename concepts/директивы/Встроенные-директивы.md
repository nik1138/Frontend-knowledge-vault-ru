---
aliases: [Встроенные директивы, Built-in Directives, Стандартные директивы]
tags: [frontend, directives, vue, svelte, angular, javascript]
---

# Встроенные директивы

## Обзор

Встроенные директивы - это предопределенные инструкции, предоставляемые фронтенд-фреймворками для управления поведением DOM-элементов и логикой отображения. Они являются фундаментальной частью каждого фреймворка и обеспечивают базовую функциональность для создания интерактивных пользовательских интерфейсов.

## Встроенные директивы в Vue.js

### Условная отрисовка

#### v-if, v-else-if, v-else
Условная отрисовка - элементы добавляются или удаляются из DOM в зависимости от условия.

```vue
<template>
  <div>
    <h1 v-if="type === 'A'">A</h1>
    <h1 v-else-if="type === 'B'">B</h1>
    <h1 v-else-if="type === 'C'">C</h1>
    <h1 v-else>Не A/B/C</h1>
  </div>
</template>

<script>
export default {
  data() {
    return {
      type: 'A'
    }
  }
}
</script>
```

#### v-show
Условное отображение - переключает CSS свойство `display`.

```vue
<template>
  <div v-show="isVisible">Этот элемент может быть скрыт/показан</div>
</template>

<script>
export default {
  data() {
    return {
      isVisible: true
    }
  }
}
</script>
```

**Различие между v-if и v-show:**
- `v-if` полностью создает или удаляет элемент из DOM
- `v-show` всегда рендерит элемент, просто переключая видимость
- `v-if` имеет более высокие затраты на переключение, `v-show` - на начальный рендер

#### v-if vs v-show - когда что использовать
- Используйте `v-if` если условие редко меняется
- Используйте `v-show` если условие часто переключается

### Отображение списков

#### v-for
Отрисовка списков на основе массивов или объектов.

```vue
<template>
  <ul>
    <!-- Итерация по массиву -->
    <li v-for="item in items" :key="item.id">
      {{ item.name }}
    </li>
    
    <!-- Итерация с индексом -->
    <li v-for="(item, index) in items" :key="index">
      {{ index }} - {{ item.name }}
    </li>
    
    <!-- Итерация по объекту -->
    <li v-for="(value, key) in object" :key="key">
      {{ key }}: {{ value }}
    </li>
    
    <!-- Итерация по числу -->
    <span v-for="n in 10" :key="n">{{ n }}</span>
  </ul>
</template>

<script>
export default {
  data() {
    return {
      items: [
        { id: 1, name: 'Яблоко' },
        { id: 2, name: 'Банан' },
        { id: 3, name: 'Апельсин' }
      ],
      object: {
        title: 'Заголовок',
        description: 'Описание'
      }
    }
  }
}
</script>
```

> [!tip] 
> Всегда используйте `:key` с `v-for` для корректной работы виртуального DOM. Используйте уникальные идентификаторы вместо индексов массива, когда это возможно.

### Обработка событий

#### v-on (сокращение @)
Обработка событий DOM с доступом к оригинальному событию через `$event`.

```vue
<template>
  <div>
    <!-- Базовая обработка -->
    <button v-on:click="counter++">Добавить</button>
    <button @click="handleClick">Обработать клик</button>
    
    <!-- Модификаторы событий -->
    <form @submit.prevent="onSubmit">
      <input @keyup.enter="onEnter" />
      <input @click.stop="onClick" />
      <input @keydown.ctrl.space="onCtrlSpace" />
    </form>
    
    <!-- Модификаторы клавиш -->
    <input @keyup.page-down="onPageDown" />
    
    <!-- Собственные модификаторы клавиш -->
    <input @keyup.f1="onF1" />
  </div>
</template>

<script>
export default {
  data() {
    return {
      counter: 0
    }
  },
  methods: {
    handleClick(event) {
      console.log('Кнопка нажата', event)
    },
    onSubmit() {
      console.log('Форма отправлена (автоматически предотвращено)')
    },
    onEnter() {
      console.log('Нажата клавиша Enter')
    },
    onClick() {
      console.log('Клик остановлен')
    },
    onCtrlSpace() {
      console.log('Нажаты Ctrl+Space')
    },
    onPageDown() {
      console.log('Нажата клавиша Page Down')
    },
    onF1() {
      console.log('Нажата клавиша F1')
    }
  }
}
</script>
```

**Модификаторы событий:**
- `.stop` - вызывает `event.stopPropagation()`
- `.prevent` - вызывает `event.preventDefault()`
- `.capture` - добавляет слушатель в режиме захвата
- `.self` - вызывает обработчик только если событие произошло на этом элементе
- `.once` - обработчик срабатывает только один раз
- `.passive` - добавляет passive слушатель (для производительности)

### Двустороннее связывание

#### v-model
Двустороннее связывание данных между формой и состоянием приложения.

```vue
<template>
  <div>
    <!-- Для input текстового поля -->
    <input v-model="message" placeholder="Введите сообщение">
    <p>Сообщение: {{ message }}</p>
    
    <!-- Для textarea -->
    <textarea v-model="textarea" placeholder="Введите текст"></textarea>
    
    <!-- Для checkbox -->
    <input type="checkbox" id="checkbox" v-model="checked">
    <label for="checkbox">{{ checked }}</label>
    
    <!-- Множественный выбор checkbox -->
    <input type="checkbox" id="jack" value="Джек" v-model="checkedNames">
    <label for="jack">Джек</label>
    
    <!-- Для radio -->
    <input type="radio" id="one" value="Один" v-model="picked">
    <label for="one">Один</label>
    
    <!-- Для select -->
    <select v-model="selected">
      <option disabled value="">Выберите один</option>
      <option>А</option>
      <option>Б</option>
      <option>В</option>
    </select>
    
    <!-- Множественный выбор -->
    <select v-model="multiSelected" multiple>
      <option value="А">А</option>
      <option value="Б">Б</option>
      <option value="В">В</option>
    </select>
  </div>
</template>

<script>
export default {
  data() {
    return {
      message: '',
      textarea: '',
      checked: false,
      checkedNames: [],
      picked: '',
      selected: '',
      multiSelected: []
    }
  }
}
</script>
```

**Модификаторы v-model:**
- `.lazy` - обновление при событии `change` вместо `input`
- `.number` - автоматическое преобразование в число
- `.trim` - автоматическое удаление пробелов в начале и конце

```vue
<template>
  <div>
    <input v-model.lazy="msg" />
    <input v-model.number="age" type="number" />
    <input v-model.trim="msg" />
  </div>
</template>
```

### Динамическая привязка

#### v-bind (сокращение :)
Динамическая привязка атрибутов к выражениям.

```vue
<template>
  <div>
    <!-- Привязка к одному атрибуту -->
    <img v-bind:src="imageSrc" :alt="imageAlt" />
    
    <!-- Привязка к нескольким атрибутам через объект -->
    <div v-bind="{ id: someId, class: someClass }"></div>
    
    <!-- Условные классы -->
    <div :class="{ active: isActive, 'text-danger': hasError }">
      Текст с условными классами
    </div>
    
    <!-- Привязка к массиву классов -->
    <div :class="[activeClass, errorClass]">
      Текст с массивом классов
    </div>
    
    <!-- Условные стили -->
    <div :style="{ color: activeColor, fontSize: fontSize + 'px' }">
      Текст с условными стилями
    </div>
    
    <!-- Привязка к массиву стилей -->
    <div :style="[styleObjectA, styleObjectB]">
      Текст с массивом стилей
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      imageSrc: '/path/to/image.jpg',
      imageAlt: 'Описание изображения',
      someId: 'unique-id',
      someClass: 'container',
      isActive: true,
      hasError: false,
      activeClass: 'active',
      errorClass: 'text-danger',
      activeColor: 'red',
      fontSize: 30,
      styleObjectA: { color: 'red' },
      styleObjectB: { fontSize: '14px' }
    }
  }
}
</script>
```

### Отображение данных

#### v-text
Обновление текстового содержимого элемента (эквивалентно `textContent`).

```vue
<template>
  <div v-text="textContent"></div>
  <!-- То же самое что и -->
  <div>{{ textContent }}</div>
</template>

<script>
export default {
  data() {
    return {
      textContent: 'Привет, Vue!'
    }
  }
}
</script>
```

#### v-html
Обновление HTML содержимого элемента (потенциально небезопасно!).

```vue
<template>
  <div v-html="rawHtml"></div>
</template>

<script>
export default {
  data() {
    return {
      rawHtml: '<span style="color: red">Красный текст</span>'
    }
  }
}
</script>
```

> [!warning] 
> Будьте осторожны при использовании `v-html` с непроверенными пользовательскими данными, так как это может привести к XSS-атакам.

### Слоты

#### v-slot (сокращение #)
Определение слотов для компонентов.

```vue
<!-- BaseLayout.vue -->
<template>
  <div class="container">
    <header>
      <slot name="header"></slot>
    </header>
    <main>
      <slot></slot>
    </main>
    <footer>
      <slot name="footer"></slot>
    </footer>
  </div>
</template>

<!-- Использование -->
<template>
  <BaseLayout>
    <template v-slot:header>
      <h1>Здесь мог быть заголовок</h1>
    </template>
    
    <template #default>
      <p>Содержимое по умолчанию</p>
    </template>
    
    <template #footer>
      <p>Copyright 2023</p>
    </template>
  </BaseLayout>
</template>
```

## Встроенные директивы в Svelte

### Условная отрисовка

#### {#if}, {:else}, {:else if}
Условная отрисовка в Svelte.

```svelte
<script>
  let user = { loggedIn: false };
  
  function toggleUserState() {
    user.loggedIn = !user.loggedIn;
  }
</script>

{#if user.loggedIn}
  <button on:click={toggleUserState}>
    Выйти
  </button>
{:else}
  <button on:click={toggleUserState}>
    Войти
  </button>
{/if}

<!-- С несколькими условиями -->
{#if x > 10}
  <p>Больше 10</p>
{:else if x > 5}
  <p>Больше 5</p>
{:else}
  <p>5 или меньше</p>
{/if}
```

### Отображение списков

#### {#each}
Отрисовка списков элементов.

```svelte
<script>
  let items = [
    { id: 1, name: 'Яблоко' },
    { id: 2, name: 'Банан' },
    { id: 3, name: 'Апельсин' }
  ];
</script>

<ul>
  {#each items as item (item.id)}
    <li>{item.name}</li>
  {/each}
</ul>

<!-- С индексом -->
{#each items as item, index}
  <p>{index}: {item.name}</p>
{/each}

<!-- С деструктуризацией -->
{#each items as { id, name }}
  <p>{id}: {name}</p>
{/each}
```

### Обработка событий

#### on:*
Привязка обработчиков событий.

```svelte
<script>
  let count = 0;
  
  function handleClick() {
    count += 1;
  }
  
  function handleMouseOver(event) {
    console.log('Мышь над элементом');
  }
</script>

<button on:click={handleClick} on:mouseover={handleMouseOver}>
  Нажатий: {count}
</button>

<!-- Модификаторы событий -->
<form on:submit|preventDefault={handleSubmit}>
  <input 
    on:keydown|stopPropagation 
    on:click|once={handleClickOnce}
    on:focus|self={handleSelfFocus}
  />
</form>
```

**Модификаторы событий в Svelte:**
- `|stopPropagation` - останавливает всплытие события
- `|preventDefault` - предотвращает стандартное поведение
- `|passive` - passive слушатель (для производительности)
- `|nonpassive` - не passive слушатель
- `|capture` - слушатель на этапе захвата
- `|once` - обработчик срабатывает только один раз
- `|self` - обработчик срабатывает только на самом элементе

### Двустороннее связывание

#### bind:*
Двустороннее связывание данных.

```svelte
<script>
  let name = '';
  let checked = false;
  let selectedValue = 'option1';
  let textValue = '';
</script>

<!-- Привязка к input -->
<input bind:value={name} placeholder="Введите имя" />
<p>Привет, {name}!</p>

<!-- Привязка к checkbox -->
<input type="checkbox" bind:checked={checked} />
<p>Флажок: {checked ? 'отмечен' : 'не отмечен'}</p>

<!-- Привязка к select -->
<select bind:value={selectedValue}>
  <option value="option1">Опция 1</option>
  <option value="option2">Опция 2</option>
</select>

<!-- Привязка к textarea -->
<textarea bind:value={textValue}></textarea>

<!-- Привязка к файлам -->
<input bind:files={fileList} type="file" multiple />

<!-- Привязка к свойствам элементов -->
<video bind:currentTime={time} bind:duration bind:paused />
```

### Слоты

#### <slot>
Определение слотов в компонентах Svelte.

```svelte
<!-- Child.svelte -->
<div class="card">
  <header>
    <slot name="header">Заголовок по умолчанию</slot>
  </header>
  <main>
    <slot>Содержимое по умолчанию</slot>
  </main>
  <footer>
    <slot name="footer" />
  </footer>
</div>

<!-- Parent.svelte -->
<script>
  import Child from './Child.svelte';
</script>

<Child>
  <h1 slot="header">Мой заголовок</h1>
  <p>Основное содержимое</p>
  <p slot="footer">Мой футер</p>
</Child>
```

### Специальные теги

#### <svelte:window>, <svelte:body>, <svelte:head>
Специальные теги для взаимодействия с различными частями DOM.

```svelte
<script>
  let width = 0;
  let height = 0;
  
  function handleResize() {
    width = window.innerWidth;
    height = window.innerHeight;
  }
</script>

<svelte:window on:resize={handleResize} />
<svelte:body on:click={handleBodyClick} />

<svelte:head>
  <title>Моя страница</title>
  <meta name="description" content="Описание страницы" />
</svelte:head>

<p>Размер окна: {width} x {height}</p>
```

## Встроенные директивы в Angular

### Условная отрисовка

#### *ngIf
Условная отрисовка элементов.

```typescript
// component.ts
export class MyComponent {
  showElement = true;
  
  toggleElement() {
    this.showElement = !this.showElement;
  }
}
```

```html
<!-- template.html -->
<div *ngIf="showElement">Этот элемент может быть скрыт</div>
<button (click)="toggleElement()">Переключить</button>

<!-- С использованием else -->
<div *ngIf="condition; else elseTemplate">
  Отображается, если условие истинно
</div>
<ng-template #elseTemplate>
  Отображается, если условие ложно
</ng-template>
```

### Отображение списков

#### *ngFor
Отрисовка списков элементов.

```html
<ul>
  <li *ngFor="let item of items; let i = index; trackBy: trackByFn">
    {{ i }} - {{ item.name }}
  </li>
</ul>
```

```typescript
export class MyComponent {
  items = [
    { id: 1, name: 'Яблоко' },
    { id: 2, name: 'Банан' },
    { id: 3, name: 'Апельсин' }
  ];
  
  trackByFn(index, item) {
    return item.id;
  }
}
```

### Условные классы и стили

#### [ngClass], [ngStyle]
Динамическое применение классов и стилей.

```html
<div [ngClass]="{ 'active': isActive, 'disabled': isDisabled }">
  Элемент с условными классами
</div>

<div [ngStyle]="{ 'color': color, 'font-size': fontSize + 'px' }">
  Элемент с условными стилями
</div>
```

### Привязка данных

#### [(ngModel)]
Двустороннее связывание данных (требует FormsModule).

```html
<input [(ngModel)]="userName" placeholder="Введите имя">
<p>Привет, {{ userName }}!</p>
```

### Шаблонные переменные

#### #template-reference-variable
Создание ссылки на элемент или директиву.

```html
<input #nameInput type="text" (keyup)="onKey(nameInput.value)">
<p>{{ nameInput.value }}</p>
```

## Сравнение встроенных директив

| Функция | Vue | Svelte | Angular |
|---------|-----|--------|---------|
| Условная отрисовка | `v-if`, `v-show` | `{#if}` | `*ngIf` |
| Отображение списков | `v-for` | `{#each}` | `*ngFor` |
| Обработка событий | `v-on` | `on:*` | `(event)` |
| Двустороннее связывание | `v-model` | `bind:*` | `[(ngModel)]` |
| Привязка атрибутов | `v-bind` | `{expression}` | `[property]` |
| Слоты | `v-slot` | `<slot>` | `<ng-content>` |

## Лучшие практики использования встроенных директив

### 1. Эффективное использование условной отрисовки

```vue
<!-- Vue: Используйте v-show для часто переключаемых элементов -->
<div v-show="isVisible">Часто переключаемый элемент</div>

<!-- Используйте v-if для редко меняющихся условий -->
<div v-if="isRarelyChanged">Редко меняющийся элемент</div>
```

### 2. Правильное использование ключей в списках

```vue
<!-- Всегда используйте ключи с v-for -->
<li v-for="item in items" :key="item.id">
  {{ item.name }}
</li>
```

### 3. Оптимизация производительности

```svelte
<!-- Svelte: Используйте модификаторы для оптимизации -->
<button on:click|once={handleOnce}>Только один раз</button>
<form on:submit|preventDefault={handleSubmit}>Форма без перезагрузки</form>
```

### 4. Безопасность при работе с HTML

```vue
<!-- Избегайте v-html с пользовательскими данными -->
<!-- Лучше использовать экранирование -->
<span>{{ userContent }}</span>
```

## Расширенные возможности

### Вложенные условия

```vue
<template>
  <!-- Vue: Вложенные условия -->
  <div v-if="user">
    <div v-if="user.isAdmin">Панель администратора</div>
    <div v-else-if="user.isModerator">Панель модератора</div>
    <div v-else>Пользовательская панель</div>
  </div>
</template>
```

```svelte
<script>
  // Svelte: Вложенные условия
</script>
{#if user}
  {#if user.isAdmin}
    <div>Панель администратора</div>
  {:else if user.isModerator}
    <div>Панель модератора</div>
  {:else}
    <div>Пользовательская панель</div>
  {/if}
{/if}
```

### Комбинация директив

```vue
<template>
  <!-- Комбинация v-for и v-if -->
  <li 
    v-for="user in users" 
    v-if="user.isActive"
    :key="user.id"
  >
    {{ user.name }}
  </li>
  
  <!-- Лучше вынести фильтрацию в computed -->
  <li v-for="user in activeUsers" :key="user.id">
    {{ user.name }}
  </li>
</template>

<script>
export default {
  computed: {
    activeUsers() {
      return this.users.filter(user => user.isActive);
    }
  }
}
</script>
```

> [!tip] 
> При комбинации `v-for` и `v-if` на одном элементе `v-for` имеет более высокий приоритет. Рассмотрите возможность вынесения фильтрации в вычисляемое свойство для лучшей производительности.

> [!note] 
> Каждый фреймворк имеет свои особенности в реализации встроенных директив. Всегда обращайтесь к документации конкретного фреймворка для получения актуальной информации.

## См. также

- [[Директивы-в-Vue]]
- [[Директивы-в-Svelte]]
- [[Директивы-в-Angular]]
- [[Пользовательские-директивы]]