---
aliases: [SessionStorage, Session Storage]
tags: [frontend, persistence, storage, javascript]
---

# Сессионное хранилище (SessionStorage)

**Сессионное хранилище** (SessionStorage) - это механизм веб-браузера, который позволяет веб-приложениям временно хранить данные в браузере пользователя в течение одной сессии. В отличие от [[Локальное-хранилище]], данные в SessionStorage удаляются при закрытии вкладки или окна браузера.

## Основные характеристики

- **Персистентность**: Данные сохраняются только в течение одной сессии (вкладки/окна)
- **Объем**: Обычно доступно от 5 до 10 МБ (в зависимости от браузера)
- **Доступ**: Только из того же домена/origin и той же вкладки/окна
- **Формат**: Только строковые данные (необходима сериализация для объектов)
- **Изоляция**: Данные из разных вкладок одного домена изолированы друг от друга

## API SessionStorage

### Сохранение данных

```javascript
// Сохранение строки
sessionStorage.setItem('ключ', 'значение');

// Сохранение объекта (с сериализацией)
const пользователь = { имя: 'Мария', сессия: 'abc123' };
sessionStorage.setItem('пользователь', JSON.stringify(пользователь));

// Сохранение числа
sessionStorage.setItem('счетчик', '15');
```

### Получение данных

```javascript
// Получение строки
const значение = sessionStorage.getItem('ключ');

// Получение объекта (с десериализацией)
const пользователь = JSON.parse(sessionStorage.getItem('пользователь'));

// Получение числа
const счетчик = parseInt(sessionStorage.getItem('счетчик'));
```

### Удаление данных

```javascript
// Удаление конкретного ключа
sessionStorage.removeItem('ключ');

// Очистка всего хранилища
sessionStorage.clear();
```

### Получение ключа по индексу

```javascript
// Получение ключа по индексу
const ключ = sessionStorage.key(0);
```

## Практические примеры использования

### Сохранение состояния формы на время сессии

```javascript
// Сохранение данных формы при вводе
function инициализироватьСохранениеФормыСессии() {
  const форма = document.getElementById('форма-поиска');
  const поля = форма.querySelectorAll('input, textarea, select');
  
  // Загрузка сохранённых данных при загрузке
  поля.forEach(поле => {
    const сохранённоеЗначение = sessionStorage.getItem(`форма_поиска_${поле.name}`);
    if (сохранённоеЗначение) {
      if (поле.type === 'checkbox' || поле.type === 'radio') {
        поле.checked = сохранённоеЗначение === 'true';
      } else {
        поле.value = сохранённоеЗначение;
      }
    }
    
    // Сохранение при изменении
    поле.addEventListener('input', () => {
      let значение = поле.value;
      if (поле.type === 'checkbox' || поле.type === 'radio') {
        значение = поле.checked ? 'true' : 'false';
      }
      sessionStorage.setItem(`форма_поиска_${поле.name}`, значение);
    });
  });
}

// Очистка данных формы при успешной отправке
function очиститьСохранённыеДанныеФормыСессии() {
  Object.keys(sessionStorage).forEach(ключ => {
    if (ключ.startsWith('форма_поиска_')) {
      sessionStorage.removeItem(ключ);
    }
  });
}
```

### Управление состоянием вкладок

```javascript
// Создание уникального ID для текущей вкладки
const идентификаторВкладки = Date.now() + Math.random().toString(36).substr(2, 9);
sessionStorage.setItem('идентификатор_вкладки', идентификаторВкладки);

// Сохранение истории навигации в рамках сессии
function добавитьВИсторию(путь) {
  const история = JSON.parse(sessionStorage.getItem('история_навигации') || '[]');
  история.push({
    путь: путь,
    время: new Date().toISOString(),
    идентификатор: идентификаторВкладки
  });
  sessionStorage.setItem('история_навигации', JSON.stringify(история));
}

// Получение истории навигации
function получитьИсторию() {
  return JSON.parse(sessionStorage.getItem('история_навигации') || '[]');
}
```

### Временное хранение данных для межстраничной передачи

```javascript
// Сохранение данных для передачи на следующую страницу
function сохранитьДанныеДляПередачи(данные) {
  sessionStorage.setItem('временные_данные', JSON.stringify(данные));
}

// Получение и удаление временных данных
function получитьИУдалитьВременныеДанные() {
  const данные = sessionStorage.getItem('временные_данные');
  sessionStorage.removeItem('временные_данные'); // Удаляем после использования
  return данные ? JSON.parse(данные) : null;
}

// Пример использования
function перейтиСПередачейДанных(адрес, данные) {
  сохранитьДанныеДляПередачи(данные);
  window.location.href = адрес;
}
```

## Преимущества SessionStorage

- **Временное хранение**: Данные автоматически удаляются при закрытии вкладки
- **Изоляция сессий**: Данные в разных вкладках не пересекаются
- **Простота использования**: Аналогично LocalStorage, простой API
- **Синхронный доступ**: Данные доступны немедленно
- **Безопасность**: Данные не передаются на сервер

## Ограничения и недостатки

- **Ограниченная персистентность**: Данные исчезают при закрытии вкладки/окна
- **Ограничение объема**: Обычно 5-10 МБ на домен
- **Только строковые данные**: Необходима сериализация для сложных объектов
- **Синхронная работа**: Может блокировать основной поток при работе с большими объемами данных
- **Нет контроля версий**: Нет встроенной поддержки версионирования данных

## Лучшие практики

### 1. Обработка ошибок

```javascript
function безопасныйSessionStorage(действие, ...аргументы) {
  try {
    return действие(...аргументы);
  } catch (ошибка) {
    if (ошибка.name === 'QuotaExceededError') {
      console.warn('SessionStorage переполнен. Очистка данных...');
      sessionStorage.clear();
    } else {
      console.error('Ошибка работы с SessionStorage:', ошибка);
    }
    return null;
  }
}

function безопасныйSetItem(ключ, значение) {
  return безопасныйSessionStorage(sessionStorage.setItem, ключ, значение);
}

function безопасныйGetItem(ключ) {
  return безопасныйSessionStorage(sessionStorage.getItem, ключ);
}
```

### 2. Менеджер SessionStorage

```javascript
class SessionStorageManager {
  static set(ключ, данные) {
    try {
      const сериализованныеДанные = JSON.stringify(данные);
      sessionStorage.setItem(ключ, сериализованныеДанные);
      return true;
    } catch (ошибка) {
      console.error(`Ошибка сохранения данных с ключом "${ключ}":`, ошибка);
      return false;
    }
  }

  static get(ключ) {
    try {
      const сериализованныеДанные = sessionStorage.getItem(ключ);
      return сериализованныеДанные ? JSON.parse(сериализованныеДанные) : null;
    } catch (ошибка) {
      console.error(`Ошибка получения данных с ключом "${ключ}":`, ошибка);
      return null;
    }
  }

  static remove(ключ) {
    sessionStorage.removeItem(ключ);
  }

  static clear() {
    sessionStorage.clear();
  }
}
```

### 3. Валидация и контроль времени жизни

```javascript
// Сохранение с меткой времени
function setWithExpiry(ключ, значение, времяЖизниМс) {
  const сейчас = new Date();
  const срокХранения = {
    значение: значение,
    времяСоздания: сейчас.getTime(),
    времяЖизни: времяЖизниМс
  };
  SessionStorageManager.set(ключ, срокХранения);
}

// Получение с проверкой срока годности
function getWithExpiry(ключ) {
  const данные = SessionStorageManager.get(ключ);
  if (!данные) return null;

  const сейчас = new Date();
  if (сейчас.getTime() - данные.времяСоздания > данные.времяЖизни) {
    SessionStorageManager.remove(ключ); // Удаляем просроченные данные
    return null;
  }

  return данные.значение;
}

// Пример использования
setWithExpiry('временный_токен', 'abc123', 30 * 60 * 1000); // 30 минут
const токен = getWithExpiry('временный_токен');
```

## Сравнение с другими методами хранения

| Метод | Персистентность | Объем | Доступ | Синхронность | Изоляция |
|-------|----------------|-------|--------|--------------|----------|
| [[Локальное-хранилище]] | Постоянная | ~5-10 МБ | Тот же origin | Синхронный | Origin |
| SessionStorage | Сессия | ~5-10 МБ | Тот же origin | Синхронный | Origin + Вкладка |
| [[Куки]] | Настроена | ~4 КБ | Тот же origin + сервер | Синхронный | Origin |
| [[IndexedDB]] | Постоянная | ~Много | Тот же origin | Асинхронный | Origin |

## События изменения хранилища

SessionStorage, как и LocalStorage, поддерживает событие `storage`, которое срабатывает при изменении данных в другом окне/вкладке:

```javascript
window.addEventListener('storage', (событие) => {
  // Обратите внимание: событие не срабатывает в той же вкладке, где произошло изменение
  console.log(`Ключ "${событие.key}" изменился с "${событие.oldValue}" на "${событие.newValue}"`);
  console.log(`Домен: ${событие.url}`);
});
```

## Заключение

SessionStorage - это эффективный способ временного хранения данных в рамках одной сессии браузера. Он идеально подходит для хранения состояния формы, данных навигации, временных результатов и другой информации, которая не нужна после закрытия вкладки. 

SessionStorage дополняет [[Локальное-хранилище]], предлагая решение для сценариев, где данные должны автоматически удаляться при завершении сессии, обеспечивая лучшую изоляцию и безопасность по сравнению с куками.

## См. также

- [[Локальное-хранилище]]
- [[IndexedDB]]
- [[Куки]]
- [[Кэширование-данных]]
- [[Синхронизация-данных]]
- [[Персистентность-данных-в-веб-приложениях]]