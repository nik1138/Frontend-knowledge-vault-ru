---
aliases: ["Функциональные перегрузки", "Перегрузки методов", "Function Overloads"]
tags: [ts/функции, перегрузки, programming]
---

# Перегрузка-функций

## Обзор

Перегрузка функций в TypeScript позволяет определять несколько сигнатур для одной и той же функции, что делает API более гибким и понятным. Это мощная возможность, которая позволяет функции работать с разными типами и количеством параметров, при этом сохраняя строгую типизацию.

## Основы перегрузки функций

В TypeScript вы можете объявить несколько сигнатур функции перед её реализацией:

```ts
// Объявление перегрузок
function makeElement(tag: string): HTMLElement;
function makeElement(tag: "input"): HTMLInputElement;
function makeElement(tag: "div"): HTMLDivElement;

// Реализация функции
function makeElement(tag: string): HTMLElement {
    return document.createElement(tag);
}
```

## Примеры перегрузок

### Простая перегрузка

```ts
function format(value: string): string;
function format(value: number): string;
function format(value: boolean): string;
function format(value: string | number | boolean): string {
    return String(value);
}
```

### Перегрузка с различным количеством параметров

```ts
function getDate(): Date;
function getDate(timestamp: number): Date;
function getDate(year: number, month: number, day?: number): Date;
function getDate(timestampOrYear?: number, month?: number, day?: number): Date {
    if (timestampOrYear === undefined) {
        return new Date();
    } else if (month === undefined) {
        return new Date(timestampOrYear);
    } else {
        return new Date(timestampOrYear, month, day ?? 1);
    }
}
```

### Перегрузка с различными типами возвращаемого значения

```ts
function createElement(tag: "div"): HTMLDivElement;
function createElement(tag: "span"): HTMLSpanElement;
function createElement(tag: "p"): HTMLParagraphElement;
function createElement(tag: string): HTMLElement {
    return document.createElement(tag);
}
```

## Расширенные примеры

### Перегрузка с массивами

```ts
function getFirstElement<T>(arr: T[]): T | undefined;
function getFirstElement<T>(arr: readonly T[]): T | undefined;
function getFirstElement(str: string): string | undefined;
function getFirstElement(arr: any[] | string): any {
    return arr && arr.length > 0 ? arr[0] : undefined;
}
```

### Перегрузка с коллбэками

```ts
function addEventListener<T extends keyof HTMLElementEventMap>(
    element: HTMLElement,
    type: T,
    listener: (this: HTMLElement, ev: HTMLElementEventMap[T]) => any
): void;
function addEventListener(
    element: HTMLElement,
    type: string,
    listener: EventListenerOrEventListenerObject
): void;
function addEventListener(
    element: HTMLElement,
    type: string,
    listener: EventListenerOrEventListenerObject
): void {
    element.addEventListener(type, listener);
}
```

## Ограничения перегрузок

1. Все перегрузки должны быть объявлены перед реализацией
2. Реализация должна быть совместима со всеми перегрузками
3. Реализация не включается в объявление типов (например, в .d.ts файлах)

```ts
// Правильная реализация
function pick(object: any, keys: string[]): any {
    const result: any = {};
    for (const key of keys) {
        if (key in object) {
            result[key] = object[key];
        }
    }
    return result;
}
```

## Практические применения

### Утилитарные функции

```ts
// Функция для получения или установки значения
function attr(element: HTMLElement, name: string): string | null;
function attr(element: HTMLElement, name: string, value: string): void;
function attr(
    element: HTMLElement, 
    name: string, 
    value?: string
): string | null | void {
    if (value === undefined) {
        return element.getAttribute(name);
    } else {
        element.setAttribute(name, value);
    }
}
```

### Асинхронные перегрузки

```ts
function fetchResource(url: string): Promise<string>;
function fetchResource<T>(url: string, transform: (data: string) => T): Promise<T>;
function fetchResource<T>(
    url: string, 
    transform?: (data: string) => T
): Promise<string | T> {
    return fetch(url)
        .then(response => response.text())
        .then(data => transform ? transform(data) : data);
}
```

## Лучшие практики

- Используйте перегрузки, когда функция может принимать разные типы параметров
- Объявляйте наиболее конкретные перегрузки первыми
- Убедитесь, что реализация функции может обрабатывать все возможные комбинации параметров
- Избегайте избыточного использования перегрузок, когда можно обойтись дженериками или объединениями типов

## Связанные темы

- [[Типизация-функций]]
- [[Стрелочные-функции]]
- [[Функции-высшего-порядка]]
- [[Типы в TypeScript]]
- [[Дженерики в TypeScript]]

## Заключение

Перегрузка функций - мощный инструмент TypeScript, который позволяет создавать более выразительные и типобезопасные API. Правильное использование перегрузок улучшает опыт разработки за счет более точных подсказок редактора и лучшей документации кода.