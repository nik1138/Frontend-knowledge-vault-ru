---
aliases: [CLI, Интерфейсы командной строки]
tags: [typescript, cli, command-line, programming]
---

# Command-line интерфейсы

Command-line интерфейсы (CLI) являются важной частью разработки программного обеспечения. Они позволяют пользователям взаимодействовать с приложениями через текстовые команды, что делает их мощными инструментами для автоматизации задач и интеграции в рабочие процессы.

## Введение в CLI

Command-line интерфейс - это текстовый интерфейс для взаимодействия с компьютерными программами. В отличие от графических интерфейсов, CLI полагаются на текстовые команды и аргументы для выполнения операций.

### Преимущества CLI

- **Эффективность**: Быстрое выполнение задач без необходимости в графическом интерфейсе
- **Автоматизация**: Легкая интеграция в скрипты и автоматизированные процессы
- **Управляемость**: Возможность точной настройки параметров выполнения
- **Удалённый доступ**: Простое использование через SSH или другие текстовые интерфейсы

## Основные концепции CLI

### Аргументы командной строки

CLI принимают аргументы двух типов:
- **Позиционные аргументы**: Значения, передаваемые в определённом порядке
- **Флаги/опции**: Именованные параметры, часто начинающиеся с `-` или `--`

```typescript
// Пример обработки аргументов в Node.js
process.argv.forEach((val, index) => {
  console.log(`${index}: ${val}`);
});
```

### Стандартные потоки

CLI обычно работают с тремя стандартными потоками:
- **stdin**: Стандартный входной поток
- **stdout**: Стандартный выходной поток
- **stderr**: Стандартный поток ошибок

```typescript
// Запись в stdout
console.log('Это сообщение в стандартный вывод');

// Запись в stderr
console.error('Это сообщение об ошибке');
```

## Создание CLI с TypeScript

TypeScript предоставляет строгую типизацию для CLI приложений, что делает их более надёжными и легкими для сопровождения.

### Базовая структура CLI приложения

```typescript
#!/usr/bin/env node

import { Command } from 'commander';
import { processArguments } from './cli-processor';

const program = new Command();

program
  .name('my-cli-tool')
  .description('Описание CLI инструмента')
  .version('1.0.0');

program
  .command('build')
  .description('Сборка проекта')
  .option('-o, --output <path>', 'путь к выходному файлу')
  .action((options) => {
    // Логика команды
    console.log('Сборка проекта...', options);
  });

program.parse();
```

## Обработка аргументов и опций

### Валидация входных данных

```typescript
import { Argument } from 'commander';

program
  .command('deploy')
  .description('Развертывание приложения')
  .argument('<environment>', 'окружение для развертывания')
  .option('-v, --verbose', 'подробный вывод')
  .option('-t, --timeout <seconds>', 'таймаут в секундах', parseInt)
  .action((environment, options) => {
    if (!['dev', 'staging', 'prod'].includes(environment)) {
      throw new Error('Неверное окружение. Допустимые значения: dev, staging, prod');
    }
    
    console.log(`Развертывание в ${environment}...`);
    if (options.verbose) {
      console.log('Подробный режим включен');
    }
  });
```

## Практические рекомендации

### Обработка ошибок

```typescript
import { exit } from 'process';

try {
  // Выполнение основной логики CLI
  await executeCommand();
} catch (error) {
  console.error('Ошибка:', error.message);
  exit(1); // Возвращаем код ошибки
}
```

### Поддержка справки

CLI инструменты должны предоставлять понятные сообщения о помощи и использовании:

```typescript
program
  .helpOption('-h, --help', 'показать справку')
  .addHelpText('after', `
Примеры:
  $ my-cli-tool build --output dist/
  $ my-cli-tool deploy staging --verbose
  `);
```

## Лучшие практики

1. **Следуйте стандартным соглашениям CLI**
   - Используйте двойные тире (`--`) для длинных опций
   - Используйте одинарное тире (`-`) для коротких опций
   - Используйте понятные имена команд и опций

2. **Предоставляйте адекватные сообщения об ошибках**
   - Указывайте, что пошло не так
   - Предлагайте возможные решения

3. **Обеспечивайте обратную совместимость**
   - Не изменяйте поведение команд без необходимости
   - Добавляйте новые функции как необязательные опции

## Заключение

Command-line интерфейсы остаются важной частью разработки программного обеспечения. Использование TypeScript для создания CLI инструментов обеспечивает строгую типизацию и улучшает качество кода.

См. также:
- [[Commander-js]]
- [[Yargs]]
- [[Интеграция-с-CLI-библиотеками]]
- [[Публикация-CLI-инструментов]]
- [[Node.js-с-TypeScript]]
- [[TypeScript-инструменты-и-библиотеки]]
