---
aliases: [Генерация документации, Documentation Generation, Автоматическая документация]
tags: [typescript, documentation, generation, tools, automation, typedoc]
---

# Генерация документации в TypeScript проектах

Генерация документации — это процесс автоматического создания справочных материалов из исходного кода, комментариев и типов. В TypeScript проектах автоматическая генерация документации особенно эффективна благодаря богатой системе типов, которая предоставляет дополнительную информацию для создания подробной и точной документации.

## Преимущества автоматической генерации документации

1. **Согласованность**: Документация всегда соответствует актуальной версии кода
2. **Экономия времени**: Снижение необходимости в ручном создании документации
3. **Актуальность**: Документация обновляется вместе с кодом
4. **Полнота**: Все элементы API документируются систематически
5. **Интеграция**: Возможность интеграции в процесс CI/CD

## Основные инструменты генерации документации

### Typedoc

Typedoc — один из самых популярных инструментов для генерации документации из TypeScript кода. Он извлекает информацию из TSDoc комментариев и TypeScript типов.

#### Установка

```bash
npm install --save-dev typedoc
```

#### Базовая конфигурация

```json
// typedoc.json
{
  "$schema": "https://typedoc.org/schema.json",
  "entryPoints": ["./src/index.ts"],
  "out": "docs/api",
  "name": "Мой TypeScript проект",
  "readme": "./README.md",
  "includeVersion": true,
  "excludeNotDocumented": false,
  "excludePrivate": true,
  "excludeProtected": true,
  "theme": "default",
  "customCss": "./assets/custom.css"
}
```

#### Использование

```bash
# Генерация документации
npx typedoc

# Или с использованием npm скрипта
npm run docs
```

#### Пример использования с TSDoc

```ts
/**
 * Утилита для работы с массивами
 */
export class ArrayUtils {
  /**
   * Фильтрует массив, удаляя дубликаты
   * @param arr - исходный массив
   * @returns новый массив без дубликатов
   * 
   * @example
   * ```ts
   * const result = ArrayUtils.unique([1, 2, 2, 3]); // [1, 2, 3]
   * ```
   */
  static unique<T>(arr: T[]): T[] {
    return [...new Set(arr)];
  }

  /**
   * Группирует элементы массива по заданному критерию
   * @param arr - массив для группировки
   * @param keySelector - функция выбора ключа группировки
   * @returns объект с группами
   * 
   * @example
   * ```ts
   * const users = [{name: 'John', age: 25}, {name: 'Jane', age: 25}];
   * const grouped = ArrayUtils.groupBy(users, user => user.age);
   * // {25: [{name: 'John', age: 25}, {name: 'Jane', age: 25}]}
   * ```
   */
  static groupBy<T, K extends keyof any>(
    arr: T[],
    keySelector: (item: T) => K
  ): Record<K, T[]> {
    return arr.reduce((groups, item) => {
      const key = keySelector(item);
      if (!groups[key]) {
        groups[key] = [];
      }
      groups[key].push(item);
      return groups;
    }, {} as Record<K, T[]>);
  }
}
```

### Дополнительные опции Typedoc

#### Пользовательские темы

```json
{
  "theme": "path/to/custom/theme",
  "customCss": "assets/custom.css",
  "markedOptions": {
    "baseUrl": "https://example.com/"
  }
}
```

#### Фильтрация элементов

```json
{
  "excludeNotDocumented": true,
  "excludeNotExported": true,
  "excludePrivate": true,
  "excludeProtected": true,
  "excludeInternal": true,
  "categorizeByGroup": true
}
```

#### Плагины для Typedoc

```bash
# Плагин для генерации JSON
npm install --save-dev typedoc-plugin-json

# Плагин для поддержки Markdown
npm install --save-dev typedoc-plugin-markdown
```

### JSDoc с TypeScript

Хотя TSDoc является предпочтительным форматом для TypeScript, JSDoc также поддерживается:

```ts
/**
 * Класс для работы с пользовательскими данными
 * @class
 * @property {string} name - Имя пользователя
 * @property {number} age - Возраст пользователя
 */
export class User {
  /**
   * @param {string} name - Имя пользователя
   * @param {number} age - Возраст пользователя
   */
  constructor(public name: string, public age: number) {}

  /**
   * Проверяет, является ли пользователь совершеннолетним
   * @returns {boolean} true, если пользователь совершеннолетний
   */
  isAdult(): boolean {
    return this.age >= 18;
  }
}
```

## Генерация документации для API

### Swagger/OpenAPI

Для REST API часто используется генерация OpenAPI спецификаций:

```ts
// controllers/user.controller.ts
import { Controller, Get, Post, Body, Param, Delete } from '@nestjs/common';
import { ApiTags, ApiOperation, ApiResponse, ApiParam, ApiBody } from '@nestjs/swagger';
import { UserService } from './user.service';
import { User, CreateUserDto } from './entities/user.entity';

@ApiTags('users')
@Controller('users')
export class UserController {
  constructor(private readonly userService: UserService) {}

  @Get(':id')
  @ApiOperation({ summary: 'Получить пользователя по ID' })
  @ApiParam({ name: 'id', description: 'ID пользователя', type: Number })
  @ApiResponse({ 
    status: 200, 
    description: 'Пользователь успешно найден',
    type: User
  })
  @ApiResponse({ 
    status: 404, 
    description: 'Пользователь не найден'
  })
  findOne(@Param('id') id: string) {
    return this.userService.findOne(+id);
  }

  @Post()
  @ApiOperation({ summary: 'Создать нового пользователя' })
  @ApiBody({ type: CreateUserDto })
  @ApiResponse({ 
    status: 201, 
    description: 'Пользователь успешно создан',
    type: User
  })
  create(@Body() createUserDto: CreateUserDto) {
    return this.userService.create(createUserDto);
  }
}
```

### Генерация TypeScript клиентов

Из OpenAPI спецификаций можно генерировать TypeScript клиенты:

```bash
# Установка генератора
npm install @openapitools/openapi-generator-cli -g

# Генерация клиента
openapi-generator-cli generate \
  -i ./docs/openapi.json \
  -g typescript-fetch \
  -o ./generated/client \
  --additional-properties=supportsES6=true
```

## Генерация документации для библиотек

### Настройка для публикации в npm

```json
// package.json
{
  "name": "my-typescript-library",
  "version": "1.0.0",
  "scripts": {
    "docs": "typedoc",
    "docs:watch": "typedoc --watch",
    "prepublishOnly": "npm run docs"
  },
  "typedocOptions": {
    "entryPoints": ["src/index.ts"],
    "out": "docs/api",
    "excludeNotDocumented": true,
    "readme": "none"
  }
}
```

### Поддержка модулей

Typedoc автоматически генерирует документацию для модулей:

```ts
// src/utils/index.ts
export { ArrayUtils } from './array.utils';
export { ObjectUtils } from './object.utils';
export { StringUtils } from './string.utils';
```

```ts
// src/utils/array.utils.ts
/**
 * Утилиты для работы с массивами
 */
export class ArrayUtils {
  // реализация
}
```

## Интеграция с CI/CD

### GitHub Actions для генерации документации

```yaml
# .github/workflows/docs.yml
name: Generate Documentation

on:
  push:
    branches: [ main ]

jobs:
  docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '16'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Generate documentation
        run: npm run docs
        
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./docs/api
```

### Интеграция с Git hooks

```json
// package.json
{
  "scripts": {
    "docs": "typedoc",
    "docs:check": "typedoc --emit none --listInvalidSymbolLinks"
  },
  "lint-staged": {
    "**/*.ts": [
      "npm run docs:check",
      "git add docs/api"
    ]
  }
}
```

## Пользовательские темы и стилизация

### Создание пользовательской темы

```ts
// typedoc-theme.ts
import { DefaultTheme } from 'typedoc';

export class CustomTheme extends DefaultTheme {
  constructor(renderer: any, basePath: string) {
    super(renderer, basePath);
  }
  
  // Пользовательская логика темы
}
```

### Пользовательские CSS стили

```css
/* assets/custom.css */
.tsd-kind-class {
  border-left: 4px solid #3f51b5;
}

.tsd-kind-interface {
  border-left: 4px solid #f44336;
}

.tsd-kind-type-alias {
  border-left: 4px solid #4caf50;
}

.tsd-signature {
  background-color: #f5f5f5;
  padding: 10px;
  border-radius: 4px;
}
```

## Генерация документации для сложных структур

### Дженерики и условные типы

```ts
/**
 * Условный тип для извлечения типа по ключу
 */
export type ValueOf<T, K extends keyof T> = T[K];

/**
 * Тип для создания неизменяемого объекта
 */
export type Immutable<T> = {
  readonly [K in keyof T]: T[K] extends object ? Immutable<T[K]> : T[K];
};

/**
 * Класс для работы с неизменяемыми данными
 * @template T - тип данных
 */
export class ImmutableData<T> {
  private readonly data: Immutable<T>;
  
  constructor(data: T) {
    this.data = this.deepFreeze(data);
  }
  
  /**
   * Получить значение по ключу
   * @param key - ключ для получения значения
   * @returns значение по ключу
   */
  get<K extends keyof T>(key: K): Immutable<T>[K] {
    return this.data[key];
  }
  
  private deepFreeze<T>(obj: T): Immutable<T> {
    // реализация глубокой заморозки
    return Object.freeze(obj);
  }
}
```

### Декораторы

```ts
/**
 * Декоратор для логирования вызовов методов
 * @param target - целевой объект
 * @param propertyKey - ключ свойства
 * @param descriptor - дескриптор свойства
 */
export function LogMethod(
  target: any,
  propertyKey: string,
  descriptor: PropertyDescriptor
) {
  const originalMethod = descriptor.value;
  
  descriptor.value = function (...args: any[]) {
    console.log(`Вызов метода: ${propertyKey}`, args);
    const result = originalMethod.apply(this, args);
    console.log(`Результат метода: ${propertyKey}`, result);
    return result;
  };
}

/**
 * Сервис с логированием
 */
export class UserService {
  /**
   * Получить пользователя по ID
   * @param id - ID пользователя
   * @returns пользователь
   */
  @LogMethod
  getUser(id: number): User | null {
    // реализация
    return null;
  }
}
```

## Проверка качества документации

### Валидация TSDoc

```bash
# Проверка на неправильно сформированные ссылки
npx typedoc --listInvalidSymbolLinks

# Проверка на недокументированные элементы
npx typedoc --excludeNotDocumented
```

### Интеграция с ESLint

```json
// .eslintrc.json
{
  "extends": [
    "@typescript-eslint/recommended",
    "eslint:recommended"
  ],
  "plugins": [
    "jsdoc"
  ],
  "rules": {
    "jsdoc/require-jsdoc": "warn",
    "jsdoc/require-param": "warn",
    "jsdoc/require-returns": "warn"
  }
}
```

## Лучшие практики генерации документации

> [!tip] Совет
> Интегрируйте генерацию документации в процесс CI/CD, чтобы обеспечить актуальность документации с каждым коммитом.

1. **Регулярное обновление**: Обновляйте документацию вместе с кодом
2. **Проверка качества**: Используйте инструменты для проверки качества документации
3. **Пользовательские темы**: Создайте тему, соответствующую стилю вашей компании
4. **Примеры кода**: Включайте практические примеры в документацию
5. **Автоматизация**: Автоматизируйте процесс генерации документации

## Связанные темы

- [[TSDoc]] - для понимания стандартов документирования
- [[Документирование-API]] - для документирования API
- [[Storybook]] - для документирования компонентов
- [[Лучшие-практики-документирования]] - общие рекомендации по документированию

Генерация документации в TypeScript проектах — мощный инструмент, который значительно упрощает поддержку и использование кода. Правильная настройка и использование инструментов автоматической генерации документации обеспечивает высокое качество и актуальность документации на протяжении всего жизненного цикла проекта.