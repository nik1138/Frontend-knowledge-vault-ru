---
aliases: ["Source Maps", "Карта исходников", "Отладка Source Map"]
tags: [typescript, debugging, source-map, development]
---

# Source Map в TypeScript

Source Map - это технология, позволяющая отображать минимизированный или скомпилированный JavaScript-код обратно к исходному TypeScript-коду. Это критически важно для эффективной отладки приложений на TypeScript в браузере и средах выполнения.

## Что такое Source Map

Source Map - это JSON-файл, содержащий информацию о соответствии между строками в сгенерированном JavaScript-коде и строками в исходном TypeScript-коде. Это позволяет отладчику отображать исходный код вместо скомпилированного, что делает процесс отладки гораздо более эффективным.

Файл Source Map содержит:
- Сопоставления между строками и столбцами в сгенерированном и исходном коде
- Ссылки на исходные файлы
- Имена переменных и функций (если включено)

## Настройка Source Map в TypeScript

Для генерации Source Map необходимо настроить соответствующие параметры в `tsconfig.json`:

```json
{
  "compilerOptions": {
    "sourceMap": true,
    "inlineSourceMap": false,
    "sourceRoot": "",
    "mapRoot": "",
    "inlineSources": false
  }
}
```

### Основные параметры

- `sourceMap`: Включает генерацию файлов .map
- `inlineSourceMap`: Встраивает Source Map в сам JavaScript-файл
- `sourceRoot`: Базовый путь к исходным файлам
- `mapRoot`: Базовый путь к файлам .map
- `inlineSources`: Встраивает исходный код TypeScript в Source Map

## Практическое применение

При отладке приложения в браузере разработчик может увидеть исходный TypeScript-код, установить точки останова, просматривать переменные и стек вызовов в терминах исходного кода, а не скомпилированного JavaScript.

> [!tip] Совет
> Для разработки рекомендуется использовать `sourceMap: true` и `inlineSources: true`, чтобы иметь доступ к исходному коду без необходимости хранить отдельные файлы на сервере.

## Примеры использования

### Простой пример

При наличии следующего TypeScript-кода:

```typescript
interface User {
  name: string;
  age: number;
}

function greetUser(user: User): string {
  return `Hello, ${user.name}! You are ${user.age} years old.`;
}

const user: User = { name: 'Alice', age: 30 };
console.log(greetUser(user));
```

После компиляции с включенным Source Map, отладчик будет отображать именно этот TypeScript-код, а не сгенерированный JavaScript.

### Работа с Webpack

Для правильной настройки Source Map в Webpack, необходимо указать соответствующую опцию:

```javascript
module.exports = {
  devtool: 'source-map', // или 'inline-source-map', 'eval-source-map'
  // другие настройки
};
```

## Совместимость с инструментами

- [[Отладка-в-IDE]] - Source Map позволяет IDE отображать точки останова в исходном коде
- [[Инструменты-отладки]] - браузерные инструменты разработчика используют Source Map для отображения исходного кода
- [[Логирование-с-типами]] - при логировании ошибок Source Map помогает отслеживать их происхождение в исходном коде

## Проблемы и решения

### Проблема: Source Map не работает в браузере

Возможные причины:
- Файл .map не доступен по указанному пути
- Неправильная настройка `sourceRoot` или `mapRoot`
- Блокировка файлов .map сервером или брандмауэром

Решение:
- Проверьте, что файлы .map доступны по URL
- Убедитесь, что Content-Type для .map файлов - `application/json`
- Проверьте настройки сервера на предмет разрешения доступа к .map файлам

> [!warning] Важно
> Не включайте Source Map в production-сборку, так как это может раскрыть ваш исходный код.

## Заключение

Source Map - это важный инструмент для отладки TypeScript-приложений. Правильная настройка позволяет разработчикам эффективно отлаживать код в терминах исходного TypeScript, а не скомпилированного JavaScript.

См. также:
- [[Типизированные-ошибки]]
- [[Отладка-в-IDE]]
- [TypeScript Documentation - Compiler Options](https://www.typescriptlang.org/tsconfig#sourceMap)