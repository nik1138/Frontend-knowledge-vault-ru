---
aliases: [Тип-чекинг, Type Checking]
tags: [typescript, ci-cd, type-safety]
---

# Проверка типов в CI/CD процессах TypeScript-проектов

## Обзор

Проверка типов (type checking) является критически важным этапом в CI/CD процессе TypeScript-проектов. Она позволяет выявлять ошибки на ранних стадиях разработки, обеспечивая более высокое качество кода и предотвращая потенциальные проблемы в продакшене.

## Зачем нужна проверка типов в CI/CD?

- **Предотвращение ошибок**: Выявление потенциальных ошибок типа до развертывания
- **Поддержание качества кода**: Обеспечение согласованности типов во всем проекте
- **Документирование API**: Типы служат вспомогательной документацией
- **Безопасность рефакторинга**: Уверенность в изменениях кода

## Основные инструменты для проверки типов

### TypeScript Compiler (tsc)

```bash
# Проверка типов без компиляции
tsc --noEmit

# Проверка с указанием конфигурационного файла
tsc --noEmit --project tsconfig.json

# Проверка в режиме watch
tsc --noEmit --watch
```

### Настройка tsconfig.json для CI/CD

```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "noImplicitThis": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "forceConsistentCasingInFileNames": true
  },
  "include": [
    "src/**/*"
  ],
  "exclude": [
    "node_modules",
    "dist"
  ]
}
```

## Интеграция с GitHub Actions

```yaml
name: Type Checking
on: [push, pull_request]
jobs:
  type-check:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
    - name: Install dependencies
      run: npm ci
    - name: Run type checking
      run: npm run type-check
```

## Интеграция с другими CI/CD платформами

### GitLab CI

```yaml
type_checking:
  stage: test
  script:
    - npm ci
    - npm run type-check
  cache:
    key: ${CI_COMMIT_REF_SLUG}
    paths:
      - node_modules/
```

### Jenkins

```groovy
pipeline {
    agent any
    stages {
        stage('Type Check') {
            steps {
                sh 'npm ci'
                sh 'npm run type-check'
            }
        }
    }
}
```

## Продвинутые практики

### Использование tsc-watch в процессе разработки

```json
{
  "scripts": {
    "type-check": "tsc --noEmit",
    "type-check:watch": "tsc --noEmit --watch"
  }
}
```

### Проверка типов для конкретных файлов

```bash
# Проверка только измененных файлов
npx tsc-files --noEmit --include src/components/Button.tsx

# Использование инструмента tsc-files для проверки отдельных файлов
npm install --save-dev tsc-files
```

### Сравнение производительности проверки типов

Для больших проектов можно использовать флаг `--incremental`:

```json
{
  "compilerOptions": {
    "incremental": true,
    "tsBuildInfoFile": ".tsbuildinfo"
  }
}
```

## Обработка ошибок типизации

### Игнорирование определенных ошибок (временное решение)

```ts
// @ts-ignore
const value: string = 42;

// @ts-expect-error
const anotherValue: number = 'hello';
```

> [!warning] 
> Использование `@ts-ignore` и `@ts-expect-error` должно быть минимальным и сопровождаться комментариями.

### Работа с устаревшими библиотеками

Для библиотек без типов можно создать файлы деклараций:

```ts
// types/library.d.ts
declare module 'legacy-library' {
  export function legacyFunction(param: string): void;
}
```

## Лучшие практики

1. **Всегда включайте строгую проверку типов в CI/CD**
2. **Используйте `--noEmit` для проверки типов без компиляции**
3. **Настройте кэширование зависимостей для ускорения проверки**
4. **Регулярно обновляйте версии TypeScript и типов**
5. **Интегрируйте проверку типов в процесс pull request**

## Связанные темы

- [[Тестирование-и-линтинг]]
- [[Сборка-и-деплой]]
- [[Конфигурация-TypeScript]]
- [[Тип-безопасность]]