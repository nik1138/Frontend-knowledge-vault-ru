# Расширенные типы TypeScript

В этом разделе рассматриваются продвинутые концепции типизации в TypeScript, которые позволяют создавать более сложные и гибкие системы типов.

## Содержание раздела

1. [[ts/advanced-types/conditional-types|Условные типы]] - Типы, зависящие от условий
2. [[ts/advanced-types/mapped-types|Сопоставленные типы]] - Преобразование существующих типов
3. [[ts/advanced-types/template-literal-types|Типы-шаблонные литералы]] - Строковые типы на основе шаблонов
4. [[ts/advanced-types/recursive-types|Рекурсивные типы]] - Типы, ссылающиеся на самих себя
5. [[ts/advanced-types/discriminated-unions|Дискриминированные объединения]] - Безопасные объединения типов

## Введение

TypeScript предоставляет мощную систему типов, которая выходит далеко за рамки простых примитивных типов. Расширенные типы позволяют создавать сложные системы типов, обеспечивающие высокий уровень типобезопасности и выявляющие ошибки на этапе компиляции.

## Основные концепции

### 1. Метапрограммирование типов

Расширенные типы позволяют выполнять "метапрограммирование" на уровне типов - создавать типы, которые генерируют другие типы:

```typescript
// Условный тип, который выбирает тип в зависимости от условия
type NonNullable<T> = T extends null | undefined ? never : T;

// Сопоставленный тип, который преобразует все свойства в опциональные
type Partial<T> = { [P in keyof T]?: T[P] };
```

### 2. Автоматическое выведение типов

Многие расширенные типы позволяют TypeScript автоматически выводить сложные типы:

```typescript
// TypeScript может вывести тип возвращаемого значения функции
type ReturnType<T> = T extends (...args: any[]) => infer R ? R : any;
```

### 3. Типобезопасность на уровне компиляции

Расширенные типы позволяют переносить больше логики проверок на этап компиляции:

```typescript
// Дискриминированные объединения обеспечивают исчерпывающую проверку
type Result<T> = { success: true; data: T } | { success: false; error: string };

function handleResult<T>(result: Result<T>): void {
  if (result.success) {
    // TypeScript знает, что result.data существует
    console.log(result.data);
  } else {
    // TypeScript знает, что result.error существует
    console.error(result.error);
  }
}
```

## Практическое применение

### 1. Создание библиотек

Расширенные типы особенно полезны при создании библиотек, где важна гибкость API:

```typescript
// Библиотека для работы с API
type ApiEndpoint<T extends string> = 
  T extends `GET ${infer Path}` ? 
    { method: "GET"; path: Path } : 
  T extends `POST ${infer Path}` ? 
    { method: "POST"; path: Path } : 
    never;
```

### 2. Конфигурационные файлы

Можно создавать типобезопасные конфигурационные файлы:

```typescript
type Config<T> = {
  [K in keyof T]: T[K] extends object ? 
    Config<T[K]> : 
    T[K] | (() => T[K]);
};
```

### 3. ORM и маппинг данных

Расширенные типы полезны для создания типобезопасных ORM:

```typescript
type ModelFields<T> = {
  [K in keyof T]: T[K] extends string ? 
    { type: "string"; required: boolean } : 
  T[K] extends number ? 
    { type: "number"; required: boolean } : 
    never;
};
```

## Связи с другими концепциями

Расширенные типы тесно связаны с другими аспектами системы типов TypeScript:

- [[ts/type-system/type-inference|Вывод типов]] - Многие расширенные типы зависят от механизма вывода
- [[ts/generics/TS Generics|Дженерики]] - Основа для параметризации расширенных типов
- [[ts/basics/control-flow|Анализ потока управления]] - Позволяет сужать расшиленные типы
- [[ts/interfaces-classes/TS Interfaces and Classes|Интерфейсы и классы]] - Расширенные типы могут работать с классами

## Рекомендации по изучению

1. Начните с простых условных типов и сопоставленных типов
2. Освойте работу с `infer` для вывода типов
3. Практикуйтесь в создании дискриминированных объединений
4. Изучите встроенные утилиты TypeScript (`Partial`, `Required`, `Pick`, `Omit`)
5. Попробуйте создавать собственные типы-помощники
6. Используйте шаблонные литералы для создания строковых типов
7. Освойте рекурсивные типы для сложных структур данных

## Следующие шаги

- [[ts/utility-types/Утилиты_типов|Утилиты типов]] - Встроенные и пользовательские типы-помощники
- [[ts/advanced-generics/Продвинутые_дженерики|Продвинутые дженерики]] - Сложные паттерны с дженериками
- [[ts/type-system/type-inference|Вывод типов]] - Как TypeScript выводит типы автоматически