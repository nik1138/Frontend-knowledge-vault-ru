---
aliases: [интеграционное тестирование, тестирование API, тестирование сервисов]
tags: [тестирование, интеграция, качество кода, CI/CD]
---

# Тестирование-интеграции

## Обзор

Тестирование интеграции — это процесс проверки взаимодействия между различными компонентами системы, особенно при интеграции с внешними API, сервисами и библиотеками. В 2025 году, с ростом сложности приложений и увеличением количества внешних зависимостей, тестирование интеграции стало критически важным аспектом разработки.

## Виды тестов интеграции

### API-тесты
Проверяют взаимодействие с внешними API и внутренними сервисами.

```javascript
// Пример API-теста с использованием Jest
describe('User API', () => {
  test('should return user data', async () => {
    const response = await fetch('/api/users/1');
    expect(response.status).toBe(200);
    const userData = await response.json();
    expect(userData.id).toBe(1);
    expect(userData.name).toBeDefined();
  });
});
```

### Тесты интеграции баз данных
Проверяют корректность работы с базой данных через ORM или прямые SQL-запросы.

### Тесты интеграции с внешними сервисами
Проверяют взаимодействие с внешними API, платежными системами, почтовыми сервисами и т.д.

### Контрактные тесты
Проверяют соответствие между клиентом и сервером ожидаемому контракту (например, через OpenAPI или GraphQL Schema).

## Инструменты для тестирования интеграции

### Postman/Newman
- Для ручного и автоматизированного тестирования REST API
- Поддержка коллекций тестов и интеграция с CI/CD

### SoapUI
- Для тестирования SOAP и REST API
- Поддержка нагрузочного тестирования

### Pact
- Для контрактного тестирования
- Проверяет совместимость между сервисами

### Jest + Supertest
- Для тестирования Node.js приложений
- Простота настройки и хорошая интеграция с Express

### Cypress
- Для end-to-end тестирования
- Поддержка тестирования интеграции фронтенда с бэкендом

## Подходы к тестированию

### Mock-объекты
Использование моков для изоляции тестируемого компонента от внешних зависимостей.

```javascript
// Пример мока API-сервиса
jest.mock('../services/apiService', () => ({
  fetchUserData: jest.fn().mockResolvedValue({
    id: 1,
    name: 'Test User',
    email: 'test@example.com'
  })
}));
```

### Stub-объекты
Предоставляют заранее определенные ответы для внешних вызовов.

### Test Doubles
Общее понятие, включающее моки, стабы, фейки и заглушки.

### Integration Testing в контейнерах
Использование Docker для создания изолированной среды с реальными зависимостями (база данных, внешние сервисы).

## Российские реалии 2025

### Требования к безопасности
- Обязательное тестирование на уязвимости (SQL-инъекции, XSS, CSRF)
- Проверка соответствия требованиям ФСТЭК и ФСБ
- Тестирование систем на наличие "закладок"

### Использование отечественных инструментов
- Применение российских решений для автоматизации тестирования
- Интеграция с отечественными системами CI/CD
- Использование отечественных библиотек для тестирования

### Тестирование отечественных API
- Интеграция с API Госуслуг, Сбер, Яндекс и других российских сервисов
- Проверка соответствия российским стандартам и требованиям

## Лучшие практики

### Автоматизация тестирования
- Интеграция тестов в CI/CD пайплайн
- Запуск тестов при каждом коммите и пуше
- Использование parallel execution для ускорения тестирования

### Тестирование в разных средах
- Тестирование в dev, staging и production-подобной среде
- Проверка работы в разных регионах и с разными провайдерами

### Мониторинг и отчетность
- Использование инструментов для визуализации результатов тестирования
- Уведомления о падении тестов
- Хранение истории тестов и трендов

### Покрытие тестами
- Стремление к высокому покрытию интеграционных тестов
- Приоритет на тестирование критических бизнес-процессов
- Регулярный аудит покрытия тестами

## Стратегии тестирования

### Outside-in тестирование
- Начинается с тестирования пользовательских сценариев
- Постепенно переходит к более детальным интеграционным тестам

### Inside-out тестирование
- Начинается с тестирования внутренних компонентов
- Затем тестируется их взаимодействие с внешними системами

### TDD и BDD для интеграций
- Использование Test-Driven Development для интеграционных тестов
- Behavior-Driven Development для описания ожидаемого поведения систем

## Проблемы и решения

### Проблемы с зависимостями
- Использование mock-сервисов для изоляции
- Создание тестовых версий внешних API
- Использование contract testing для проверки совместимости

### Неустойчивость тестов (flaky tests)
- Правильная настройка таймаутов
- Использование retry-логики
- Изоляция тестов друг от друга

### Сложность отладки
- Подробное логирование в тестах
- Использование инструментов трассировки (например, Jaeger)
- Создание скриптов для воспроизведения проблем

## Интеграция с CI/CD

### Pipeline-ы для тестирования
```yaml
# Пример GitHub Actions для интеграционных тестов
name: Integration Tests
on: [push, pull_request]
jobs:
  integration-tests:
    runs-on: ubuntu-latest
    services:
      database:
        image: postgres:13
        env:
          POSTGRES_PASSWORD: postgres
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    steps:
      - uses: actions/checkout
      - name: Setup Node.js
        uses: actions/setup-node
        with:
          node-version: '18'
      - name: Install dependencies
        run: npm ci
      - name: Run integration tests
        run: npm run test:integration
```

### Параллельное выполнение
- Разделение тестов на независимые группы
- Использование параллельных воркеров для ускорения
- Балансировка нагрузки между тестами

## Связанные темы

- [[API-интеграция]]
- [[Микросервисы]]
- [[Сторонние-библиотеки]]
- [[Legacy-системы]]