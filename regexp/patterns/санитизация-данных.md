---
tags: [programming, regexp, sanitization, frontend, javascript, patterns]
aliases: [санитизация-данных, regexp-sanitization]
---

# Санитизация данных с помощью регулярных выражений

В этой статье рассмотрим паттерны регулярных выражений для санитизации данных в веб-разработке. Санитизация данных — важный этап обработки пользовательского ввода, который помогает предотвратить XSS-атаки, SQL-инъекции и другие проблемы безопасности.

## Основы санитизации

Санитизация данных включает в себя:
- Удаление потенциально опасных символов и конструкций
- Экранирование специальных символов
- Нормализация форматов
- Удаление лишних пробелов и форматирования

```javascript
class BasicSanitizer {
  // Удаление HTML-тегов
  static removeHtmlTags(html) {
    return html.replace(/<[^>]*>/g, '');
  }
  
  // Экранирование HTML-сущностей
  static escapeHtml(text) {
    const escapeMap = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;',
      '/': '&#x2F;'
    };
    
    return text.replace(/[&<>"'\/]/g, match => escapeMap[match]);
  }
  
  // Удаление лишних пробелов
  static removeExtraSpaces(text) {
    return text.replace(/\s+/g, ' ').trim();
  }
  
  // Удаление специальных символов (оставляем только буквы, цифры и пробелы)
  static removeSpecialChars(text) {
    return text.replace(/[^a-zA-Zа-яёА-ЯЁ0-9\s]/g, '');
  }
  
  // Очистка номера телефона
  static sanitizePhone(phone) {
    return phone.replace(/[^\d+]/g, '');
  }
  
  // Очистка номера кредитной карты
  static sanitizeCreditCard(cardNumber) {
    return cardNumber.replace(/[^\d\s-]/g, '');
  }
}

// Примеры использования
console.log('Удаление HTML-тегов:', BasicSanitizer.removeHtmlTags('<p>Текст с <strong>HTML</strong> тегами</p>'));
console.log('Экранирование HTML:', BasicSanitizer.escapeHtml('<script>alert("XSS")</script>'));
console.log('Удаление лишних пробелов:', BasicSanitizer.removeExtraSpaces('  Много   лишних    пробелов   '));
console.log('Удаление специальных символов:', BasicSanitizer.removeSpecialChars('Текст! с@ символами#'));
console.log('Очистка телефона:', BasicSanitizer.sanitizePhone('+7 (926) 123-45-67'));
console.log('Очистка карты:', BasicSanitizer.sanitizeCreditCard('4111-1111-1111-1111'));
```

## Санитизация HTML-контента

```javascript
class HtmlSanitizer {
  // Разрешенные теги и атрибуты
  static allowedTags = new Set([
    'p', 'br', 'strong', 'em', 'u', 'ol', 'ul', 'li', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 
    'blockquote', 'code', 'pre', 'a', 'img', 'b', 'i', 'span'
  ]);
  
  static allowedAttributes = new Set([
    'href', 'src', 'alt', 'title', 'class', 'id', 'style'
  ]);
  
  // Проверка URL в атрибутах
  static isValidUrl(url) {
    try {
      const parsed = new URL(url);
      return ['http:', 'https:', 'mailto:', 'tel:'].includes(parsed.protocol);
    } catch {
      return false;
    }
  }
  
  // Основная функция санитизации HTML
  static sanitize(html) {
    // Удаляем потенциально опасные конструкции
    let sanitized = html
      // Удаляем script-теги и их содержимое
      .replace(/<\s*script[^>]*>[\s\S]*?<\/\s*script\s*>/gi, '')
      // Удаляем обработчики событий
      .replace(/\s+on\w+\s*=\s*["'][^"']*["']/gi, '')
      // Удаляем javascript: ссылки
      .replace(/javascript:/gi, '')
      // Удаляем vbscript: ссылки
      .replace(/vbscript:/gi, '');
    
    // Удаляем теги, кроме разрешенных
    sanitized = sanitized.replace(/<\s*\/?(\w+)[^>]*>/g, (match, tag) => {
      const lowerTag = tag.toLowerCase();
      return this.allowedTags.has(lowerTag) ? match : '';
    });
    
    // Удаляем атрибуты, кроме разрешенных
    sanitized = sanitized.replace(/<(\w+)([^>]*)>/g, (match, tag, attrs) => {
      const lowerTag = tag.toLowerCase();
      if (!this.allowedTags.has(lowerTag)) return '';
      
      // Обрабатываем атрибуты
      const sanitizedAttrs = attrs.replace(/\s*(\w+)\s*=\s*["']([^"']*)["']/g, (attrMatch, attrName, attrValue) => {
        const lowerAttr = attrName.toLowerCase();
        
        if (this.allowedAttributes.has(lowerAttr)) {
          // Проверяем URL в href и src
          if ((lowerAttr === 'href' || lowerAttr === 'src') && !this.isValidUrl(attrValue)) {
            return '';
          }
          return ` ${attrName}="${attrValue}"`;
        }
        return '';
      });
      
      return `<${tag}${sanitizedAttrs}>`;
    });
    
    return sanitized;
  }
  
  // Санитизация стилей
  static sanitizeStyles(styleString) {
    // Удаляем потенциально опасные CSS-свойства
    const dangerousProperties = [
      'position', 'z-index', 'top', 'left', 'right', 'bottom',
      'width', 'height', 'margin', 'padding', 'background', 'color',
      'display', 'visibility', 'opacity', 'transform', 'transition'
    ];
    
    // Удаляем url() конструкции
    let sanitized = styleString.replace(/url\([^)]*\)/gi, '');
    
    // Удаляем @import
    sanitized = sanitized.replace(/@import[^;]*;/gi, '');
    
    return sanitized;
  }
  
  // Санитизация изображений
  static sanitizeImageSrc(src) {
    // Проверяем, что это допустимый URL
    if (!this.isValidUrl(src)) {
      return '';
    }
    
    // Проверяем, что это не data URL (потенциально опасно)
    if (src.startsWith('data:')) {
      return '';
    }
    
    return src;
  }
}

// Примеры использования
const dangerousHtml = `
<div onclick="alert('XSS')">
  <script>alert('XSS')</script>
  <p>Безопасный текст</p>
  <a href="javascript:alert('XSS')">Ссылка</a>
  <img src="data:image/png;base64,..." alt="Изображение">
  <p style="position:absolute;top:0;left:0;">Текст</p>
</div>`;

console.log('Санитизированный HTML:', HtmlSanitizer.sanitize(dangerousHtml));
```

## Санитизация пользовательских данных

```javascript
class UserDataSanitizer {
  // Санитизация имени пользователя
  static sanitizeUsername(username) {
    if (!username) return '';
    
    return username
      .trim() // Удаляем пробелы
      .substring(0, 30) // Ограничиваем длину
      .replace(/[^a-zA-Z0-9_]/g, '') // Оставляем только разрешенные символы
      .substring(0, 30); // Повторяем ограничение длины на случай замены
  }
  
  // Санитизация email
  static sanitizeEmail(email) {
    if (!email) return '';
    
    return email
      .toLowerCase() // Приводим к нижнему регистру
      .trim() // Удаляем пробелы
      .substring(0, 254); // Ограничиваем длину
  }
  
  // Санитизация текста сообщения
  static sanitizeMessage(message) {
    if (!message) return '';
    
    return message
      .substring(0, 10000) // Ограничиваем длину
      .replace(/\0/g, '') // Удаляем null-байты
      .replace(/[\x00-\x1F\x7F]/g, ''); // Удаляем управляющие символы
  }
  
  // Санитизация URL
  static sanitizeUrl(url) {
    if (!url) return '';
    
    // Проверяем, что URL начинается с безопасного протокола
    if (!/^https?:\/\//i.test(url)) {
      return '';
    }
    
    try {
      const urlObj = new URL(url);
      return urlObj.toString();
    } catch {
      return '';
    }
  }
  
  // Санитизация поискового запроса
  static sanitizeSearchQuery(query) {
    if (!query) return '';
    
    return query
      .substring(0, 200) // Ограничиваем длину
      .replace(/[<>]/g, '') // Удаляем угловые скобки
      .replace(/['"]/g, '') // Удаляем кавычки
      .trim();
  }
  
  // Санитизация телефонного номера
  static sanitizePhone(phone) {
    if (!phone) return '';
    
    // Оставляем только цифры и символы +, -, (, )
    return phone
      .replace(/[^\d+\-\s\(\)]/g, '')
      .substring(0, 20); // Ограничиваем длину
  }
  
  // Санитизация даты
  static sanitizeDate(dateString) {
    if (!dateString) return '';
    
    // Проверяем формат даты и нормализуем
    const date = new Date(dateString);
    if (isNaN(date.getTime())) {
      return '';
    }
    
    // Проверяем, что дата в разумном диапазоне
    const now = new Date();
    const minDate = new Date('1900-01-01');
    const maxDate = new Date('2100-12-31');
    
    if (date < minDate || date > maxDate) {
      return '';
    }
    
    return date.toISOString().split('T')[0];
  }
}

// Примеры использования
console.log('Санитизация имени:', UserDataSanitizer.sanitizeUsername('user@name!'));
console.log('Санитизация email:', UserDataSanitizer.sanitizeEmail('User@EXAMPLE.COM'));
console.log('Санитизация сообщения:', UserDataSanitizer.sanitizeMessage('Привет <script>alert("XSS")</script> мир!'));
console.log('Санитизация URL:', UserDataSanitizer.sanitizeUrl('javascript:alert("XSS")'));
console.log('Санитизация поиска:', UserDataSanitizer.sanitizeSearchQuery('search query <script>'));
console.log('Санитизация телефона:', UserDataSanitizer.sanitizePhone('+7 (926) 123-45-67 ext. 123'));
console.log('Санитизация даты:', UserDataSanitizer.sanitizeDate('2023-12-25'));
```

## Санитизация числовых данных

```javascript
class NumberSanitizer {
  // Санитизация целого числа
  static sanitizeInteger(value, min = Number.MIN_SAFE_INTEGER, max = Number.MAX_SAFE_INTEGER) {
    if (value === null || value === undefined || value === '') {
      return null;
    }
    
    // Преобразуем в число и проверяем
    const num = parseInt(value, 10);
    
    if (isNaN(num)) {
      return null;
    }
    
    // Проверяем диапазон
    if (num < min || num > max) {
      return Math.max(min, Math.min(max, num));
    }
    
    return num;
  }
  
  // Санитизация числа с плавающей точкой
  static sanitizeFloat(value, min = Number.MIN_VALUE, max = Number.MAX_VALUE, decimals = 2) {
    if (value === null || value === undefined || value === '') {
      return null;
    }
    
    // Преобразуем в число и проверяем
    const num = parseFloat(value);
    
    if (isNaN(num)) {
      return null;
    }
    
    // Проверяем диапазон
    if (num < min || num > max) {
      return Math.max(min, Math.min(max, num));
    }
    
    // Ограничиваем количество знаков после запятой
    return Number(num.toFixed(decimals));
  }
  
  // Санитизация процента
  static sanitizePercentage(value) {
    return this.sanitizeFloat(value, 0, 100, 2);
  }
  
  // Санитизация денежного значения
  static sanitizeCurrency(value, decimals = 2) {
    // Удаляем все, кроме цифр, точки и минуса
    const cleanValue = value.toString().replace(/[^\d.-]/g, '');
    const num = parseFloat(cleanValue);
    
    if (isNaN(num) || num < 0) {
      return 0;
    }
    
    return Number(num.toFixed(decimals));
  }
  
  // Санитизация года
  static sanitizeYear(value) {
    return this.sanitizeInteger(value, 1900, 2100);
  }
  
  // Санитизация возраста
  static sanitizeAge(value) {
    return this.sanitizeInteger(value, 0, 150);
  }
  
  // Санитизация IP-адреса
  static sanitizeIp(ip) {
    // Проверяем формат IPv4
    const ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
    
    if (ipv4Regex.test(ip)) {
      return ip;
    }
    
    // Проверяем формат IPv6 (упрощенно)
    const ipv6Regex = /^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::1$|^::$/;
    
    if (ipv6Regex.test(ip)) {
      return ip;
    }
    
    return '';
  }
}

// Примеры использования
console.log('Целое число:', NumberSanitizer.sanitizeInteger('123abc', 0, 1000));
console.log('Число с плавающей точкой:', NumberSanitizer.sanitizeFloat('123.456', 0, 1000, 2));
console.log('Процент:', NumberSanitizer.sanitizePercentage('110'));
console.log('Валюта:', NumberSanitizer.sanitizeCurrency('$123.45'));
console.log('Год:', NumberSanitizer.sanitizeYear('2023'));
console.log('Возраст:', NumberSanitizer.sanitizeAge('150'));
console.log('IP-адрес:', NumberSanitizer.sanitizeIp('192.168.1.1'));
```

## Санитизация JSON-подобных данных

```javascript
class JsonSanitizer {
  // Санитизация JSON-строки
  static sanitizeJsonString(jsonString) {
    try {
      // Проверяем, что это валидный JSON
      const parsed = JSON.parse(jsonString);
      return JSON.stringify(parsed);
    } catch (e) {
      // Если невалидный JSON, пытаемся очистить
      return this.attemptSanitize(jsonString);
    }
  }
  
  // Попытка санитизации потенциально опасного JSON
  static attemptSanitize(jsonString) {
    // Удаляем потенциально опасные символы
    let sanitized = jsonString
      .replace(/\0/g, '') // Null-байты
      .replace(/[\x00-\x1F\x7F]/g, '') // Управляющие символы
      .replace(/<\s*script[^>]*>[\s\S]*?<\/\s*script\s*>/gi, ''); // Скрипты
    
    // Пытаемся снова распарсить
    try {
      const parsed = JSON.parse(sanitized);
      return JSON.stringify(parsed);
    } catch (e) {
      return '{}'; // Возвращаем пустой объект в случае ошибки
    }
  }
  
  // Санитизация ключей объекта
  static sanitizeObjectKeys(obj) {
    if (typeof obj !== 'object' || obj === null) {
      return obj;
    }
    
    const sanitized = {};
    
    for (const [key, value] of Object.entries(obj)) {
      // Санитизируем ключ
      const sanitizedKey = key
        .replace(/[^\w\s-]/g, '') // Удаляем специальные символы
        .substring(0, 50); // Ограничиваем длину
      
      // Рекурсивно санитизируем значение
      sanitized[sanitizedKey] = typeof value === 'object' && value !== null
        ? this.sanitizeObjectKeys(value)
        : this.sanitizeValue(value);
    }
    
    return sanitized;
  }
  
  // Санитизация значений
  static sanitizeValue(value) {
    if (typeof value === 'string') {
      return value
        .substring(0, 1000) // Ограничиваем длину
        .replace(/\0/g, '') // Удаляем null-байты
        .replace(/[<>]/g, '') // Удаляем угловые скобки
        .replace(/['"]/g, ''); // Удаляем кавычки
    } else if (typeof value === 'number') {
      return Number.isFinite(value) ? value : 0;
    } else if (typeof value === 'boolean') {
      return value;
    } else if (Array.isArray(value)) {
      return value.map(item => this.sanitizeValue(item));
    } else if (typeof value === 'object' && value !== null) {
      return this.sanitizeObjectKeys(value);
    }
    
    return value;
  }
  
  // Санитизация параметров запроса
  static sanitizeQueryParams(params) {
    const sanitized = {};
    
    for (const [key, value] of Object.entries(params)) {
      // Санитизируем ключ
      const sanitizedKey = key
        .replace(/[^\w\s-]/g, '')
        .substring(0, 50);
      
      // Санитизируем значение
      if (Array.isArray(value)) {
        sanitized[sanitizedKey] = value.map(v => this.sanitizeValue(v));
      } else {
        sanitized[sanitizedKey] = this.sanitizeValue(value);
      }
    }
    
    return sanitized;
  }
  
  // Санитизация тела запроса
  static sanitizeRequestBody(body) {
    return this.sanitizeObjectKeys(body);
  }
}

// Примеры использования
const testJson = '{"name": "John", "email": "<script>alert(\"XSS\")</script>", "age": 30}';
console.log('Санитизированный JSON:', JsonSanitizer.sanitizeJsonString(testJson));

const testObject = {
  'valid-key': 'valid value',
  'invalid<script>key': '<script>alert("XSS")</script>',
  'nested': {
    'another<script>key': 'safe value'
  }
};
console.log('Санитизированный объект:', JsonSanitizer.sanitizeObjectKeys(testObject));

const queryParams = {
  'search': '<script>alert("XSS")</script>',
  'limit': '10',
  'offset': '0'
};
console.log('Санитизированные параметры:', JsonSanitizer.sanitizeQueryParams(queryParams));
```

## Санитизация файлов и имен файлов

```javascript
class FileSanitizer {
  // Разрешенные расширения файлов
  static allowedExtensions = new Set([
    'jpg', 'jpeg', 'png', 'gif', 'pdf', 'doc', 'docx', 'txt', 'zip', 'rar'
  ]);
  
  // Санитизация имени файла
  static sanitizeFilename(filename) {
    if (!filename) return '';
    
    // Разделяем имя и расширение
    const lastDotIndex = filename.lastIndexOf('.');
    let name, ext = '';
    
    if (lastDotIndex > 0) {
      name = filename.substring(0, lastDotIndex);
      ext = filename.substring(lastDotIndex + 1).toLowerCase();
    } else {
      name = filename;
    }
    
    // Проверяем расширение
    if (ext && !this.allowedExtensions.has(ext)) {
      return '';
    }
    
    // Санитизируем имя файла
    name = name
      .replace(/[^\w\s-]/g, '_') // Заменяем специальные символы на подчеркивание
      .replace(/\s+/g, '_') // Заменяем пробелы на подчеркивание
      .substring(0, 100); // Ограничиваем длину
    
    // Убираем потенциально опасные последовательности
    name = name.replace(/\.{2,}/g, '.'); // Убираем множественные точки
    
    return ext ? `${name}.${ext}` : name;
  }
  
  // Санитизация пути к файлу
  static sanitizeFilePath(filepath) {
    if (!filepath) return '';
    
    // Удаляем потенциально опасные последовательности
    return filepath
      .replace(/\.\.\//g, '') // Убираем path traversal
      .replace(/\.\.\\/g, '') // Убираем path traversal для Windows
      .replace(/^[\/\\]+/, '') // Убираем начальные слэши
      .substring(0, 255); // Ограничиваем длину
  }
  
  // Проверка MIME-типа
  static validateMimeType(mimeType, allowedTypes = []) {
    if (allowedTypes.length === 0) {
      // По умолчанию разрешаем безопасные типы
      allowedTypes = [
        'image/jpeg', 'image/png', 'image/gif',
        'application/pdf', 'text/plain',
        'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
      ];
    }
    
    return allowedTypes.includes(mimeType);
  }
  
  // Санитизация размера файла (в байтах)
  static sanitizeFileSize(size, maxSize = 10 * 1024 * 1024) { // 10MB по умолчанию
    const numSize = parseInt(size, 10);
    
    if (isNaN(numSize) || numSize < 0) {
      return 0;
    }
    
    return Math.min(numSize, maxSize);
  }
  
  // Санитизация информации о файле
  static sanitizeFileInfo(fileInfo) {
    return {
      name: this.sanitizeFilename(fileInfo.name),
      size: this.sanitizeFileSize(fileInfo.size),
      type: fileInfo.type || 'application/octet-stream'
    };
  }
}

// Примеры использования
console.log('Санитизация имени файла:', FileSanitizer.sanitizeFilename('document<script>.pdf'));
console.log('Санитизация пути:', FileSanitizer.sanitizeFilePath('../../../etc/passwd'));
console.log('Проверка MIME-типа:', FileSanitizer.validateMimeType('image/jpeg'));
console.log('Санитизация размера:', FileSanitizer.sanitizeFileSize('15728640')); // 15MB

const fileInfo = {
  name: 'malicious.php.exe',
  size: '5242880', // 5MB
  type: 'application/x-php'
};
console.log('Санитизированная информация о файле:', FileSanitizer.sanitizeFileInfo(fileInfo));
```

## Санитизация данных формы

```javascript
class FormSanitizer {
  // Правила санитизации для разных типов полей
  static sanitizationRules = {
    text: (value) => {
      return value
        .substring(0, 1000)
        .replace(/[<>]/g, '')
        .replace(/['"]/g, '')
        .trim();
    },
    email: (value) => {
      return value
        .toLowerCase()
        .trim()
        .substring(0, 254);
    },
    number: (value) => {
      const num = parseFloat(value);
      return isNaN(num) ? 0 : num;
    },
    url: (value) => {
      if (!/^https?:\/\//i.test(value)) return '';
      try {
        return new URL(value).toString();
      } catch {
        return '';
      }
    },
    phone: (value) => {
      return value.replace(/[^\d+]/g, '').substring(0, 20);
    },
    password: (value) => {
      // Пароли не санитизируются, только проверяются на длину
      return value.substring(0, 128);
    }
  };
  
  // Санитизация формы
  static sanitizeForm(formData, fieldTypes = {}) {
    const sanitized = {};
    
    for (const [fieldName, value] of Object.entries(formData)) {
      const fieldType = fieldTypes[fieldName] || 'text';
      const sanitizer = this.sanitizationRules[fieldType] || this.sanitizationRules.text;
      
      sanitized[fieldName] = sanitizer(value);
    }
    
    return sanitized;
  }
  
  // Санитизация массива форм
  static sanitizeFormArray(forms, fieldTypes = {}) {
    return forms.map(form => this.sanitizeForm(form, fieldTypes));
  }
  
  // Санитизация формы с сохранением структуры
  static sanitizeStructuredForm(formData, structure) {
    const sanitized = {};
    
    for (const [field, config] of Object.entries(structure)) {
      const value = formData[field];
      
      if (value === undefined) continue;
      
      if (config.type === 'array') {
        if (Array.isArray(value)) {
          sanitized[field] = value.map(item => 
            typeof item === 'object' ? 
              this.sanitizeStructuredForm(item, config.elementStructure || {}) : 
              this.sanitizeValue(item, config.elementType || 'text')
          );
        } else {
          sanitized[field] = [];
        }
      } else {
        sanitized[field] = this.sanitizeValue(value, config.type || 'text');
      }
    }
    
    return sanitized;
  }
  
  // Санитизация отдельного значения
  static sanitizeValue(value, type = 'text') {
    const sanitizer = this.sanitizationRules[type] || this.sanitizationRules.text;
    return sanitizer(value);
  }
  
  // Создание санитайзера для конкретной формы
  static createFormSanitizer(fieldTypes) {
    return {
      sanitize: (formData) => {
        return this.sanitizeForm(formData, fieldTypes);
      }
    };
  }
}

// Пример использования
const formData = {
  name: 'John <script>alert("XSS")</script>',
  email: 'JOHN@EXAMPLE.COM  ',
  age: '30',
  website: 'javascript:alert("XSS")',
  phone: '+7 (926) 123-45-67',
  password: 'mySecurePassword123'
};

const fieldTypes = {
  name: 'text',
  email: 'email',
  age: 'number',
  website: 'url',
  phone: 'phone',
  password: 'password'
};

console.log('Санитизированная форма:', FormSanitizer.sanitizeForm(formData, fieldTypes));

// Пример структурированной формы
const structuredFormData = {
  user: {
    name: 'John',
    email: 'john@example.com'
  },
  preferences: ['<script>', 'safe', 'prefs'],
  settings: {
    theme: 'dark',
    notifications: true
  }
};

const formStructure = {
  user: { type: 'object', elementStructure: { name: { type: 'text' }, email: { type: 'email' } } },
  preferences: { type: 'array', elementType: 'text' },
  settings: { type: 'object', elementStructure: { theme: { type: 'text' }, notifications: { type: 'text' } } }
};

console.log('Санитизированная структурированная форма:', FormSanitizer.sanitizeStructuredForm(structuredFormData, formStructure));
```

## Заключение

Санитизация данных с помощью регулярных выражений и других методов — критически важная часть безопасности веб-приложений. Правильная санитизация позволяет:

1. **Предотвращать XSS-атаки** за счет удаления или экранирования HTML/JavaScript
2. **Обеспечивать целостность данных** за счет нормализации и ограничения форматов
3. **Снижать риск инъекций** за счет удаления потенциально опасных символов
4. **Улучшать качество данных** за счет удаления мусора и форматирования

При реализации санитизации важно:
- Санитизировать данные на всех уровнях (ввод, хранение, вывод)
- Использовать белые списки разрешенных элементов
- Проводить валидацию после санитизации
- Обрабатывать граничные случаи и ошибки

## Следующие шаги

После изучения санитизации данных рекомендуется:

- [[Валидация различных форматов]]
- [[Проверка сложных условий в строках]]
- [[Практические примеры]]