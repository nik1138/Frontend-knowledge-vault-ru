---
tags: [programming, regexp, errors, frontend, javascript, advanced]
aliases: [—Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏-–∏-–∫–∞–∫-–∏—Ö-–∏–∑–±–µ–≥–∞—Ç—å, regexp-errors]
---

# –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–≥–∞—Ç—å

–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Å–ø–æ—Å–æ–±—ã –∏—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö –æ—à–∏–±–æ–∫ –ø–æ–º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è.

## –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

```javascript
// –û—à–∏–±–∫–∞: –Ω–µ—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
function searchKeyword(text, keyword) {
  // –ü–õ–û–•–û: –µ—Å–ª–∏ keyword —Å–æ–¥–µ—Ä–∂–∏—Ç '.', '?', '*', '+' –∏ —Ç.–¥., —ç—Ç–æ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª
  const regex = new RegExp(keyword, 'gi');
  return text.match(regex);
}

// –ü–†–ê–í–ò–õ–¨–ù–û: —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
function searchKeywordSafe(text, keyword) {
  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
  const escapedKeyword = keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  const regex = new RegExp(escapedKeyword, 'gi');
  return text.match(regex);
}

// –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã
const text = "–£–∑–Ω–∞–π—Ç–µ –±–æ–ª—å—à–µ –Ω–∞ —Å–∞–π—Ç–µ example.com –∏–ª–∏ –ø–æ—Å–µ—Ç–∏—Ç–µ test.org";
const keyword = "example.com"; // –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—á–∫—É, –∫–æ—Ç–æ—Ä–∞—è –≤ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö –æ–∑–Ω–∞—á–∞–µ—Ç "–ª—é–±–æ–π —Å–∏–º–≤–æ–ª"

console.log('–ë–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:', searchKeyword(text, keyword)); // –ù–∞—Ö–æ–¥–∏—Ç "example.com" –∏ "exampleXcom" (–≥–¥–µ X - –ª—é–±–æ–π —Å–∏–º–≤–æ–ª)
console.log('–° —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º:', searchKeywordSafe(text, keyword)); // –ù–∞—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ "example.com"
```

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤

```javascript
// –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏
class QuantifierMistakes {
  // –û—à–∏–±–∫–∞ 1: —á—Ä–µ–∑–º–µ—Ä–Ω—ã–π backtracking
  static problematicPattern = /(a+)+b/; // –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  
  // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —É–ø—Ä–æ—â–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
  static fixedPattern = /a+b/;
  
  // –û—à–∏–±–∫–∞ 2: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∂–∞–¥–Ω—ã—Ö/–ª–µ–Ω–∏–≤—ã—Ö –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
  static extractTagsBad(html) {
    // –ü–õ–û–•–û: –∂–∞–¥–Ω—ã–π –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞—Ö–≤–∞—Ç–∏—Ç –≤—Å–µ –º–µ–∂–¥—É –ø–µ—Ä–≤—ã–º –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Ç–µ–≥–æ–º
    const matches = html.match(/<.*>/g);
    return matches;
  }
  
  static extractTagsGood(html) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: –ª–µ–Ω–∏–≤—ã–π –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è
    const matches = html.match(/<[^>]*>/g);
    return matches;
  }
  
  // –û—à–∏–±–∫–∞ 3: –Ω–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –∂–∞–¥–Ω—ã–º–∏ –∏ –ª–µ–Ω–∏–≤—ã–º–∏ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏
  static findContentBad(text) {
    // –ü–õ–û–•–û: –∑–∞—Ö–≤–∞—Ç–∏—Ç –≤—Å–µ –º–µ–∂–¥—É –ø–µ—Ä–≤—ã–º –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤—Ö–æ–∂–¥–µ–Ω–∏–µ–º
    return text.match(/start(.*?)end/g);
  }
  
  static findContentGood(text) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–¥–∞—á–∏, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
    return text.match(/start((?:(?!start|end)[\s\S])*?)end/g);
  }
}

// –ü—Ä–∏–º–µ—Ä—ã
const htmlExample = '<div>–ö–æ–Ω—Ç–µ–Ω—Ç 1</div><p>–ö–æ–Ω—Ç–µ–Ω—Ç 2</p>';
console.log('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:', QuantifierMistakes.extractTagsBad(htmlExample));
// ['<div>–ö–æ–Ω—Ç–µ–Ω—Ç 1</div><p>–ö–æ–Ω—Ç–µ–Ω—Ç 2</p>'] - –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ–∂–¥—É –ø–µ—Ä–≤—ã–º < –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º >

console.log('–ü—Ä–∞–≤–∏–ª—å–Ω–æ:', QuantifierMistakes.extractTagsGood(htmlExample));
// ['<div>', '</div>', '<p>', '</p>'] - –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ–≥–∏

const contentExample = 'start –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å end –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ start –≤—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å end';
console.log('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:', QuantifierMistakes.findContentBad(contentExample));
// ['start –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å end –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ start –≤—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å end']

console.log('–ü—Ä–∞–≤–∏–ª—å–Ω–æ:', QuantifierMistakes.findContentGood(contentExample));
// ['start –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å end', 'start –≤—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å end']
```

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —Å–ª–æ–≤ –∏ —Å—Ç—Ä–æ–∫

```javascript
class BoundaryMistakes {
  // –û—à–∏–±–∫–∞: –Ω–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Å–ª–æ–≤
  static findWordsBad(text) {
    // –ü–õ–û–•–û: –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã —Å–ª–æ–≤
    const regex = /cat/gi;
    return text.match(regex);
  }
  
  static findWordsGood(text) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã —Å–ª–æ–≤
    const regex = /\bcat\b/gi;
    return text.match(regex);
  }
  
  // –û—à–∏–±–∫–∞: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
  static multilineMistake(text) {
    // –ü–õ–û–•–û: –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ—Å—Ç—å
    const regex = /^.*$/g; // –ó–∞—Ö–≤–∞—Ç–∏—Ç —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É –≤ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Ä–µ–∂–∏–º–µ
    return text.match(regex);
  }
  
  static multilineFixed(text) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–ª–∞–≥ 'm' –¥–ª—è –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
    const regex = /^.*$/gm;
    return text.match(regex);
  }
  
  // –û—à–∏–±–∫–∞: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ \b
  static wordBoundaryExample() {
    const text = "The cat's hat is in the cathedral";
    const regex = /\bcat\b/gi;
    
    // –ù–∞—Ö–æ–¥–∏—Ç "cat" –≤ "cat's" –∏ "cathedral"?
    // –ù–ï–¢! \b —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É \w –∏ \W, –∏–ª–∏ –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏
    // "cat" –≤ "cat's" –Ω–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ—Å–ª–µ 'c' –∏–¥–µ—Ç 'a' (–æ–±–∞ \w)
    // "cat" –≤ "cathedral" –Ω–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–µ—Ä–µ–¥ 'c' –∏–¥–µ—Ç 'h' (–æ–±–∞ \w)
    
    console.log(text.match(regex)); // ["cat"] - —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ "cat"
  }
}

// –ü—Ä–∏–º–µ—Ä—ã
const wordExample = "The cat's cat and cathedral";
console.log('–ë–µ–∑ –≥—Ä–∞–Ω–∏—Ü —Å–ª–æ–≤:', BoundaryMistakes.findWordsBad(wordExample)); // ['cat', 'cat', 'cat'] - –≤–∫–ª—é—á–∞—è —á–∞—Å—Ç–∏ —Å–ª–æ–≤
console.log('–° –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —Å–ª–æ–≤:', BoundaryMistakes.findWordsGood(wordExample)); // ['cat'] - —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ

const multilineExample = `—Å—Ç—Ä–æ–∫–∞ 1
—Å—Ç—Ä–æ–∫–∞ 2
—Å—Ç—Ä–æ–∫–∞ 3`;
console.log('–ë–µ–∑ —Ñ–ª–∞–≥–∞ m:', BoundaryMistakes.multilineMistake(multilineExample)); // null –∏–ª–∏ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞
console.log('–° —Ñ–ª–∞–≥–æ–º m:', BoundaryMistakes.multilineFixed(multilineExample)); // ['—Å—Ç—Ä–æ–∫–∞ 1', '—Å—Ç—Ä–æ–∫–∞ 2', '—Å—Ç—Ä–æ–∫–∞ 3']
```

## –û—à–∏–±–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ ReDoS (Regular Expression Denial of Service)

```javascript
class RedosVulnerability {
  // –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—è–∑–≤–∏–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
  static vulnerablePatterns = {
    // 1. –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    nestedQuantifiers: /(a+)+/,
    
    // 2. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ü–∏—è —Å –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–º–∏—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
    overlappingAlternation: /(a|aa)+/,
    
    // 3. –°–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email
    complexEmail: /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,
    
    // 4. –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML
    htmlParser: /<[^>]*>|{{.*}}/,
    
    // 5. –°–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∫
    stringParser: /(["'])((?:(?!\1)[^\\]|\\.)*)(\1)/
  };
  
  // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å
  static testVulnerability(pattern, input, timeout = 1000) {
    const regex = new RegExp(pattern);
    
    const startTime = Date.now();
    let result;
    
    try {
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è
      const timerId = setTimeout(() => {
        throw new Error('Timeout - –≤–æ–∑–º–æ–∂–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å ReDoS');
      }, timeout);
      
      result = regex.test(input);
      clearTimeout(timerId);
    } catch (e) {
      return {
        vulnerable: true,
        error: e.message,
        time: Date.now() - startTime
      };
    }
    
    const endTime = Date.now();
    return {
      vulnerable: endTime - startTime > timeout * 0.8, // –ï—Å–ª–∏ –≤—Ä–µ–º—è –±–ª–∏–∑–∫–æ –∫ —Ç–∞–π–º–∞—É—Ç—É
      result,
      time: endTime - startTime
    };
  }
  
  // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
  static safeAlternatives = {
    // –í–º–µ—Å—Ç–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
    simpleQuantifier: /a+/,
    
    // –í–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email
    simpleEmail: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
    
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤–º–µ—Å—Ç–æ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á
    validateWithLibraries: (input) => {
      // –í–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–≥–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π
      // –ù–∞–ø—Ä–∏–º–µ—Ä, validator.js –∏–ª–∏ –¥—Ä—É–≥–∏–µ
      return true; // –ó–∞–≥–ª—É—à–∫–∞
    }
  };
  
  // –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
  static safeEmailValidation(email) {
    // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø—Ä–æ—Å—Ç—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      return false;
    }
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
    const [localPart, domain] = email.split('@');
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã
    if (localPart.length > 64 || domain.length > 255) {
      return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–≤–æ–π–Ω—ã–µ —Ç–æ—á–∫–∏
    if (email.includes('..')) {
      return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∏–º–≤–æ–ª–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏
    if (localPart.startsWith('.') || localPart.endsWith('.')) {
      return false;
    }
    
    return true;
  }
}

// –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏
const maliciousInputs = [
  'a'.repeat(1000) + '!',  // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
  'aaaaaaaaaaaaaaaaaaaaa!', // –î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
  'a'.repeat(100) + '@' + 'b'.repeat(100) + '.com' // –î–ª—è email-–ø–∞—Ç—Ç–µ—Ä–Ω–∞
];

console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ ReDoS:');
for (const [name, pattern] of Object.entries(RedosVulnerability.vulnerablePatterns).slice(0, 2)) {
  for (const input of maliciousInputs.slice(0, 1)) {
    const result = RedosVulnerability.testVulnerability(pattern, input, 500);
    console.log(`${name}: ${result.vulnerable ? '–£–Ø–ó–í–ò–ú' : 'OK'} (${result.time}ms)`);
  }
}
```

### –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

```javascript
class InputSecurity {
  // –û–ø–∞—Å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
  static dangerousReplace(userInput, template) {
    // –ü–õ–û–•–û: –Ω–∞–ø—Ä—è–º—É—é –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤ –∑–∞–º–µ–Ω–µ
    return template.replace('{USER_INPUT}', userInput);
  }
  
  static dangerousSearch(userInput, text) {
    // –ü–õ–û–•–û: –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–∏
    const regex = new RegExp(userInput, 'gi');
    return text.search(regex);
  }
  
  // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
  static safeReplace(userInput, template) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –≤–≤–æ–¥–µ
    const escapedInput = userInput.replace(/[{}\\^$*+?.()|[\]]/g, '\\$&');
    return template.replace('{USER_INPUT}', escapedInput);
  }
  
  static safeSearch(userInput, text) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥
    const escapedInput = userInput.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const regex = new RegExp(escapedInput, 'gi');
    return text.search(regex);
  }
  
  // –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ HTML
  static sanitizeForHtml(input) {
    const escapeMap = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;',
      '/': '&#x2F;'
    };
    
    return input.replace(/[&<>"'\/]/g, match => escapeMap[match]);
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
  static validateRegexPattern(pattern) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    const dangerousPatterns = [
      /\(.*\)\+/,  // –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
      /\[.*\]\+/,  // –ö–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ –∫–ª–∞—Å—Å–∞—Ö —Å–∏–º–≤–æ–ª–æ–≤
      /.*\{.*\}.*/, // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    ];
    
    for (const dangerous of dangerousPatterns) {
      if (dangerous.test(pattern)) {
        throw new Error('–ü–∞—Ç—Ç–µ—Ä–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏');
      }
    }
    
    return true;
  }
}

// –ü—Ä–∏–º–µ—Ä—ã
const dangerousInput = 'test$^*+?{}[]|()\\.';
const template = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª: {USER_INPUT}';

console.log('–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–º–µ–Ω–∞:', InputSecurity.dangerousReplace(dangerousInput, template));
console.log('–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–º–µ–Ω–∞:', InputSecurity.safeReplace(dangerousInput, template));
```

## –û—à–∏–±–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤ —Ü–∏–∫–ª–∞—Ö

```javascript
// –û–®–ò–ë–ö–ê: —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ —Ü–∏–∫–ª–µ
function validateEmailsInefficient(emails) {
  const results = [];
  
  for (const email of emails) {
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
    const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    results.push({ email, isValid });
  }
  
  return results;
}

// –ü–†–ê–í–ò–õ–¨–ù–û: –∫—ç—à–∏—Ä—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
function validateEmailsEfficient(emails) {
  // –°–æ–∑–¥–∞–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –æ–¥–∏–Ω —Ä–∞–∑
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  const results = [];
  
  for (const email of emails) {
    const isValid = emailRegex.test(email);
    results.push({ email, isValid });
  }
  
  return results;
}

// –ë–æ–ª–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
class RegexValidator {
  constructor() {
    this.cache = new Map();
  }
  
  get(pattern, flags = '') {
    const key = `${pattern}_${flags}`;
    if (!this.cache.has(key)) {
      this.cache.set(key, new RegExp(pattern, flags));
    }
    return this.cache.get(key);
  }
  
  validateEmail(email) {
    const regex = this.get('^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$', 'i');
    return regex.test(email);
  }
  
  validatePhone(phone) {
    const regex = this.get('^\\+?[1-9]\\d{1,14}$');
    return regex.test(phone);
  }
  
  validateUrl(url) {
    const regex = this.get('^https?://[^\s/$.?#].[^\s]*$', 'i');
    return regex.test(url);
  }
}

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
const testEmails = ['user@example.com', 'test@domain.org', 'admin@site.net'].repeat(1000).split(',');

console.time('–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥');
validateEmailsInefficient(testEmails);
console.timeEnd('–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥');

console.time('–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥');
validateEmailsEfficient(testEmails);
console.timeEnd('–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥');

const validator = new RegexValidator();
console.time('–° –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º');
testEmails.forEach(email => validator.validateEmail(email));
console.timeEnd('–° –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º');
```

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –¥–ª—è –∑–∞–¥–∞—á–∏

```javascript
class MethodSelection {
  // –û—à–∏–±–∫–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏
  static checkSimplePresenceBad(text, word) {
    // –ü–õ–û–•–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º match –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è
    const matches = text.match(new RegExp(word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'i'));
    return matches !== null;
  }
  
  static checkSimplePresenceGood(text, word) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º test –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è
    const regex = new RegExp(word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'i');
    return regex.test(text);
  }
  
  // –û—à–∏–±–∫–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π —Ç–∞–º, –≥–¥–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
  static containsSubstringBad(text, substring) {
    // –ü–õ–û–•–û: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏
    const regex = new RegExp(substring.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'i');
    return regex.test(text);
  }
  
  static containsSubstringGood(text, substring) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥
    return text.toLowerCase().includes(substring.toLowerCase());
  }
  
  // –ö–æ–≥–¥–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω—ã —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
  static extractComplexPattern(text) {
    // –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –æ–ø—Ä–∞–≤–¥–∞–Ω—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
    const emailRegex = /\b[\w.-]+@[\w.-]+\.\w{2,}\b/g;
    return text.match(emailRegex) || [];
  }
  
  static replaceWithLogic(text, pattern, replacementFn) {
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∑–∞–º–µ–Ω—ã
    const regex = new RegExp(pattern, 'g');
    return text.replace(regex, (match) => replacementFn(match));
  }
}

// –ü—Ä–∏–º–µ—Ä—ã
const sampleText = 'Email: user@example.com, –¢–µ–ª–µ—Ñ–æ–Ω: 123-456-7890';
const word = 'email';

console.log('–ü–ª–æ—Ö–æ–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Ä–∫–∏:', MethodSelection.checkSimplePresenceBad(sampleText, word));
console.log('–•–æ—Ä–æ—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Ä–∫–∏:', MethodSelection.checkSimplePresenceGood(sampleText, word));

console.log('–ü–ª–æ—Ö–æ–π —Å–ø–æ—Å–æ–± –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏:', MethodSelection.containsSubstringBad(sampleText, 'user'));
console.log('–•–æ—Ä–æ—à–∏–π —Å–ø–æ—Å–æ–± –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏:', MethodSelection.containsSubstringGood(sampleText, 'user'));

console.log('–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ email:', MethodSelection.extractComplexPattern(sampleText));
```

## –û—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Unicode –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–º–∏ —è–∑—ã–∫–∞–º–∏

```javascript
class UnicodeMistakes {
  // –û—à–∏–±–∫–∞: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π
  static validateNameBad(name) {
    // –ü–õ–û–•–û: —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ª–∞—Ç–∏–Ω–∏—Ü–µ–π
    return /^[a-zA-Z\s]+$/.test(name);
  }
  
  static validateNameGood(name) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Unicode
    return /^[\p{L}\s]+$/u.test(name); // \p{L} –æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±—É—é –±—É–∫–≤—É –≤ Unicode
  }
  
  // –û—à–∏–±–∫–∞: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —ç–º–æ–¥–∑–∏
  static countWordsBad(text) {
    // –ü–õ–û–•–û: –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–≥–æ—Å–∏–º–≤–æ–ª—å–Ω—ã–µ —ç–º–æ–¥–∑–∏
    return text.split(/\s+/).filter(word => word.length > 0).length;
  }
  
  static countWordsGood(text) {
    // –ü–†–ê–í–ò–õ–¨–ù–û: —É—á–∏—Ç—ã–≤–∞–µ–º Unicode
    return text.match(/[\p{L}\p{N}]+/gu)?.length || 0; // \p{N} –¥–ª—è —á–∏—Å–µ–ª
  }
  
  // –†–∞–±–æ—Ç–∞ —Å —ç–º–æ–¥–∑–∏
  static extractEmojis(text) {
    // –ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —ç–º–æ–¥–∑–∏
    const emojiRegex = /[\p{Emoji}]/gu;
    return text.match(emojiRegex) || [];
  }
  
  // –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–ª–∏–Ω–æ–π —Å—Ç—Ä–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —ç–º–æ–¥–∑–∏
  static safeStringLength(str) {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º Array.from –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞ —Å–∏–º–≤–æ–ª–æ–≤
    return Array.from(str).length;
  }
}

// –ü—Ä–∏–º–µ—Ä—ã
const cyrillicName = '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤';
const textWithEmojis = '–ü—Ä–∏–≤–µ—Ç! üëã –ö–∞–∫ –¥–µ–ª–∞? ü§î –≠—Ç–æ —Ç–µ—Å—Ç üß™ —Å —ç–º–æ–¥–∑–∏ üì±';

console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ (–ø–ª–æ—Ö–æ):', UnicodeMistakes.validateNameBad(cyrillicName)); // false
console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ (—Ö–æ—Ä–æ—à–æ):', UnicodeMistakes.validateNameGood(cyrillicName)); // true

console.log('–ü–æ–¥—Å—á–µ—Ç —Å–ª–æ–≤ (–ø–ª–æ—Ö–æ):', UnicodeMistakes.countWordsBad(textWithEmojis));
console.log('–ü–æ–¥—Å—á–µ—Ç —Å–ª–æ–≤ (—Ö–æ—Ä–æ—à–æ):', UnicodeMistakes.countWordsGood(textWithEmojis));

console.log('–≠–º–æ–¥–∑–∏:', UnicodeMistakes.extractEmojis(textWithEmojis));

const emojiString = 'üëã –ü—Ä–∏–≤–µ—Ç! üë®‚Äçüíª';
console.log('–î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ (–æ–±—ã—á–Ω–∞—è):', emojiString.length); // –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π
console.log('–î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ (Unicode):', UnicodeMistakes.safeStringLength(emojiString)); // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è
```

## –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π

```javascript
class RegexDebugger {
  // –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
  static debugMatch(pattern, text, flags = 'g') {
    console.log(`–ü–∞—Ç—Ç–µ—Ä–Ω: /${pattern}/${flags}`);
    console.log(`–¢–µ–∫—Å—Ç: "${text}"`);
    
    const regex = new RegExp(pattern, flags);
    const matches = [...text.matchAll(regex)];
    
    console.log(`–ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: ${matches.length}`);
    
    matches.forEach((match, index) => {
      console.log(`–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ ${index + 1}: "${match[0]}" (–ø–æ–∑–∏—Ü–∏—è ${match.index})`);
      if (match.groups) {
        console.log(`  –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã:`, match.groups);
      }
      if (match.length > 1) {
        console.log(`  –ó–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã:`, match.slice(1));
      }
    });
    
    return matches;
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
  static performanceTest(pattern, text, iterations = 10000, flags = '') {
    const regex = new RegExp(pattern, flags);
    
    const startTime = performance.now();
    for (let i = 0; i < iterations; i++) {
      regex.test(text);
    }
    const endTime = performance.now();
    
    const timePerOperation = (endTime - startTime) / iterations;
    
    console.log(`–ü–∞—Ç—Ç–µ—Ä–Ω: /${pattern}/${flags}`);
    console.log(`–í—Ä–µ–º—è –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é: ${timePerOperation.toFixed(6)}ms`);
    console.log(`–í—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏: ${endTime - startTime}ms`);
    
    return {
      totalTime: endTime - startTime,
      timePerOperation: timePerOperation
    };
  }
  
  // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
  static comparePatterns(patterns, text, iterations = 10000) {
    const results = {};
    
    for (const [name, pattern] of Object.entries(patterns)) {
      results[name] = this.performanceTest(pattern, text, iterations);
    }
    
    return results;
  }
  
  // –ü–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤
  static findProblematicMatches(pattern, text, flags = 'g') {
    const regex = new RegExp(pattern, flags);
    let match;
    const results = [];
    
    while ((match = regex.exec(text)) !== null) {
      results.push({
        match: match[0],
        index: match.index,
        groups: match.slice(1),
        input: text.substring(Math.max(0, match.index - 10), match.index + match[0].length + 10)
      });
      
      // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
      if (match.index === regex.lastIndex) {
        regex.lastIndex++;
      }
    }
    
    return results;
  }
}

// –ü—Ä–∏–º–µ—Ä –æ—Ç–ª–∞–¥–∫–∏
const debugText = '–î–∞—Ç–∞: 2023-12-25, –í—Ä–µ–º—è: 14:30:00, –°–æ–±—ã—Ç–∏–µ: –í—Å—Ç—Ä–µ—á–∞';
const debugPattern = /(\d{4}-\d{2}-\d{2})\s+–í—Ä–µ–º—è:\s+(\d{2}:\d{2}:\d{2})/;

console.log('=== –û—Ç–ª–∞–¥–∫–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è ===');
RegexDebugger.debugMatch(debugPattern, debugText);

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
const patternsForComparison = {
  '–° –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–º–∏ –≥—Ä—É–ø–ø–∞–º–∏': /(\d{4})-(\d{2})-(\d{2})/,
  '–° –Ω–µ–∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–º–∏ –≥—Ä—É–ø–ø–∞–º–∏': /(?:\d{4})-(?:\d{2})-(?:\d{2})/,
  '–ë–µ–∑ –≥—Ä—É–ø–ø': /\d{4}-\d{2}-\d{2}/
};

console.log('\n=== –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ===');
RegexDebugger.comparePatterns(patternsForComparison, debugText.repeat(100));
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```javascript
class SafeRegexValidator {
  constructor() {
    this.cache = new Map();
    this.safePatterns = {
      email: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
      phone: /^\+?[\d\s\-\(\)]{7,15}$/,
      url: /^https?:\/\/[\w\.-]+\.[a-zA-Z]{2,}(?:\/[\w\.-]*)*\/?$/,
      numeric: /^\d+$/,
      alphanumeric: /^[a-zA-Z0-9]+$/,
      dateIso: /^\d{4}-\d{2}-\d{2}$/
    };
  }
  
  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
  validate(type, value) {
    const pattern = this.safePatterns[type];
    if (!pattern) {
      throw new Error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${type}`);
    }
    
    return pattern.test(value);
  }
  
  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
  validateCustom(pattern, value, flags = '') {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
    if (this.isPotentiallyDangerous(pattern)) {
      throw new Error('–ü–∞—Ç—Ç–µ—Ä–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —É—è–∑–≤–∏–º –∫ ReDoS');
    }
    
    const regex = this.getRegex(pattern, flags);
    return regex.test(value);
  }
  
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
  getRegex(pattern, flags = '') {
    const key = `${pattern}_${flags}`;
    if (!this.cache.has(key)) {
      this.cache.set(key, new RegExp(pattern, flags));
    }
    return this.cache.get(key);
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
  isPotentiallyDangerous(pattern) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    const dangerousRegexes = [
      /\(.*\)\+\+/,           // –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
      /\[.*\]\+\+/,           // –ö–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ –∫–ª–∞—Å—Å–∞—Ö —Å–∏–º–≤–æ–ª–æ–≤
      /.*\{(\d+),(\d+)\}.*/,  // –ë–æ–ª—å—à–∏–µ —á–∏—Å–ª–æ–≤—ã–µ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
      /\(.*\)\{.*\}/,         // –ö–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ –≥—Ä—É–ø–ø–∞—Ö
      /.*\+\?\*/,             // –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
      /.*\[\^\\w\\W\\s\\S\]/ // –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã —Å–∏–º–≤–æ–ª–æ–≤
    ];
    
    return dangerousRegexes.some(danger => danger.test(pattern));
  }
  
  // –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
  clearCache() {
    this.cache.clear();
  }
  
  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  getStats() {
    return {
      cachedPatterns: this.cache.size,
      knownSafePatterns: Object.keys(this.safePatterns).length
    };
  }
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
const validator = new SafeRegexValidator();

console.log('Email –≤–∞–ª–∏–¥–∞—Ü–∏—è:', validator.validate('email', 'user@example.com'));
console.log('–¢–µ–ª–µ—Ñ–æ–Ω –≤–∞–ª–∏–¥–∞—Ü–∏—è:', validator.validate('phone', '+7 (926) 123-45-67'));
console.log('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:', validator.getStats());

// –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω
try {
  validator.validateCustom('(a+)+b', 'test');
} catch (e) {
  console.log('–û—à–∏–±–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:', e.message);
}
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏:

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ–≥–¥–∞ —ç–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥
2. **–£—è–∑–≤–∏–º–æ—Å—Ç—å ReDoS** - –∏–∑–±–µ–≥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã—Ö –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –∫—ç—à–∏—Ä—É–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –∏ –∏–∑–±–µ–≥–∞–π—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤ —Ü–∏–∫–ª–∞—Ö
4. **–ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ \b, ^, $ –∏ —Ñ–ª–∞–≥ m
5. **Unicode** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–ª–∞–≥ u –∏ –∫–ª–∞—Å—Å—ã —Å–∏–º–≤–æ–ª–æ–≤ \p{} –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ-ASCII —Ç–µ–∫—Å—Ç–æ–º
6. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ –¥–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

–°–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ç–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

- [[–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π]]
- [[–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ]]
- [[–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã]]