---
aliases: ["Деплойment", "Развертывание", "Production", "Nuxt Production"]
tags: [vue, nuxt, deployment, hosting, javascript]
---

# Деплой Nuxt.js приложений

**Деплой** - это процесс развертывания вашего Nuxt.js приложения на сервере или платформе хостинга, чтобы оно стало доступно пользователям. В зависимости от типа приложения (SSR, SSG или SPA), процесс деплоя может отличаться.

## Типы приложений и их деплой

### 1. Universal (SSR) приложения

Это приложения с серверным рендерингом. Они требуют Node.js сервера для запуска.

#### Сборка SSR приложения

```bash
npm run build
```

Эта команда создает директорию `dist/` с готовыми файлами для развертывания.

#### Запуск в production

```bash
npm start
```

#### Пример конфигурации для SSR

```javascript
// nuxt.config.js
export default {
  mode: 'universal', // или 'server' в Nuxt 3
  server: {
    port: 3000, // по умолчанию
    host: '0.0.0.0', // по умолчанию
    timing: false
  },
  // Дополнительные настройки
  build: {
    publicPath: '/_nuxt/' // Путь к статическим файлам
  }
}
```

### 2. Static (SSG) приложения

Это статические сайты, которые можно разместить на любом статическом хостинге.

#### Генерация статического сайта

```bash
npm run generate
```

Эта команда создает директорию `dist/` со статическими файлами.

#### Пример конфигурации для SSG

```javascript
// nuxt.config.js
export default {
  target: 'static', // или 'static' в Nuxt 3
  generate: {
    fallback: true, // файл для SPA Fallback
    routes: [
      // Дополнительные маршруты для генерации
    ]
  }
}
```

### 3. SPA приложения

Одностраничные приложения, которые рендерятся только на клиенте.

#### Конфигурация SPA

```javascript
// nuxt.config.js
export default {
  target: 'static', // или 'spa' в Nuxt 3
  ssr: false,
  generate: {
    fallback: 'index.html' // SPA fallback
  }
}
```

## Платформы для деплоя

### 1. Vercel

Одна из самых популярных платформ для Nuxt.js приложений:

```json
// vercel.json
{
  "version": 2,
  "builds": [
    {
      "src": "nuxt.config.js",
      "use": "@nuxtjs/vercel-builder",
      "config": {}
    }
  ]
}
```

### 2. Netlify

Отлично подходит для статических сайтов:

```toml
# netlify.toml
[build]
  command = "npm run generate"
  publish = "dist"
  environment = { NODE_VERSION = "18" }
```

### 3. Heroku

Для SSR приложений:

```yaml
# app.json
{
  "name": "Nuxt.js on Heroku",
  "description": "A Nuxt.js app deployed on Heroku",
  "repository": "https://github.com/nuxt/nuxt.js",
  "env": {
    "NPM_CONFIG_PRODUCTION": {
      "description": "Set to false to install devDependencies",
      "value": "false"
    }
  }
}
```

### 4. DigitalOcean App Platform

Для SSR и SSG приложений.

### 5. AWS (EC2, S3, Lambda)

Для более сложных конфигураций.

## Docker для деплоя

Создание Dockerfile для SSR приложения:

```dockerfile
# Multi-stage build
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM node:18-alpine AS runtime
WORKDIR /app
RUN apk add --no-cache dumb-init
COPY --from=builder /app/package*.json ./
RUN npm ci --production
COPY --from=builder --chown=node:node /app/.nuxt ./.nuxt
COPY --from=builder --chown=node:node /app/dist ./dist
COPY --from=builder --chown=node:node /app/static ./static
COPY --from=builder --chown=node:node /app/nuxt.config.js ./
USER node
EXPOSE 3000
ENTRYPOINT ["dumb-init", "--"]
CMD ["npm", "start"]
```

## CI/CD для Nuxt.js

### GitHub Actions

```yaml
# .github/workflows/deploy.yml
name: Deploy Nuxt App

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: Install dependencies
      run: npm ci
      
    - name: Build for static generation
      run: npm run generate
      
    - name: Deploy to Netlify
      uses: netlify/actions/cli@master
      env:
        NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
        NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}
      with:
        args: deploy --dir=dist --prod
```

### GitLab CI

```yaml
# .gitlab-ci.yml
stages:
  - build
  - deploy

build:
  stage: build
  image: node:18
  script:
    - npm ci
    - npm run generate
  artifacts:
    paths:
      - dist/
  only:
    - main

deploy:
  stage: deploy
  image: node:18
  before_script:
    - npm install -g netlify-cli
  script:
    - netlify deploy --dir=dist --prod
  only:
    - main
  environment:
    name: production
    url: https://your-site.netlify.app
```

## Настройка сервера для SSR

### Nginx как reverse proxy

```nginx
# /etc/nginx/sites-available/nuxt-app
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### PM2 для процесс-менеджмента

```bash
# Установка PM2
npm install -g pm2

# Запуск приложения
pm2 start npm --name "nuxt-app" -- run start

# Автозапуск при загрузке системы
pm2 startup
pm2 save
```

## Работа с переменными окружения

### В nuxt.config.js

```javascript
export default {
  env: {
    API_URL: process.env.API_URL || 'http://localhost:3001'
  },
  // или
  publicRuntimeConfig: {
    apiUrl: process.env.API_URL
  },
  privateRuntimeConfig: {
    apiSecret: process.env.API_SECRET
  }
}
```

### В компонентах

```vue
<template>
  <div>{{ data }}</div>
</template>

<script>
export default {
  async asyncData({ $config }) {
    const data = await $axios.$get(`${$config.apiUrl}/data`)
    return { data }
  }
}
</script>
```

## Мониторинг и логирование

### Логирование в production

```javascript
// plugins/logging.js
export default ({ app, route, store }) => {
  if (process.client) {
    // Логирование на клиенте
    app.router.afterEach((to, from) => {
      console.log(`Навигация с ${from.path} на ${to.path}`)
    })
  }
  
  if (process.server) {
    // Логирование на сервере
    console.log(`Запрос к ${route.path}`)
  }
}
```

### Интеграция с Sentry

```javascript
// nuxt.config.js
export default {
  modules: ['@nuxtjs/sentry'],
  sentry: {
    dsn: process.env.SENTRY_DSN,
    config: {
      environment: process.env.NODE_ENV
    }
  }
}
```

## Российские особенности деплоя (2025)

### 1. Хостинг в России

В 2025 году российские разработчики все чаще используют отечественные хостинги:
- Selectel
- Мегафон Облако
- RUVDS
- Webzilla
- Timeweb

### 2. CDN решения

Из-за ограничений на западные CDN, российские разработчики используют:
- CDN от Ростелекома
- Selectel CDN
- CloudMail.ru CDN
- Яндекс CDN

### 3. Базы данных

При развертывании SSR приложений в России часто используются:
- PostgreSQL с отечественными дистрибутивами
- ClickHouse для аналитики
- MongoDB (если не подпадает под ограничения)

### 4. SSL сертификаты

Важно использовать сертификаты от российских CA:
- "КриптоПро"
- "УЦ СКБ Контур"
- "Конфидент"

### 5. Системы мониторинга

Российские альтернативы системам мониторинга:
- Zabbix (российская система)
- Внутренние решения на базе ELK Stack
- Системы на базе ClickHouse

## Оптимизация производительности

### 1. Кэширование

```javascript
// nuxt.config.js
export default {
  render: {
    etag: true,
    static: {
      maxAge: '1y', // Кэширование статических файлов
      setHeaders(res, path) {
        if (path.includes('sw.js')) {
          res.setHeader('Cache-Control', 'public, max-age=0')
        }
      }
    }
  }
}
```

### 2. Оптимизация сборки

```javascript
// nuxt.config.js
export default {
  build: {
    optimization: {
      splitChunks: {
        chunks: 'all',
        cacheGroups: {
          vendor: {
            name: 'vendor',
            test: /[\\/]node_modules[\\/]/,
            priority: 10,
            chunks: 'all'
          }
        }
      }
    }
  }
}
```

## Состояние на 2025 год в России

В 2025 году деплой Nuxt.js приложений в России адаптирован под санкционные ограничения. Российские компании активно используют отечественные хостинги и CDN, а также разрабатывают собственные решения для мониторинга и аналитики.

Важно учитывать требования законодательства, такие как хранение персональных данных на территории РФ, что влияет на выбор хостинга и архитектуру приложений.

> [!warning] Важно
> При деплое в России убедитесь, что ваше приложение соответствует требованиям ФЗ-152 "О персональных данных" и другим нормативным актам.

## Связанные темы

- [[Что-такое-Nuxt]] - основы фреймворка
- [[Роутинг]] - маршрутизация в Nuxt.js
- [[Хуки]] - жизненный цикл и хуки
- [[Модули]] - расширение функциональности
- [[Vue.js]] - основы Vue.js
- [[SSR]] - серверный рендеринг
- [[CI/CD]] - непрерывная интеграция и доставка
- [[Docker]] - контейнеризация приложений