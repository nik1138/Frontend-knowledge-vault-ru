---
aliases: [Локальные переходы, Local Transitions, Компоненты Transition]
tags: [vue, transition, animation, components, frontend]
---

# Локальные переходы

## Обзор

Локальные переходы в Vue - это подход, при котором анимационные компоненты определяются непосредственно внутри компонента, где они используются, а не глобально или в родительском компоненте. Это позволяет создавать изолированные анимационные эффекты, что особенно полезно при разработке компонентов для российских проектов в 2025 году, где важна модульность и переиспользуемость кода.

## Основы локальных переходов

В отличие от глобальных переходов, локальные переходы определяются в области видимости конкретного компонента. Это позволяет:

- Изолировать анимационные эффекты от других частей приложения
- Создавать уникальные анимации для конкретных компонентов
- Упрощать отладку и поддержку анимационного кода
- Повышать производительность за счет уменьшения глобальных зависимостей

### Пример локального перехода

```vue
<template>
  <div class="local-transition-example">
    <button @click="toggleContent">Переключить контент</button>
    
    <!-- Локальный переход определен в компоненте -->
    <transition
      name="local-fade"
      @before-enter="beforeEnter"
      @enter="enter"
      @before-leave="beforeLeave"
      @leave="leave"
    >
      <div v-if="showContent" class="content">
        Контент с локальной анимацией
      </div>
    </transition>
  </div>
</template>

<script>
export default {
  name: 'LocalTransitionExample',
  data() {
    return {
      showContent: true
    }
  },
  methods: {
    toggleContent() {
      this.showContent = !this.showContent
    },
    beforeEnter(el) {
      el.style.opacity = 0
      el.style.transform = 'translateY(-20px)'
    },
    enter(el, done) {
      // Используем CSS-анимацию или JavaScript
      const animation = el.animate([
        { opacity: 0, transform: 'translateY(-20px)' },
        { opacity: 1, transform: 'translateY(0)' }
      ], {
        duration: 300,
        easing: 'ease-out'
      })
      
      animation.onfinish = done
    },
    beforeLeave(el) {
      // Подготовка к анимации исчезновения
    },
    leave(el, done) {
      const animation = el.animate([
        { opacity: 1, transform: 'translateY(0)' },
        { opacity: 0, transform: 'translateY(-20px)' }
      ], {
        duration: 300,
        easing: 'ease-out'
      })
      
      animation.onfinish = done
    }
  }
}
</script>

<style>
.local-fade-enter-active, .local-fade-leave-active {
  transition: opacity 0.3s ease, transform 0.3s ease;
}
.local-fade-enter-from {
  opacity: 0;
  transform: translateY(-20px);
}
.local-fade-leave-to {
  opacity: 0;
  transform: translateY(-20px);
}
</style>
```

## Практическое применение

### 1. Компонент карточки с локальной анимацией

```vue
<!-- CardWithTransition.vue -->
<template>
  <div class="card-container">
    <transition
      :name="animationType"
      :duration="animationDuration"
      @before-enter="setupAnimation"
      @enter="performEnterAnimation"
      @leave="performLeaveAnimation"
    >
      <div v-if="isVisible" class="card" :class="{ 'expanded': isExpanded }">
        <h3>{{ title }}</h3>
        <p>{{ content }}</p>
        <button @click="toggleExpand">{{ isExpanded ? 'Свернуть' : 'Развернуть' }}</button>
      </div>
    </transition>
    
    <button v-if="!isVisible" @click="showCard" class="reveal-btn">
      Показать карточку
    </button>
  </div>
</template>

<script>
export default {
  name: 'CardWithTransition',
  props: {
    title: {
      type: String,
      required: true
    },
    content: {
      type: String,
      required: true
    },
    animationType: {
      type: String,
      default: 'card-fade'
    },
    animationDuration: {
      type: Number,
      default: 300
    }
  },
  data() {
    return {
      isVisible: false,
      isExpanded: false
    }
  },
  methods: {
    showCard() {
      this.isVisible = true
    },
    toggleExpand() {
      this.isExpanded = !this.isExpanded
    },
    setupAnimation(el) {
      // Подготовка элемента перед анимацией
      el.style.height = 'auto'
      const height = el.scrollHeight
      el.style.height = '0px'
      el.getBoundingClientRect() // Триггер перерисовки
    },
    performEnterAnimation(el, done) {
      // Анимация появления карточки
      const height = el.scrollHeight
      const animation = el.animate([
        { height: '0px', opacity: 0 },
        { height: `${height}px`, opacity: 1 }
      ], {
        duration: this.animationDuration,
        easing: 'ease-out'
      })
      
      animation.onfinish = () => {
        el.style.height = 'auto'
        done()
      }
    },
    performLeaveAnimation(el, done) {
      // Анимация исчезновения карточки
      const height = el.scrollHeight
      const animation = el.animate([
        { height: `${height}px`, opacity: 1 },
        { height: '0px', opacity: 0 }
      ], {
        duration: this.animationDuration,
        easing: 'ease-in'
      })
      
      animation.onfinish = done
    }
  }
}
</script>

<style>
.card-container {
  margin: 20px 0;
}

.card {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 16px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  background: white;
  overflow: hidden;
}

.card.expanded {
  background: #f5f5f5;
}

.reveal-btn {
  padding: 10px 16px;
  background: #007bff;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.card-fade-enter-active, .card-fade-leave-active {
  transition: all 0.3s ease;
}
.card-fade-enter-from {
  opacity: 0;
  transform: translateY(-10px);
}
.card-fade-leave-to {
  opacity: 0;
  transform: translateY(10px);
}
</style>
```

### 2. Локальный переход с использованием scoped стилей

```vue
<!-- TooltipWithTransition.vue -->
<template>
  <div class="tooltip-wrapper">
    <button 
      @mouseenter="showTooltip" 
      @mouseleave="hideTooltip"
      class="trigger-btn"
    >
      Наведи на меня
    </button>
    
    <transition
      name="tooltip"
      @before-enter="beforeTooltipEnter"
      @enter="enterTooltip"
      @leave="leaveTooltip"
    >
      <div v-if="tooltipVisible" class="tooltip" ref="tooltip">
        Это всплывающая подсказка с локальной анимацией
      </div>
    </transition>
  </div>
</template>

<script>
export default {
  name: 'TooltipWithTransition',
  data() {
    return {
      tooltipVisible: false,
      timeoutId: null
    }
  },
  methods: {
    showTooltip() {
      if (this.timeoutId) {
        clearTimeout(this.timeoutId)
      }
      this.tooltipVisible = true
    },
    hideTooltip() {
      this.timeoutId = setTimeout(() => {
        this.tooltipVisible = false
      }, 300)
    },
    beforeTooltipEnter(el) {
      // Подготовка перед анимацией
      el.style.opacity = '0'
      el.style.transform = 'translateY(-10px) scale(0.9)'
    },
    enterTooltip(el, done) {
      // Анимация появления тултипа
      const animation = el.animate([
        { opacity: 0, transform: 'translateY(-10px) scale(0.9)' },
        { opacity: 1, transform: 'translateY(0) scale(1)' }
      ], {
        duration: 200,
        easing: 'ease-out'
      })
      
      animation.onfinish = done
    },
    leaveTooltip(el, done) {
      // Анимация исчезновения тултипа
      const animation = el.animate([
        { opacity: 1, transform: 'translateY(0) scale(1)' },
        { opacity: 0, transform: 'translateY(-10px) scale(0.9)' }
      ], {
        duration: 150,
        easing: 'ease-in'
      })
      
      animation.onfinish = done
    }
  },
  beforeUnmount() {
    if (this.timeoutId) {
      clearTimeout(this.timeoutId)
    }
  }
}
</script>

<style scoped>
.tooltip-wrapper {
  position: relative;
  display: inline-block;
}

.trigger-btn {
  padding: 8px 16px;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.tooltip {
  position: absolute;
  top: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: white;
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 14px;
  white-space: nowrap;
  z-index: 1000;
}

/* Стрелка тултипа */
.tooltip::after {
  content: '';
  position: absolute;
  top: -6px;
  left: 50%;
  transform: translateX(-50%);
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-bottom: 6px solid #333;
}

.tooltip-enter-active, .tooltip-leave-active {
  transition: opacity 0.2s ease, transform 0.2s ease;
}
.tooltip-enter-from {
  opacity: 0;
  transform: translate(-50%, -10px) scale(0.9);
}
.tooltip-leave-to {
  opacity: 0;
  transform: translate(-50%, -10px) scale(0.9);
}
</style>
```

## Практические рекомендации

### 1. Организация кода

При создании локальных переходов в российских условиях:

- Используйте модульный подход для сложных анимаций
- Выносите сложные анимационные функции в отдельные методы
- Документируйте логику анимаций в комментариях

### 2. Производительность

- Оптимизируйте анимации для слабых устройств
- Используйте `transform` и `opacity` вместо изменений геометрии
- Учитывайте предпочтения пользователей относительно анимаций

### 3. Совместимость с доступностью

- Обеспечьте возможность отключения анимаций через настройки
- Используйте ARIA-атрибуты для описания анимационных состояний
- Учитывайте медиа-запрос `prefers-reduced-motion`

## Продвинутые возможности

### Локальные переходы с динамической настройкой

```vue
<!-- DynamicTransition.vue -->
<template>
  <div class="dynamic-transition-container">
    <div class="controls">
      <label>
        Тип анимации:
        <select v-model="currentAnimation">
          <option value="fade">Fade</option>
          <option value="slide">Slide</option>
          <option value="zoom">Zoom</option>
          <option value="bounce">Bounce</option>
        </select>
      </label>
      
      <label>
        Направление:
        <select v-model="animationDirection">
          <option value="in">Появление</option>
          <option value="out">Исчезновение</option>
          <option value="both">Оба</option>
        </select>
      </label>
    </div>
    
    <!-- Динамический переход -->
    <component 
      :is="'transition'"
      :name="`dynamic-${currentAnimation}`"
      :appear="true"
    >
      <div v-if="showElement" class="dynamic-element">
        Элемент с динамической анимацией
      </div>
    </component>
    
    <button @click="toggleElement">Переключить элемент</button>
  </div>
</template>

<script>
export default {
  name: 'DynamicTransition',
  data() {
    return {
      showElement: true,
      currentAnimation: 'fade',
      animationDirection: 'both'
    }
  },
  methods: {
    toggleElement() {
      this.showElement = !this.showElement
    }
  }
}
</script>

<style>
.dynamic-transition-container {
  padding: 20px;
}

.controls {
  margin-bottom: 20px;
  display: flex;
  gap: 20px;
  align-items: center;
}

.controls label {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.dynamic-element {
  padding: 20px;
  background: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 8px;
  text-align: center;
}

/* Анимации для разных типов */
.dynamic-fade-enter-active, .dynamic-fade-leave-active {
  transition: opacity 0.3s ease;
}
.dynamic-fade-enter-from, .dynamic-fade-leave-to {
  opacity: 0;
}

.dynamic-slide-enter-active, .dynamic-slide-leave-active {
  transition: all 0.3s ease;
}
.dynamic-slide-enter-from {
  opacity: 0;
  transform: translateX(30px);
}
.dynamic-slide-leave-to {
  opacity: 0;
  transform: translateX(-30px);
}

.dynamic-zoom-enter-active, .dynamic-zoom-leave-active {
  transition: all 0.3s ease;
}
.dynamic-zoom-enter-from {
  opacity: 0;
  transform: scale(0.8);
}
.dynamic-zoom-leave-to {
  opacity: 0;
  transform: scale(0.8);
}

.dynamic-bounce-enter-active {
  animation: bounce-in 0.5s;
}
.dynamic-bounce-leave-active {
  animation: bounce-out 0.5s;
}

@keyframes bounce-in {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes bounce-out {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.05); }
  100% { transform: scale(0.3); opacity: 0; }
}
</style>
```

## Связанные темы

- [[Transition]]
- [[Transition-group]]
- [[Параметризованные-переходы]]
- [[Кастомные-переходы]]

## Заключение

Локальные переходы предоставляют мощный инструмент для создания изолированных анимационных эффектов в Vue-компонентах. Они позволяют создавать модульные и легко поддерживаемые анимации, что особенно важно для российских проектов, где важна гибкость и масштабируемость кода. При разработке в 2025 году важно учитывать производительность, доступность и возможность настройки анимаций под различные требования.