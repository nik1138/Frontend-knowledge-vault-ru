---
aliases: [Web Vitals, Веб Виталы, Core Web Vitals, Google Vitals]
tags: [vue, performance, web-vitals, metrics, google]
---

# Веб-визиталс

## Обзор

Веб-визиталс (Web Vitals) - это инициатива Google, направленная на стандартизацию метрик производительности веб-сайтов. В 2025 году эти метрики играют ключевую роль не только в оценке производительности Vue приложений, но и в SEO-ранжировании. Основные метрики веб-визиталс помогают измерять пользовательский опыт с точки зрения загрузки, интерактивности и визуальной стабильности.

## Основные метрики веб-визиталс

### 1. Largest Contentful Paint (LCP)

LCP измеряет время от начала загрузки страницы до момента, когда самый большой элемент контента становится видимым для пользователя. В идеале LCP должен происходить в течение первых 2.5 секунд после начала загрузки страницы.

**Целевые значения:**
- Хорошо: ≤ 2.5 секунды
- Удовлетворительно: 2.6 - 4.0 секунды
- Плохо: > 4.0 секунды

**Оптимизация для Vue приложений:**
- Использование ленивой загрузки компонентов
- Оптимизация изображений и видео
- Приоритизация критических ресурсов

```javascript
// Пример измерения LCP
import { getLCP } from 'web-vitals'

getLCP(console.log)
```

### 2. First Input Delay (FID) / Interaction to Next Paint (INP)

FID измеряет время от момента, когда пользователь впервые взаимодействует со страницей, до момента, когда браузер фактически начинает обрабатывать этот ввод. В 2025 году FID постепенно заменяется на INP (Interaction to Next Paint), который обеспечивает более полное представление об интерактивности.

**Целевые значения (FID):**
- Хорошо: ≤ 100 миллисекунд
- Удовлетворительно: 101 - 300 миллисекунд
- Плохо: > 300 миллисекунд

**Целевые значения (INP):**
- Хорошо: ≤ 200 миллисекунд
- Удовлетворительно: 201 - 500 миллисекунд
- Плохо: > 500 миллисекунд

### 3. Cumulative Layout Shift (CLS)

CLS измеряет неожиданное смещение контента на странице. Низкий CLS важен для обеспечения стабильного пользовательского опыта, особенно на мобильных устройствах.

**Целевые значения:**
- Хорошо: ≤ 0.1
- Удовлетворительно: 0.11 - 0.25
- Плохо: > 0.25

## Измерение веб-визиталс в Vue приложениях

### Использование библиотеки web-vitals

```javascript
// main.js
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals'

function sendToAnalytics(metric) {
  // Отправка метрики в аналитическую систему
  console.log(metric)
}

// Регистрация метрик
getCLS(sendToAnalytics)
getFID(sendToAnalytics)
getFCP(sendToAnalytics)
getLCP(sendToAnalytics)
getTTFB(sendToAnalytics)
```

### Использование Vue DevTools Performance

Vue DevTools включает инструменты для измерения производительности:

1. Установка Vue DevTools
2. Открытие вкладки Performance
3. Запись сессии взаимодействия
4. Анализ метрик

### Создание собственной системы измерения

```javascript
// utils/performance.js
export class VuePerformanceMonitor {
  constructor() {
    this.metrics = {}
  }

  measureLCP() {
    if ('LargestContentfulPaint' in window) {
      new PerformanceObserver((entryList) => {
        const entries = entryList.getEntries()
        const lastEntry = entries[entries.length - 1]
        this.metrics.lcp = lastEntry.renderTime || lastEntry.loadTime
      }).observe({ entryTypes: ['largest-contentful-paint'] })
    }
  }

  measureCLS() {
    if ('LayoutShift' in window) {
      let clsValue = 0
      new PerformanceObserver((entryList) => {
        for (const entry of entryList.getEntries()) {
          if (!entry.hadRecentInput) {
            clsValue += entry.value
          }
        }
        this.metrics.cls = clsValue
      }).observe({ entryTypes: ['layout-shift'] })
    }
  }

  measureFID() {
    if ('EventTiming' in window) {
      new PerformanceObserver((entryList) => {
        const firstInput = entryList.getEntries()[0]
        if (firstInput) {
          const fid = firstInput.processingStart - firstInput.startTime
          this.metrics.fid = fid
        }
      }).observe({ entryTypes: ['first-input'] })
    }
  }

  startMonitoring() {
    this.measureLCP()
    this.measureCLS()
    this.measureFID()
  }

  getMetrics() {
    return this.metrics
  }
}

// Использование в приложении
const monitor = new VuePerformanceMonitor()
monitor.startMonitoring()

// Отправка метрик
setInterval(() => {
  const metrics = monitor.getMetrics()
  // Отправка метрик на сервер
}, 30000)
```

## Оптимизация Vue приложений под веб-визиталс

### Улучшение LCP

1. **Оптимизация критического пути рендеринга**
   - Использование асинхронных компонентов для отложенной загрузки
   - Приоритизация критических CSS и JavaScript

```javascript
// Асинхронная загрузка компонента
const AsyncComponent = defineAsyncComponent(() => 
  import('./ExpensiveComponent.vue')
)

export default {
  components: {
    AsyncComponent
  }
}
```

2. **Оптимизация изображений**
   - Использование современных форматов (WebP, AVIF)
   - Предоставление изображений с правильными размерами
   - Использование атрибута `loading="lazy"` для отложенной загрузки

3. **Оптимизация шрифтов**
   - Использование font-display: swap
   - Подключение шрифтов с приоритетом

### Улучшение FID/INP

1. **Сокращение времени выполнения JavaScript**
   - Делегирование тяжелых вычислений в Web Workers
   - Оптимизация жизненных циклов компонентов

```javascript
// Выполнение тяжелых вычислений в Web Worker
const worker = new Worker('/worker.js')

worker.postMessage({ data: largeDataset })

worker.onmessage = (e) => {
  // Обработка результата
  this.processedData = e.data
}
```

2. **Использование requestIdleCallback**
   - Выполнение некритичных задач в периоды простоя

```javascript
// Выполнение некритичных задач в периоды простоя
function performIdleWork(deadline) {
  while (deadline.timeRemaining() > 0 && workQueue.length > 0) {
    performWork(workQueue.shift())
  }
  if (workQueue.length > 0) {
    requestIdleCallback(performIdleWork)
  }
}

requestIdleCallback(performIdleWork)
```

### Улучшение CLS

1. **Резервирование места для элементов**
   - Указание размеров для изображений и видео
   - Использование плейсхолдеров для асинхронного контента

```vue
<template>
  <!-- Резервирование места для изображения -->
  <img 
    src="image.jpg" 
    width="400" 
    height="300" 
    alt="Описание изображения"
  />
  
  <!-- Плейсхолдер для асинхронного контента -->
  <div v-if="loading" class="placeholder">
    Загрузка...
  </div>
  <div v-else>
    {{ asyncContent }}
  </div>
</template>

<style>
.placeholder {
  height: 200px;
  background: #f0f0f0;
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>
```

2. **Избегание динамических вставок**
   - Предотвращение неожиданных вставок контента

## Мониторинг веб-визиталс в продакшн

### Использование Google Analytics 4

```javascript
// Отправка веб-визиталс в GA4
function sendToGoogleAnalytics({ name, value, id }) {
  gtag('event', name, {
    value: Math.round(name === 'CLS' ? value * 1000 : value),
    metric_id: id,
    metric_value: value
  })
}

// Регистрация метрик
getCLS(sendToGoogleAnalytics)
getFID(sendToGoogleAnalytics)
getFCP(sendToGoogleAnalytics)
getLCP(sendToGoogleAnalytics)
getTTFB(sendToGoogleAnalytics)
```

### Создание собственной панели мониторинга

```javascript
// services/performanceService.js
class PerformanceService {
  constructor() {
    this.metrics = []
  }

  recordMetric(metric) {
    this.metrics.push({
      ...metric,
      timestamp: Date.now(),
      userAgent: navigator.userAgent,
      url: window.location.href
    })
    
    // Отправка метрики на сервер
    this.sendToServer(metric)
  }

  async sendToServer(metric) {
    try {
      await fetch('/api/performance-metrics', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          metric,
          userAgent: navigator.userAgent,
          url: window.location.href,
          timestamp: Date.now()
        })
      })
    } catch (error) {
      console.error('Failed to send performance metric:', error)
    }
  }

  getMetricsReport() {
    // Группировка метрик по категориям
    const report = {
      lcp: this.metrics.filter(m => m.name === 'LCP'),
      cls: this.metrics.filter(m => m.name === 'CLS'),
      fid: this.metrics.filter(m => m.name === 'FID'),
      inp: this.metrics.filter(m => m.name === 'INP')
    }
    
    return report
  }
}

export default new PerformanceService()
```

## Российские особенности

В 2025 году при работе с веб-визиталс в российских условиях важно учитывать:

- Разнообразие провайдеров интернета и скоростей соединения
- Использование различных браузеров (включая Яндекс.Браузер, Opera)
- Мобильные устройства разного уровня (от флагманов до бюджетных моделей)
- Географические особенности (удаленные регионы с ограниченным доступом)
- Локализованные требования к пользовательскому опыту

## Интеграция с Vue CLI и Vite

### Для Vue CLI

```javascript
// vue.config.js
module.exports = {
  configureWebpack: {
    performance: {
      maxAssetSize: 250000,
      maxEntrypointSize: 250000,
      hints: 'warning'
    }
  }
}
```

### Для Vite

```javascript
// vite.config.js
export default {
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router'],
          ui: ['@vueuse/core', 'element-plus']
        }
      }
    }
  }
}
```

## Связанные темы

- [[Бенчмарки]]
- [[Тестирование-производительности-компонентов]]
- [[Оптимизация-метрик]]
- [[Мониторинг-производительности]]
- [[Vue компоненты]]
- [[Асинхронные компоненты]]

## Заключение

Веб-визиталс - это важный набор метрик, который помогает разработчикам Vue приложений сосредоточиться на ключевых аспектах пользовательского опыта. Регулярное измерение и оптимизация этих метрик позволяет создавать быстрые, интерактивные и стабильные веб-приложения, что особенно важно в условиях конкуренции и растущих ожиданий пользователей.