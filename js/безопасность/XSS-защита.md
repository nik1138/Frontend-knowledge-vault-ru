---
aliases: [XSS, Межсайтовый скриптинг, Защита от XSS]
tags: [javascript, безопасность, xss, веб-безопасность]
---

# Защита от XSS (Межсайтовый скриптинг)

## Общее описание

XSS (Cross-Site Scripting) - это тип уязвимости, при которой злоумышленник может внедрить вредоносный скрипт в веб-страницу, просматриваемую другими пользователями. В 2025 году XSS остается одной из наиболее распространенных уязвимостей веб-приложений, особенно в JavaScript-приложениях.

## Типы XSS-атак

### 1. Reflected XSS (Отраженный XSS)
Скрипт внедряется в URL и выполняется при переходе по ссылке. Это кратковременная атака, требующая социальной инженерии.

### 2. Stored XSS (Хранимый XSS)
Вредоносный скрипт сохраняется на сервере (в базе данных, комментариях, форумах) и выполняется при каждом просмотре страницы.

### 3. DOM-based XSS (Основанный на DOM XSS)
Атака происходит на стороне клиента без участия сервера. Внедрение происходит через манипуляции с DOM.

## Практические примеры уязвимостей

### Пример уязвимости в клиентском коде
```javascript
// НЕБЕЗОПАСНЫЙ КОД
function displayUserInput() {
    const userInput = document.getElementById('userInput').value;
    document.getElementById('output').innerHTML = userInput; // Уязвимость!
}
```

### Правильная реализация
```javascript
// БЕЗОПАСНЫЙ КОД
function displayUserInput() {
    const userInput = document.getElementById('userInput').value;
    // Используем textContent вместо innerHTML
    document.getElementById('output').textContent = userInput;
    
    // Или используем экранирование
    const safeOutput = escapeHtml(userInput);
    document.getElementById('output').innerHTML = safeOutput;
}

function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
}
```

## Методы защиты

### 1. Экранирование вывода
Всегда экранируйте пользовательский ввод перед вставкой в DOM:

```javascript
// Использование DOM-методов
function safeInsert(content) {
    const element = document.createElement('div');
    element.textContent = content; // Автоматически экранируется
    return element.innerHTML;
}
```

### 2. Использование шаблонизаторов
Современные фреймворки (React, Vue, Angular) обеспечивают автоматическое экранирование:

```javascript
// React автоматически экранирует значения
function UserProfile({ username }) {
    return <div>{username}</div>; // username автоматически экранируется
}
```

### 3. Content Security Policy (CSP)
Настройка CSP для предотвращения выполнения внедренных скриптов:

```html
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none';">
```

См. также: [[CSP]]

### 4. Валидация и фильтрация ввода
```javascript
// Пример валидации email
function validateEmail(email) {
    const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
    return emailRegex.test(email);
}

// Санитизация HTML-контента
function sanitizeHTML(htmlString) {
    const temp = document.createElement('div');
    temp.textContent = htmlString;
    return temp.innerHTML;
}
```

## Рекомендации по безопасности

1. **Не доверяйте пользовательскому вводу** - всегда обрабатывайте его как потенциально вредоносное содержимое
2. **Используйте безопасные методы вставки контента** - `textContent`, `setAttribute` вместо `innerHTML`, `insertAdjacentHTML`
3. **Применяйте строгую проверку типов** - особенно при работе с внешними API
4. **Регулярно обновляйте зависимости** - уязвимые библиотеки могут содержать XSS-уязвимости
5. **Используйте инструменты анализа безопасности** - ESLint с правилами безопасности, Snyk, npm audit

## XSS в российском контексте 2025

В 2025 году в России наблюдается рост числа кибератак, направленных на веб-приложения. Особое внимание уделяется защите государственных и финансовых веб-сайтов от XSS-атак. Федеральная служба по техническому и экспортному контролю (ФСТЭК) рекомендует использовать многоуровневую защиту, включающую как серверную, так и клиентскую валидацию.

Согласно статистике отечественных CERT-организаций, XSS-атаки составляют около 40% всех веб-уязвимостей, выявленных в российских информационных системах.

## Заключение

Защита от XSS требует комплексного подхода, включающего как серверные, так и клиентские меры безопасности. При разработке JavaScript-приложений в 2025 году важно учитывать современные методы атак и использовать проверенные практики безопасности.

См. также: [[Валидация-данных]], [[CSP]], [[Защита-от-инъекций]], [[CSRF-защита]]

> [!tip] 
> Всегда тестируйте приложение на уязвимости с помощью инструментов автоматического сканирования, таких как OWASP ZAP или Burp Suite.