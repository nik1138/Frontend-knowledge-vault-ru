---
aliases: ["Безопасность инъекций", "XSS-защита", "SQL-инъекции", "Защита ввода", "Инъекционные атаки"]
tags: [javascript, security, injection, xss, sql-injection, validation, sanitization]
---

# Защита от инъекций в JavaScript-приложениях

## Обзор

Инъекционные атаки являются одной из самых распространенных угроз безопасности в веб-приложениях. В 2025 году, особенно в российском цифровом пространстве, защита от инъекций требует особого внимания из-за ужесточения требований к защите персональных данных и кибербезопасности в соответствии с законодательством, включая ФЗ-152 "О персональных данных" и инициативы по цифровой безопасности.

## Основные типы инъекций

### 1. XSS (Cross-Site Scripting) - межсайтовый скриптинг

XSS-атаки происходят, когда вредоносный скрипт внедряется в веб-страницу и выполняется в браузере пользователя. Это может привести к краже cookies, сессионных данных или выполнению действий от имени пользователя.

#### Типы XSS:
- **Reflected XSS** - скрипт отражается от сервера в ответе
- **Stored XSS** - скрипт сохраняется на сервере и отображается другим пользователям
- **DOM-based XSS** - атака на уровне DOM без участия сервера

#### Защита от XSS:

```javascript
// Плохо - прямая вставка пользовательского ввода
const userInput = document.getElementById('userInput').value;
document.getElementById('output').innerHTML = userInput;

// Хорошо - безопасная вставка с использованием textContent
document.getElementById('output').textContent = userInput;

// Хорошо - экранирование HTML
function escapeHtml(unsafe) {
    return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
}
```

### 2. SQL-инъекции

SQL-инъекции происходят при внедрении вредоносного SQL-кода через пользовательский ввод, что может привести к несанкционированному доступу к базе данных.

#### Защита от SQL-инъекций:

```javascript
// Плохо - конкатенация строк
const query = `SELECT * FROM users WHERE id = ${userId}`;

// Хорошо - подготовленные выражения (prepared statements)
const stmt = db.prepare('SELECT * FROM users WHERE id = ?');
const result = stmt.get(userId);

// Использование ORM с безопасными методами
User.findByPk(userId) // Sequelize ORM
```

### 3. Command Injection

Command injection происходит при выполнении системных команд с непроверенным пользовательским вводом.

#### Защита от Command Injection:

```javascript
// Плохо - прямое выполнение команды с пользовательским вводом
const { exec } = require('child_process');
exec(`ls ${userInput}`, (error, stdout) => { /* ... */ });

// Хорошо - валидация и ограничение команд
const { spawn } = require('child_process');
const sanitizedInput = validateAndSanitize(userInput);
const child = spawn('ls', [sanitizedInput]);
```

## Практические рекомендации

### 1. Валидация и санитизация ввода

Всегда валидируйте и санитизируйте пользовательский ввод на клиенте и сервере:

```javascript
// Пример валидации email с использованием регулярных выражений
function validateEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}

// Санитизация HTML-ввода с использованием DOMPurify
import DOMPurify from 'dompurify';

const clean = DOMPurify.sanitize(dirtyInput);
```

### 2. Использование Content Security Policy (CSP)

CSP помогает предотвратить XSS-атаки, ограничивая источники выполнения скриптов:

```html
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none';">
```

### 3. Защита сессий и аутентификации

Используйте безопасные заголовки для cookies:

```javascript
app.use(session({
    cookie: {
        secure: true,        // HTTPS только
        httpOnly: true,      // Не доступен через JavaScript
        sameSite: 'strict'   // Защита от CSRF
    }
}));
```

### 4. Правила обработки ошибок

Не раскрывайте внутренние детали системы в сообщениях об ошибках:

```javascript
// Плохо - детали ошибки могут раскрыть информацию
res.status(500).json({ error: error.message });

// Хорошо - общее сообщение об ошибке
res.status(500).json({ error: 'Internal server error' });
```

## Российские аспекты безопасности

В 2025 году в России действуют усиленные требования к защите информации:

1. **ФЗ-152 "О персональных данных"** - требует защиты персональных данных от несанкционированного доступа
2. **ГОСТ Р 57580** - стандарты по защите информации в информационных телекоммуникационных сетях
3. **Требования Центробанка** - для финансовых приложений и платежных систем

Эти требования требуют особого внимания к:
- Шифрованию персональных данных
- Аудиту безопасности
- Мониторингу инъекционных атак
- Соответствию требованиям РКН

## Инструменты для обнаружения уязвимостей

### 1. SAST-инструменты (Static Application Security Testing)
- ESLint с плагинами безопасности
- SonarQube с правилами безопасности
- Semgrep с паттернами для инъекций

### 2. DAST-инструменты (Dynamic Application Security Testing)
- OWASP ZAP
- Burp Suite
- Arachni

### 3. IAST-инструменты (Interactive Application Security Testing)
- Contrast Security
- Synopsys Seeker

## Лучшие практики разработки

1. **Принцип наименьших привилегий** - предоставление минимально необходимых прав
2. **Defense in depth** - многоуровневая защита
3. **Регулярные аудиты безопасности** - как автоматические, так и ручные
4. **Обучение разработчиков** - повышение осведомленности о безопасности
5. **Использование безопасных библиотек** - с регулярными обновлениями

## Заключение

Защита от инъекций в JavaScript-приложениях требует комплексного подхода, включающего как технические меры, так и организационные. В условиях современных требований к безопасности в России, особенно важно учитывать законодательные аспекты и использовать проверенные методы защиты.

## Связанные темы

- [[XSS-атаки и защита]]
- [[SQL-инъекции]]
- [[Валидация данных]]
- [[Content Security Policy]]
- [[OWASP Top 10]]
- [[Безопасность API]]
- [[Шифрование данных]]

## Ключевые теги

#javascript #security #injection #xss #sql-injection #validation #sanitization #csp #csrf #owasp