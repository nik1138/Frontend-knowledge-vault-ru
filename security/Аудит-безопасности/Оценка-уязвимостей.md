---
aliases: ["Анализ уязвимостей", "Сканирование уязвимостей", "Аудит безопасности", "Vulnerability Assessment"]
tags: ["#security", "#vulnerability-assessment", "#penetration-testing", "#cvss", "#risk-assessment", "#security-testing"]
---

# Оценка уязвимостей

## Введение в оценку уязвимостей

Оценка уязвимостей — это систематический процесс поиска, идентификации и классификации уязвимостей в системах, сетях, приложениях и других компонентах информационной инфраструктуры. Это важный элемент стратегии кибербезопасности, направленный на выявление слабых мест до того, как они могут быть эксплуатированы злоумышленниками.

> [!tip] Совет
> Регулярная оценка уязвимостей позволяет организациям оперативно реагировать на новые угрозы и поддерживать высокий уровень защищенности своих систем.

Оценка уязвимостей включает в себя:
- Идентификацию известных уязвимостей
- Оценку критичности обнаруженных проблем
- Рекомендации по устранению
- Приоритезацию уязвимостей для устранения

Процесс оценки уязвимостей тесно связан с другими аспектами безопасности, такими как [[Тестирование безопасности]], [[Мониторинг безопасности]] и [[Реагирование на инциденты]].

## Разница между оценкой и пентестом

Хотя оценка уязвимостей и пентест (пенетрационное тестирование) часто используются как синонимы, между ними есть существенные различия:

| Характеристика | Оценка уязвимостей | Пентест |
|----------------|---------------------|---------|
| **Цель** | Идентификация всех возможных уязвимостей | Имитация атаки злоумышленника |
| **Глубина** | Автоматизированное сканирование | Ручное тестирование и эксплуатация |
| **Доказательство концепции** | Обычно нет | Да, доказательство эксплуатации |
| **Время выполнения** | Несколько часов до дней | От недели до месяца |
| **Результат** | Список уязвимостей | Отчет о безопасности с рекомендациями |
| **Частота** | Регулярно (еженедельно/ежемесячно) | Регулярно, но реже (ежеквартально/ежегодно) |

> [!info] Информация
> Пентест может включать в себя этап оценки уязвимостей, но не ограничивается только этим. Подробнее о пентестировании см. [[Пенетрационное тестирование]].

> [!tip] Рекомендация
> Оценка уязвимостей и пентест дополняют друг друга. Оценка уязвимостей позволяет выявить широкий спектр потенциальных проблем, а пентест проверяет, насколько успешно злоумышленник может эксплуатировать эти уязвимости в реальных условиях.

## Методологии оценки

Существует несколько общепринятых методологий проведения оценки уязвимостей:

### OWASP Testing Guide
[[OWASP-Testing-Guide]] — это руководство по тестированию безопасности веб-приложений, разработанное сообществом OWASP. Оно фокусируется на тестировании веб-приложений и включает в себя детальные инструкции по выявлению и эксплуатации уязвимостей веб-приложений.

### NIST SP 800-115
Техническое руководство по тестированию безопасности от Национального института стандартов и технологий США. Включает в себя:
- Планирование тестирования
- Проведение тестов
- Анализ результатов
- Подготовку отчетов

### CVSS (Common Vulnerability Scoring System)
[[CVSS-оценка]] — система оценки критичности уязвимостей, которая позволяет стандартизировать оценку уязвимостей и сравнивать их между собой.

### DREAD
Модель оценки рисков, основанная на пяти критериях:
- **D**amage - потенциальный ущерб
- **R**eproducibility - воспроизводимость
- **E**xploitability - эксплуатируемость
- **A**ffected users - количество затронутых пользователей
- **D**iscoverability - обнаруживаемость

## Типы оценки

### Сетевая оценка
Сетевая оценка направлена на выявление уязвимостей в сетевой инфраструктуре, включая маршрутизаторы, коммутаторы, межсетевые экраны и другие сетевые устройства. Обычно проводится с внешней или внутренней стороны сети.

Инструменты для сетевой оценки:
- [[Nmap]] - сканирование портов и сервисов
- [[Nessus]] - сканер уязвимостей
- [[OpenVAS]] - открытый сканер уязвимостей

### Хостовая оценка
Хостовая оценка фокусируется на конкретных системах (серверах, рабочих станциях) и проверяет:
- Конфигурации безопасности
- Установленное программное обеспечение
- Настройки операционной системы
- Права доступа и учетные записи

### Прикладная оценка
Прикладная оценка направлена на выявление уязвимостей в приложениях, особенно в веб-приложениях. Может включать:
- Статический анализ кода
- Динамический анализ кода
- Тестирование на соответствие безопасности
- Анализ бизнес-логики

Инструменты для прикладной оценки:
- [[OWASP-ZAP]] - инструмент для тестирования безопасности веб-приложений
- [[Burp Suite]] - фреймворк для тестирования безопасности веб-приложений
- [[SQLmap]] - инструмент для автоматизированного обнаружения и эксплуатации SQL-инъекций

## Инструменты для оценки

### Открытые инструменты
- **OpenVAS** - полнофункциональная система оценки уязвимостей с открытым исходным кодом
- **Nmap** - инструмент для сканирования сети и обнаружения уязвимостей
- **Nikto** - сканер веб-серверов на наличие уязвимостей
- **OWASP ZAP** - инструмент для тестирования безопасности веб-приложений
- **Dirb/Dirbuster** - инструменты для перебора директорий и файлов

### Коммерческие инструменты
- **Nessus** - один из самых популярных коммерческих сканеров уязвимостей
- **Qualys** - облачное решение для оценки уязвимостей
- **Rapid7** - платформа для управления уязвимостями
- **Tenable.io** - облачная платформа для оценки уязвимостей
- **IBM AppScan** - инструмент для тестирования безопасности веб-приложений

### Инструменты для анализа кода
- **SonarQube** - анализ качества кода с проверкой безопасности
- **Checkmarx** - платформа для анализа безопасности приложений
- **Fortify** - статический анализатор безопасности
- **Veracode** - облачная платформа для анализа безопасности

## Процесс идентификации уязвимостей

Процесс идентификации уязвимостей включает в себя следующие этапы:

### Этап 1: Планирование
- Определение целей и объема оценки
- Выбор подходящих инструментов
- Установление критериев приемлемости риска
- Согласование времени и продолжительности аудита

### Этап 2: Сканирование
- Запуск автоматизированных сканеров
- Сбор информации о системах и приложениях
- Проверка на наличие известных уязвимостей
- Идентификация открытых портов и сервисов

### Этап 3: Анализ результатов
- Фильтрация ложных срабатываний
- Классификация обнаруженных уязвимостей
- Оценка критичности и рисков
- Подтверждение подлинности обнаруженных уязвимостей

### Этап 4: Подтверждение уязвимостей
- Проверка подлинности обнаруженных уязвимостей
- Проведение дополнительных тестов при необходимости
- Подготовка доказательств эксплуатации (если применимо)

### Этап 5: Документирование
- Запись всех действий и результатов
- Сохранение доказательств эксплуатации уязвимостей
- Создание скриншотов и логов
- Подготовка материалов для отчета

## Сканирование уязвимостей

Сканирование уязвимостей — это автоматизированный процесс проверки систем на наличие известных уязвимостей. Сканеры используют базы данных с описанием уязвимостей (например, CVE) и проверяют, присутствуют ли они в тестируемой системе.

### Типы сканирования
- **Пассивное сканирование** - не отправляет активные запросы, анализирует только трафик
- **Активное сканирование** - отправляет запросы для проверки наличия уязвимостей
- **Автономное сканирование** - выполняется непосредственно на системе
- **Сетевое сканирование** - проверяет удаленные системы через сеть

### Популярные базы данных уязвимостей
- **CVE** (Common Vulnerabilities and Exposures) - база данных общих уязвимостей
- **NVD** (National Vulnerability Database) - национальная база данных уязвимостей
- **Exploit-DB** - база данных эксплойтов
- **OSV** - открытая база данных уязвимостей для open source

> [!warning] Важно
> Сканирование должно проводиться в нерабочее время, чтобы избежать влияния на производительность систем.

## Анализ результатов

После сканирования необходимо проанализировать полученные результаты. Это включает в себя:

### Фильтрация ложных срабатываний
- Проверка достоверности найденных уязвимостей
- Исключение неактуальных результатов
- Подтверждение наличия уязвимостей вручную

### Оценка потенциального риска
- Определение возможного ущерба от уязвимости
- Оценка вероятности эксплуатации
- Учет специфики инфраструктуры

### Определение приоритетности устранения
- На основе критичности уязвимости
- С учетом доступности эксплойтов
- С учетом влияния на бизнес-процессы

### Сопоставление с уже известными уязвимостями
- Проверка на наличие дубликатов
- Сравнение с предыдущими оценками
- Обновление реестра уязвимостей

## Классификация уязвимостей

Уязвимости можно классифицировать по различным критериям:

### По типу воздействия
- **Критические**: позволяют получить полный контроль над системой
- **Высокие**: позволяют получить доступ к конфиденциальным данным
- **Средние**: потенциально могут быть использованы для атак
- **Низкие**: минимальный риск для системы

### По области воздействия
- **Сетевые уязвимости**: связаны с сетевыми протоколами и службами
- **Прикладные уязвимости**: связаны с приложениями и веб-сервисами
- **Конфигурационные уязвимости**: результат неправильных настроек
- **Криптографические уязвимости**: связаны с использованием шифрования

### По CWE (Common Weakness Enumeration)
- **CWE-79** - XSS (Cross-site Scripting)
- **CWE-89** - SQL Injection
- **CWE-352** - CSRF (Cross-Site Request Forgery)
- **CWE-502** - Deserialization of Untrusted Data
- **CWE-287** - Improper Authentication

## Оценка критичности (CVSS)

CVSS (Common Vulnerability Scoring System) — это открытая индустриальная спецификация для оценки критичности компьютерных уязвимостей. CVSS использует метрики для определения уровня риска, связанного с уязвимостью, и позволяет сравнивать уязвимости между собой.

### Основные метрики CVSS
- **Вектор атаки (AV)**: как злоумышленник может атаковать систему
  - N (Network) - сеть
  - A (Adjacent) - соседняя сеть
  - L (Local) - локальный доступ
  - P (Physical) - физический доступ

- **Сложность атаки (AC)**: насколько сложна эксплуатация уязвимости
  - L (Low) - низкая
  - H (High) - высокая

- **Требования к привилегиям (PR)**: какие привилегии нужны для эксплуатации
  - N (None) - не требуются
  - L (Low) - низкие
  - H (High) - высокие

- **Требования к пользовательскому взаимодействию (UI)**: требуется ли участие пользователя
  - N (None) - не требуется
  - R (Required) - требуется

- **Область воздействия (S)**: влияет ли уязвимость на другие компоненты
  - U (Unchanged) - без изменений
  - C (Changed) - изменена

### Воздействие на компоненты
- **Воздействие на конфиденциальность (C)**: насколько нарушается конфиденциальность
- **Воздействие на целостность (I)**: насколько нарушается целостность данных
- **Воздействие на доступность (A)**: насколько нарушается доступность сервиса

### Временные метрики
- **Подтверждение уязвимости (E)**: уровень уверенности в уязвимости
- **Меры устранения (RL)**: доступность способов устранения
- **Наличие эксплойта (RC)**: доступность рабочего эксплойта

### Оценочные метрики
- **Воздействие на конфиденциальность (C)**: насколько нарушается конфиденциальность
- **Воздействие на целостность (I)**: насколько нарушается целостность данных
- **Воздействие на доступность (A)**: насколько нарушается доступность сервиса

## Приоритезация уязвимостей

Приоритезация уязвимостей позволяет определить, какие уязвимости следует устранить в первую очередь. При этом учитываются:

### Факторы приоритезации
1. **Критичность уязвимости** - оценка по шкале CVSS
2. **Доступность эксплойта** - есть ли рабочий эксплойт
3. **Воздействие на бизнес** - влияние на критические бизнес-процессы
4. **Сложность устранения** - насколько сложно исправить уязвимость
5. **Позиция в инфраструктуре** - критичность компонента с уязвимостью
6. **Вероятность эксплуатации** - насколько вероятно использование уязвимости
7. **Наличие патча** - доступность официального исправления

### Матрица приоритетов
| Уровень | CVSS | Действие |
|---------|------|----------|
| Критический | 9.0-10.0 | Немедленное устранение |
| Высокий | 7.0-8.9 | Устранение в течение 30 дней |
| Средний | 4.0-6.9 | Устранение в течение 90 дней |
| Низкий | 0.1-3.9 | Планирование на будущее |

### Факторы влияния на приоритет
- Уязвимость в критически важной системе получает более высокий приоритет
- Уязвимости с известными эксплойтами получают более высокий приоритет
- Уязвимости, которые могут привести к утечке персональных данных, получают более высокий приоритет
- Уязвимости, для устранения которых требуется меньше ресурсов, могут быть исправлены быстрее

## Ложные срабатывания

Ложные срабатывания — это ситуации, когда инструменты оценки уязвимостей ошибочно определяют наличие уязвимости там, где её на самом деле нет. Это может происходить по различным причинам:

### Причины ложных срабатываний
- Неправильная настройка инструмента
- Особенности конфигурации системы
- Использование нестандартных решений
- Устаревшая база данных уязвимостей
- Неправильная идентификация версии ПО

### Типы ложных срабатываний
- **Ложноположительные** - система указывает на уязвимость, которой нет
- **Ложноотрицательные** - система не обнаруживает существующую уязвимость

> [!tip] Совет
> Всегда проводите ручную проверку результатов сканирования, особенно для критических уязвимостей.

### Методы снижения ложных срабатываний
- Регулярное обновление баз данных уязвимостей
- Правильная настройка инструментов сканирования
- Использование нескольких инструментов для подтверждения результатов
- Проведение дополнительных тестов для подтверждения уязвимостей

## Рекомендации по устранению

Для каждой найденной уязвимости должны быть предоставлены рекомендации по её устранению. Это может включать:

### Общие рекомендации
- Установку обновлений и патчей
- Изменение конфигурации системы
- Замену уязвимого компонента
- Внедрение дополнительных мер защиты

### Рекомендации по типам уязвимостей
- **Уязвимости аутентификации**: усиление требований к паролям, внедрение многофакторной аутентификации
- **Уязвимости авторизации**: проверка прав доступа, реализация принципа наименьших привилегий
- **Уязвимости валидации ввода**: внедрение проверок на стороне сервера и клиента
- **Конфигурационные уязвимости**: изменение стандартных настроек, отключение ненужных сервисов

### План устранения
1. **Немедленные меры** - действия для уменьшения риска до полного устранения
2. **Долгосрочные меры** - полное устранение уязвимости
3. **Мониторинг** - проверка эффективности мер устранения
4. **Повторная проверка** - подтверждение устранения уязвимости

## Отчетность

Отчет об оценке уязвимостей должен содержать:

### Структура отчета
- **Резюме результатов** - краткое описание найденных уязвимостей
- **Методология** - описание использованных методов и инструментов
- **Перечень уязвимостей** - подробное описание обнаруженных уязвимостей
- **Классификация** - группировка уязвимостей по критичности
- **Рекомендации** - шаги по устранению уязвимостей
- **Приоритетность** - очередность устранения уязвимостей
- **Выводы и рекомендации** - общие выводы и рекомендации по улучшению безопасности

### Ключевые элементы отчета
- **Идентификатор уязвимости** (CVE, CWE)
- **Описание уязвимости**
- **Оценка критичности** (CVSS)
- **Потенциальное воздействие**
- **Шаги по устранению**
- **Ссылки на патчи и исправления**
- **Доказательства** (скриншоты, логи и т.д.)

### Аудитории отчета
- **Технические специалисты** - нуждаются в детальной технической информации
- **Руководство** - нуждается в обобщенной информации о рисках и воздействии на бизнес
- **Операционные команды** - нуждаются в конкретных шагах для устранения уязвимостей

## Ссылки на другие связанные файлы

- [[Пенетрационное тестирование]] - подробное руководство по пентестингу
- [[Тестирование безопасности]] - общие методы тестирования безопасности
- [[Управление уязвимостями]] - процессы управления уязвимостями
- [[Оценка рисков безопасности]] - методы оценки рисков
- [[Мониторинг безопасности]] - системы мониторинга безопасности
- [[Реагирование на инциденты]] - процессы реагирования на инциденты
- [[Политика безопасности]] - организационные аспекты безопасности
- [[Безопасность приложений]] - безопасность на уровне приложений
- [[Сетевая безопасность]] - аспекты сетевой безопасности
- [[Криптография]] - использование криптографии в безопасности
- [[CVSS-оценка]] - подробное руководство по системе оценки CVSS
- [[OWASP-Top-10]] - топ-10 уязвимостей веб-приложений
- [[XSS-защита]] - защита от межсайтового скриптинга
- [[SQL-инъекции]] - защита от SQL-инъекций
- [[CSRF-защита]] - защита от межсайтовой подделки запроса
- [[Secure-Coding-Practices]] - практики безопасного программирования
- [[Dependency-Security]] - безопасность зависимостей
- [[Сканирование уязвимостей]] - технические аспекты сканирования
- [[Процесс аудита безопасности]] - общий процесс аудита безопасности
- [[Чек-лист аудита]] - контрольный список для аудита безопасности
- [[Управление доступом]] - системы управления доступом
- [[Управление сессиями и аутентификацией]] - управление сессиями и аутентификацией
- [[Шифрование на клиенте]] - клиентское шифрование данных
- [[Secure-Storage]] - безопасное хранение данных
- [[Ограничение доступа к API]] - защита API
- [[Ограничение ресурсов и защита от злоупотреблений]] - предотвращение злоупотреблений
- [[Идентификация и отслеживание угроз]] - системы обнаружения угроз
- [[Инцидент-менеджмент на фронтенде]] - управление инцидентами на фронтенде
- [[Безопасность веб-приложений]] - безопасность веб-приложений
- [[Content-Security-Policy]] - политика безопасности контента
- [[HTTP-Security-Headers]] - заголовки безопасности HTTP
- [[Subresource-Integrity]] - целостность подресурсов
- [[Feature-Policy]] - политика функций
- [[Clickjacking-защита]] - защита от кликджекинга
- [[Меры против ботов]] - защита от автоматизированных атак
- [[Обнаружение и предотвращение брутфорса]] - защита от подбора паролей
- [[Защита от социальной инженерии]] - защита от манипуляций
- [[Безопасность форм]] - безопасность веб-форм
- [[Безопасность платежных форм]] - безопасность платежных процессов
- [[Обработка персональных данных]] - защита персональных данных
- [[Снижение рисков при работе с cookies]] - безопасная работа с cookies
- [[Снижение рисков в DevTools]] - безопасность при использовании DevTools
- [[Снижение влияния на производительность]] - баланс безопасности и производительности
- [[Отладка безопасности]] - отладка безопасности приложений
- [[Политики безопасности для файлов]] - безопасность файлов и загрузок
- [[Обфускация и защита исходного кода]] - защита клиентского кода
- [[Использование WebAssembly безопасно]] - безопасное использование WebAssembly
- [[Безопасность PWA]] - безопасность прогрессивных веб-приложений
- [[Безопасность в SPA]] - безопасность одностраничных приложений
- [[Безопасность веб-компонентов]] - безопасность веб-компонентов
- [[Безопасность веб-сокетов]] - безопасность WebSocket
- [[Безопасность в системах с push-уведомлениями]] - безопасность уведомлений
- [[Безопасность в системах с drag-and-drop файлов]] - безопасность перетаскивания файлов
- [[Безопасность в системах с поддержкой плагинов]] - безопасность плагинов
- [[Безопасность в системах с поддержкой камеры и микрофона]] - безопасность медиаустройств
- [[Безопасность в системах с высокой интерактивностью]] - безопасность интерактивных систем
- [[Безопасность в приложениях с оффлайн-режимом]] - безопасность оффлайн-приложений
- [[Безопасность в приложениях с веб-платежами]] - безопасность платежей
- [[Безопасность в приложениях с веб-печатью]] - безопасность печати
- [[Безопасность в играх]] - безопасность игровых приложений
- [[Безопасность в VR-AR-приложениях]] - безопасность виртуальной/дополненной реальности
- [[Безопасность в чатах]] - безопасность коммуникационных систем
- [[Безопасность в CMS]] - безопасность систем управления контентом
- [[Безопасность в системах i18n]] - безопасность интернационализации
- [[Безопасность в системах сборки]] - безопасность процессов сборки
- [[Безопасность в OIDC]] - безопасность протокола OIDC
- [[Интеграция с OAuth]] - безопасная интеграция с OAuth
- [[Безопасность в third-party-integrations]] - безопасность интеграций
- [[Безопасность в SPA]] - безопасность одностраничных приложений
- [[Безопасность в браузерных расширениях]] - безопасность расширений
- [[Безопасность в мобильных браузерах]] - безопасность мобильных браузеров
- [[Безопасность в системах с несколькими доменами]] - безопасность мультидоменных систем
- [[Безопасность в системах с высокой доступностью]] - безопасность HA-систем
- [[Безопасность в микросервисной архитектуре]] - безопасность микросервисов
- [[Безопасность в облачных средах]] - безопасность в облаке
- [[Архитектурные паттерны безопасности]] - паттерны безопасности
- [[Защита от атак на уровне браузера]] - браузерная безопасность
- [[Защита от инъекций]] - защита от различных видов инъекций
- [[Контроль доступа к данным в браузере]] - клиентский контроль доступа
- [[Работа с уязвимыми пользователями]] - безопасность для уязвимых пользователей
- [[Безопасность данных в реальном времени]] - безопасность потоковых данных
- [[Безопасность при работе с геолокацией]] - безопасность геоданных
- [[Безопасность файлов конфигурации]] - защита конфигурационных файлов
- [[Безопасность в браузере]] - общая безопасность браузера
- [[Безопасность в системах с P2P-коммуникациями]] - безопасность P2P-систем
- [[Безопасность в веб-приложениях с AI-ML]] - безопасность ИИ/МЛ-приложений
- [[Безопасность в веб-приложениях для детей]] - безопасность детских приложений
- [[Безопасность в сервис-воркерах]] - безопасность сервис-воркеров
- [[Этические аспекты безопасности]] - этические вопросы безопасности
- [[Сниффинг и защита от него]] - защита от перехвата трафика
- [[Мониторинг безопасности в продакшене]] - продакшен-мониторинг
- [[Управление сессиями и аутентификацией]] - управление сессиями
- [[Шифрование на клиенте]] - клиентское шифрование
- [[Secure-Storage]] - безопасное хранение данных
- [[Dependency-Security]] - безопасность зависимостей
- [[Secure-Coding-Practices]] - практики безопасного программирования
- [[Content-Security-Policy]] - политика безопасности контента
- [[HTTP-Security-Headers]] - заголовки безопасности HTTP
- [[Subresource-Integrity]] - целостность подресурсов
- [[Feature-Policy]] - политика функций

## Заключение

Оценка уязвимостей — это критически важный элемент программы кибербезопасности любой организации. Эффективная оценка уязвимостей позволяет:

- Выявлять уязвимости до того, как они будут использованы злоумышленниками
- Оценивать текущий уровень безопасности инфраструктуры
- Принимать обоснованные решения по улучшению безопасности
- Соответствовать требованиям нормативных стандартов
- Повышать доверие со стороны клиентов и партнеров

Для достижения максимальной эффективности оценка уязвимостей должна быть регулярной, систематической и интегрированной в общую стратегию безопасности организации. Важно не только находить уязвимости, но и своевременно устранять их, отслеживать эффективность мер по улучшению безопасности и адаптировать подходы к изменяющейся угрозной среде.

Ключ к успеху — это сочетание автоматизированных инструментов, экспертизы специалистов по безопасности и зрелых процессов управления уязвимостями, которые позволяют организациям оставаться на шаг впереди потенциальных злоумышленников.