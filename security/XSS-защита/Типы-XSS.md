---
aliases: ["Типы XSS", "Классификация XSS", "Виды XSS"]
tags: [security, xss, web-security, injection]
---

# Типы XSS (Межсайтовый скриптинг)

## Введение

XSS (Cross-Site Scripting) — это тип уязвимости, при которой злоумышленник может внедрить вредоносный скрипт в веб-страницу, просматриваемую другими пользователями. Существует несколько типов XSS-атак, каждый из которых имеет свои особенности и методы эксплуатации.

## Классификация XSS-атак

### 1. Отраженный XSS (Reflected XSS)

Отраженный XSS — это тип уязвимости, при которой вредоносный скрипт "отражается" от веб-сервера и выполняется в браузере жертвы. Обычно осуществляется через специально сформированную ссылку.

#### Механизм атаки

1. Злоумышленник создает URL с вредоносным скриптом
2. Жертва переходит по ссылке (часто через фишинг)
3. Сервер включает вредоносный скрипт в ответ
4. Браузер жертвы выполняет скрипт

#### Пример уязвимости

```javascript
// Уязвимый серверный код
app.get('/search', (req, res) => {
  const query = req.query.q;
  res.send(`<h2>Поиск: ${query}</h2>`); // Неэкранированный вывод
});

// Злоумышленник может отправить ссылку:
// https://example.com/search?q=<script>alert('XSS')</script>
```

#### Защита от отраженного XSS

- Валидация и экранирование всех входных данных
- Использование Content Security Policy (CSP)
- Правильное кодирование вывода

### 2. Хранимый XSS (Stored XSS)

Хранимый XSS — наиболее опасный тип, при котором вредоносный скрипт сохраняется на сервере и отображается всем пользователям, посещающим уязвимую страницу.

#### Механизм атаки

1. Злоумышленник отправляет вредоносный скрипт на сервер
2. Сервер сохраняет скрипт в базе данных
3. При отображении данных скрипт выполняется в браузере жертвы

#### Пример уязвимости

```javascript
// Уязвимый серверный код
app.post('/comment', (req, res) => {
  const comment = req.body.comment;
  // Сохраняем комментарий без валидации
  db.saveComment(comment);
  res.redirect('/comments');
});

// Уязвимое отображение
app.get('/comments', (req, res) => {
  const comments = db.getComments();
  let html = '<div class="comments">';
  comments.forEach(comment => {
    html += `<div class="comment">${comment}</div>`; // Неэкранированный вывод
  });
  html += '</div>';
  res.send(html);
});
```

#### Защита от хранимого XSS

- Валидация и санитизация всех входных данных
- Использование белых списков разрешенных тегов
- Правильное кодирование при выводе

### 3. DOM-based XSS

DOM-based XSS — тип уязвимости, при которой атака происходит на стороне клиента через манипуляции с DOM-деревом.

#### Механизм атаки

1. Вредоносный скрипт передается через URL или другие источники данных
2. JavaScript-код на странице использует эти данные без проверки
3. Скрипт изменяет DOM, вызывая выполнение вредоносного кода

#### Пример уязвимости

```javascript
// Уязвимый клиентский код
function updateContent() {
  const hash = window.location.hash.substring(1);
  document.getElementById('content').innerHTML = hash; // Опасно!
}

// При переходе на страницу с:
// https://example.com#<script>alert('XSS')</script>
// выполнится вредоносный скрипт
```

#### Защита от DOM-based XSS

- Валидация данных из URL, cookie и других источников
- Использование безопасных методов работы с DOM
- Правильное кодирование данных перед вставкой в DOM

## Дополнительные типы XSS

### 4. Self XSS

Само-атака XSS, при которой пользователь самостоятельно вводит вредоносный скрипт (обычно в результате социальной инженерии).

### 5. Mutation XSS

Тип атаки, при котором браузер "исправляет" HTML-код, превращая безобидный код во вредоносный.

## Примеры атак

### Простая XSS-атака

```html
<script>alert('XSS')</script>
```

### XSS через атрибуты

```html
<div onload="alert('XSS')"></div>
<img src="x" onerror="alert('XSS')">
```

### XSS через CSS

```html
<style>body{background:url("javascript:alert('XSS')")}</style>
```

## Последствия XSS-атак

> [!danger] Основные последствия XSS
> - Кража сессионных кук
> - Перенаправление пользователя на вредоносный сайт
> - Фишинг логинов и паролей
> - Выполнение действий от имени пользователя
> - Кража персональных данных

## Методы обнаружения XSS

### Ручное тестирование

- Вставка специальных символов в формы: `<`, `>`, `"`, `'`, `;`
- Проверка отражения данных в ответе
- Анализ кода на предмет небезопасного использования данных

### Автоматизированные инструменты

- OWASP ZAP
- Burp Suite
- XSStrike
- sqlmap (для XSS-инъекций)

## Лучшие практики защиты

> [!tip] Лучшие практики защиты от XSS
> - Валидация и экранирование всех входных данных
> - Использование Content Security Policy
> - Правильное кодирование вывода
> - Регулярные тесты на проникновение

## Связь с другими аспектами безопасности

Типы XSS тесно связаны с:
- [[Проверка-ввода]] — методы валидации данных
- [[Кодирование-вывода]] — безопасный вывод данных
- [[Методы-санитизации]] — очистка ввода
- [[Директивы-CSP]] — использование Content Security Policy
- [[Обнаружение-и-предотвращение-брутфорса]] — общие методы безопасности

## Заключение

Понимание различных типов XSS-атак критически важно для разработчиков. Каждый тип требует специфических методов защиты, и только комплексный подход может обеспечить адекватную защиту от XSS-уязвимостей.

## Дополнительные ресурсы

- OWASP Cross-site Scripting (XSS)
- XSS Prevention Cheat Sheet
- Browser Security Handbook