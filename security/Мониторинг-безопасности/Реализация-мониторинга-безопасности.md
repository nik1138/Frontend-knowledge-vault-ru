---
aliases: [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏]
tags: [security, monitoring, web-security, security-operations]
---

# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–Ω–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é –∑–∞—â–∏—Ç—É —Å–∏—Å—Ç–µ–º.

## –ü–æ–¥—Ö–æ–¥—ã –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ù–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
–í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Å–µ—Ä–≤–µ—Ä–æ–≤.

### 2. –ù–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —Å–∞–º–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

### 3. –ù–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

### –°–µ—Ä–≤–µ—Ä–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (Node.js)

#### –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```javascript
const winston = require('winston');
const express = require('express');
const rateLimit = require('express-rate-limit');

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
const securityLogger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.errors({ stack: true }),
    winston.format.splat(),
    winston.format.json()
  ),
  defaultMeta: { service: 'security' },
  transports: [
    new winston.transports.File({ 
      filename: 'logs/security-error.log', 
      level: 'error',
      maxsize: 5242880, // 5MB
      maxFiles: 5
    }),
    new winston.transports.File({ 
      filename: 'logs/security-combined.log',
      maxsize: 5242880, // 5MB
      maxFiles: 5
    })
  ]
});

// Middleware –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
const securityMonitoring = (req, res, next) => {
  const startTime = Date.now();
  
  // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
  const logSecurityEvent = (level, message, additionalData = {}) => {
    securityLogger.log(level, message, {
      timestamp: new Date().toISOString(),
      method: req.method,
      url: req.url,
      ip: req.ip,
      userAgent: req.get('User-Agent'),
      sessionId: req.session?.id,
      userId: req.user?.id,
      ...additionalData
    });
  };
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
  if (req.get('X-Forwarded-For') && req.get('X-Forwarded-For').split(',').length > 3) {
    logSecurityEvent('warn', 'Suspicious number of X-Forwarded-For hops', {
      hops: req.get('X-Forwarded-For').split(',').length
    });
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ URL
  const suspiciousPatterns = [
    /<script/i,
    /javascript:/i,
    /on\w+\s*=/i,
    /\.\.\//i,
    /union\s+select/i
  ];
  
  for (const pattern of suspiciousPatterns) {
    if (pattern.test(req.url) || pattern.test(req.body?.toString())) {
      logSecurityEvent('error', 'Suspicious pattern detected', {
        pattern: pattern.toString(),
        matchedIn: pattern.test(req.url) ? 'url' : 'body'
      });
    }
  }
  
  // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö –∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  req.securityLog = logSecurityEvent;
  
  // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
  res.on('finish', () => {
    const duration = Date.now() - startTime;
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    if (duration > 5000) { // 5 —Å–µ–∫—É–Ω–¥
      logSecurityEvent('warn', 'Slow request detected', {
        duration: duration,
        statusCode: res.statusCode
      });
    }
  });
  
  next();
};

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∞—Ç–∞–∫
const authLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  max: 5, // –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ 5 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ –∑–∞ –æ–∫–Ω–æ
  message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',
  standardHeaders: true,
  legacyHeaders: false,
  skipSuccessfulRequests: true, // –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
  keyGenerator: (req) => req.ip,
  skip: (req) => {
    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    return req.ip === '127.0.0.1' || req.ip.startsWith('10.') || req.ip.startsWith('192.168.');
  }
});

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –º–∞—Ä—à—Ä—É—Ç–∞—Ö
app.use('/login', authLimiter);
app.use(securityMonitoring);

app.post('/login', (req, res) => {
  // –õ–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  const { username, password } = req.body;
  
  // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  if (isValidCredentials(username, password)) {
    req.securityLog('info', 'Successful authentication', { username });
    // –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    req.session.userId = getUserByUsername(username).id;
    res.json({ success: true });
  } else {
    req.securityLog('warn', 'Failed authentication attempt', { 
      username, 
      ip: req.ip,
      userAgent: req.get('User-Agent')
    });
    res.status(401).json({ error: 'Invalid credentials' });
  }
});
```

#### –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π
```javascript
class AnomalyDetector {
  constructor() {
    this.eventHistory = new Map(); // –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π
    this.thresholds = {
      loginAttempts: 5,        // –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ –≤ 15 –º–∏–Ω—É—Ç
      requestsPerMinute: 100,  // –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
      failedLogins: 10         // –Ω–µ—É–¥–∞—á–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤ –≤ —á–∞—Å
    };
    this.alertCallbacks = [];
  }

  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è
  recordEvent(eventType, identifier, metadata = {}) {
    const key = `${eventType}:${identifier}`;
    const now = Date.now();
    
    if (!this.eventHistory.has(key)) {
      this.eventHistory.set(key, []);
    }
    
    const events = this.eventHistory.get(key);
    events.push({
      timestamp: now,
      metadata: metadata
    });
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Å—Ç–∞—Ä—à–µ 15 –º–∏–Ω—É—Ç
    const fifteenMinutesAgo = now - 15 * 60 * 1000;
    const filteredEvents = events.filter(event => event.timestamp > fifteenMinutesAgo);
    this.eventHistory.set(key, filteredEvents);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏
    this.checkAnomalies(eventType, identifier, filteredEvents);
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏
  checkAnomalies(eventType, identifier, events) {
    const now = Date.now();
    
    switch (eventType) {
      case 'login_attempt':
        if (events.length > this.thresholds.loginAttempts) {
          this.triggerAlert('High number of login attempts', {
            eventType,
            identifier,
            count: events.length,
            timeWindow: '15 minutes'
          });
        }
        break;
        
      case 'request':
        const oneMinuteAgo = now - 60 * 1000;
        const recentEvents = events.filter(event => event.timestamp > oneMinuteAgo);
        if (recentEvents.length > this.thresholds.requestsPerMinute) {
          this.triggerAlert('High request rate detected', {
            eventType,
            identifier,
            count: recentEvents.length,
            timeWindow: '1 minute'
          });
        }
        break;
        
      case 'failed_login':
        const oneHourAgo = now - 60 * 60 * 1000;
        const failedEvents = events.filter(event => event.timestamp > oneHourAgo);
        if (failedEvents.length > this.thresholds.failedLogins) {
          this.triggerAlert('High number of failed logins', {
            eventType,
            identifier,
            count: failedEvents.length,
            timeWindow: '1 hour'
          });
        }
        break;
    }
  }

  // –¢—Ä–∏–≥–≥–µ—Ä –∞–ª–µ—Ä—Ç–∞
  triggerAlert(message, details) {
    console.log(`[SECURITY ALERT] ${message}`, details);
    
    // –í—ã–∑–æ–≤ –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö callback'–æ–≤
    for (const callback of this.alertCallbacks) {
      callback(message, details);
    }
  }

  // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∞–ª–µ—Ä—Ç—ã
  onAlert(callback) {
    this.alertCallbacks.push(callback);
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  getStats() {
    const stats = {};
    for (const [key, events] of this.eventHistory) {
      stats[key] = events.length;
    }
    return stats;
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π
const anomalyDetector = new AnomalyDetector();

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∞–ª–µ—Ä—Ç—ã
anomalyDetector.onAlert((message, details) => {
  // –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
  console.log(`Sending alert to monitoring system: ${message}`, details);
  
  // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Slack, email, etc.
  sendAlertToTeam(message, details);
});

// Middleware –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π
const anomalyTracking = (req, res, next) => {
  // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
  if (req.path === '/login' && req.method === 'POST') {
    anomalyDetector.recordEvent('login_attempt', req.ip);
  }
  
  // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
  anomalyDetector.recordEvent('request', req.ip);
  
  // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  res.on('finish', () => {
    if (res.statusCode === 401 || res.statusCode === 403) {
      anomalyDetector.recordEvent('failed_login', req.ip);
    }
  });
  
  next();
};

app.use(anomalyTracking);
```

### Python (Flask/Django)

#### Flask —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```python
from flask import Flask, request, g
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address
import logging
import json
from datetime import datetime
import re

app = Flask(__name__)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s %(levelname)s %(name)s %(message)s',
    handlers=[
        logging.FileHandler('logs/security.log'),
        logging.StreamHandler()
    ]
)
security_logger = logging.getLogger('security')

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
limiter = Limiter(
    app,
    key_func=get_remote_address,
    default_limits=["100 per hour", "20 per minute"]
)

class SecurityMonitor:
    def __init__(self):
        self.anomaly_thresholds = {
            'login_attempts': 5,      # –∑–∞ 15 –º–∏–Ω—É—Ç
            'requests_per_minute': 100,
            'failed_logins': 10       # –∑–∞ 1 —á–∞—Å
        }
        self.event_history = {}
    
    def log_security_event(self, level, message, extra_data=None):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
        log_data = {
            'timestamp': datetime.now().isoformat(),
            'method': request.method,
            'url': request.url,
            'remote_addr': request.remote_addr,
            'user_agent': request.headers.get('User-Agent'),
            'message': message
        }
        
        if extra_data:
            log_data.update(extra_data)
        
        if level == 'error':
            security_logger.error(json.dumps(log_data))
        elif level == 'warning':
            security_logger.warning(json.dumps(log_data))
        else:
            security_logger.info(json.dumps(log_data))
    
    def detect_suspicious_activity(self):
        """–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
        suspicious_patterns = [
            r'<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>',
            r'javascript:',
            r'on\w+\s*=',
            r'\.\./',
            r'union\s+select',
            r'(exec|execute|system|shell)\s*\(.*\)'
        ]
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ URL
        for pattern in suspicious_patterns:
            if re.search(pattern, request.url, re.IGNORECASE):
                self.log_security_event('error', 'Suspicious pattern in URL', {
                    'pattern': pattern,
                    'url': request.url
                })
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
        if request.data:
            for pattern in suspicious_patterns:
                if re.search(pattern, request.data.decode('utf-8', errors='ignore'), re.IGNORECASE):
                    self.log_security_event('error', 'Suspicious pattern in request body', {
                        'pattern': pattern
                    })
    
    def record_event(self, event_type, identifier):
        """–ó–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∞–Ω–æ–º–∞–ª–∏–π"""
        key = f"{event_type}:{identifier}"
        now = datetime.now().timestamp()
        
        if key not in self.event_history:
            self.event_history[key] = []
        
        self.event_history[key].append(now)
        
        # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π (—Å—Ç–∞—Ä—à–µ 15 –º–∏–Ω—É—Ç)
        fifteen_minutes_ago = now - 15 * 60
        self.event_history[key] = [
            timestamp for timestamp in self.event_history[key] 
            if timestamp > fifteen_minutes_ago
        ]
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏
        self.check_anomalies(event_type, identifier)
    
    def check_anomalies(self, event_type, identifier):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏"""
        key = f"{event_type}:{identifier}"
        events = self.event_history.get(key, [])
        
        if event_type == 'login_attempt' and len(events) > self.anomaly_thresholds['login_attempts']:
            self.log_security_event('warning', 'High number of login attempts', {
                'identifier': identifier,
                'count': len(events)
            })
        elif event_type == 'request' and len(events) > self.anomaly_thresholds['requests_per_minute']:
            self.log_security_event('warning', 'High request rate', {
                'identifier': identifier,
                'count': len(events)
            })

# –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–æ–Ω–∏—Ç–æ—Ä–∞
security_monitor = SecurityMonitor()

# Middleware –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
@app.before_request
def security_monitoring():
    # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    security_monitor.detect_suspicious_activity()
    
    # –ó–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏—è –∑–∞–ø—Ä–æ—Å–∞
    security_monitor.record_event('request', request.remote_addr)

@app.route('/login', methods=['POST'])
@limiter.limit("5 per 15 minutes", per_method=True, methods=['POST'])
def login():
    username = request.form.get('username')
    password = request.form.get('password')
    
    # –ó–∞–ø–∏—Å—å –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
    security_monitor.record_event('login_attempt', request.remote_addr)
    
    # –õ–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if authenticate_user(username, password):
        security_monitor.log_security_event('info', 'Successful login', {
            'username': username
        })
        return {'success': True}
    else:
        security_monitor.log_security_event('warning', 'Failed login attempt', {
            'username': username,
            'ip': request.remote_addr
        })
        return {'success': False, 'error': 'Invalid credentials'}, 401

if __name__ == '__main__':
    app.run(debug=False)  # –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ debug –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å False
```

#### Django —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```python
# settings.py
SECURITY_LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'security': {
            'format': '%(asctime)s %(name)s %(levelname)s %(message)s'
        },
    },
    'handlers': {
        'security_file': {
            'level': 'INFO',
            'class': 'logging.handlers.RotatingFileHandler',
            'filename': 'logs/security.log',
            'maxBytes': 1024*1024*5,  # 5 MB
            'backupCount': 5,
            'formatter': 'security',
        },
    },
    'loggers': {
        'security': {
            'handlers': ['security_file'],
            'level': 'INFO',
            'propagate': False,
        },
    },
}

# middleware.py
import logging
import re
from django.utils.deprecation import MiddlewareMixin
from django.conf import settings

security_logger = logging.getLogger('security')

class SecurityMonitoringMiddleware(MiddlewareMixin):
    def __init__(self, get_response):
        self.get_response = get_response
        super().__init__(get_response)
    
    def __call__(self, request):
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
        self.log_security_event('info', 'Request started', {
            'method': request.method,
            'path': request.path,
            'user': str(request.user) if hasattr(request, 'user') else 'Anonymous',
            'ip': self.get_client_ip(request),
            'user_agent': request.META.get('HTTP_USER_AGENT', '')
        })
        
        response = self.get_response(request)
        
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞
        if response.status_code >= 400:
            self.log_security_event('warning', 'Request failed', {
                'status_code': response.status_code,
                'method': request.method,
                'path': request.path,
                'ip': self.get_client_ip(request)
            })
        
        return response
    
    def process_view(self, request, view_func, view_args, view_kwargs):
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ URL
        suspicious_patterns = [
            r'<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>',
            r'javascript:',
            r'on\w+\s*=',
            r'\.\./',
            r'union\s+select'
        ]
        
        for pattern in suspicious_patterns:
            if re.search(pattern, request.path, re.IGNORECASE):
                self.log_security_event('error', 'Suspicious pattern detected in URL', {
                    'pattern': pattern,
                    'path': request.path,
                    'ip': self.get_client_ip(request)
                })
    
    def log_security_event(self, level, message, extra_data=None):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
        log_data = {
            'message': message,
            **(extra_data or {})
        }
        
        if level == 'error':
            security_logger.error(str(log_data))
        elif level == 'warning':
            security_logger.warning(str(log_data))
        else:
            security_logger.info(str(log_data))
    
    def get_client_ip(self, request):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞"""
        x_forwarded_for = request.META.get('HTTP_X_FORWARDED_FOR')
        if x_forwarded_for:
            ip = x_forwarded_for.split(',')[0]
        else:
            ip = request.META.get('REMOTE_ADDR')
        return ip

# apps.py
from django.apps import AppConfig
import logging.config

class SecurityConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'security'
    
    def ready(self):
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        from django.conf import settings
        logging.config.dictConfig(settings.SECURITY_LOGGING)
```

## –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
1. **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**:
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
   - –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏ KPI –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö

2. **–í—ã–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π**:
   - –í—ã–±–æ—Ä —Å–∏—Å—Ç–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (ELK, Splunk, etc.)
   - –í—ã–±–æ—Ä —Å–∏—Å—Ç–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
   - –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π

### –≠—Ç–∞–ø 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–≥—Ä–æ–∑
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —É–≥—Ä–æ–∑
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º –æ–ø–æ–≤–µ—â–µ–Ω–∏—è

### –≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ª–æ–≥–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ middleware –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –≠—Ç–∞–ø 5: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
- –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–µ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–º–µ—Ä 1: ELK Stack –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```yaml
# docker-compose.yml –¥–ª—è ELK Stack
version: '3.8'
services:
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    ports:
      - "9200:9200"
    volumes:
      - elasticsearch-data:/usr/share/elasticsearch/data

  logstash:
    image: docker.elastic.co/logstash/logstash:8.11.0
    environment:
      - xpack.monitoring.enabled=false
    ports:
      - "5044:5044"
      - "5000:5000/tcp"
      - "5000:5000/udp"
      - "9600:9600"
    volumes:
      - ./logstash/pipeline:/usr/share/logstash/pipeline
    depends_on:
      - elasticsearch

  kibana:
    image: docker.elastic.co/kibana/kibana:8.11.0
    ports:
      - "5601:5601"
    environment:
      - ELASTICSEARCH_HOSTS=http://elasticsearch:9200
    depends_on:
      - elasticsearch

volumes:
  elasticsearch-data:
```

```ruby
# logstash/pipeline/security.conf
input {
  beats {
    port => 5044
  }
  
  tcp {
    port => 5000
    codec => json
  }
}

filter {
  if [type] == "security" {
    # –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    grok {
      match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:level} %{WORD:service} %{GREEDYDATA:details}" }
    }
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É–≥—Ä–æ–∑–∞—Ö
    if [details] =~ /suspicious/ {
      mutate {
        add_field => { "[@metadata][threat_level]" => "high" }
      }
    }
    
    # –ì–µ–æ-–ª–æ–∫–∞—Ü–∏—è IP-–∞–¥—Ä–µ—Å–æ–≤
    if [client_ip] {
      geoip {
        source => "client_ip"
        target => "geoip"
      }
    }
  }
}

output {
  elasticsearch {
    hosts => ["elasticsearch:9200"]
    index => "security-events-%{+YYYY.MM.dd}"
  }
  
  # –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –≤ Slack –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ —É–≥—Ä–æ–∑
  if [@metadata][threat_level] == "high" {
    http {
      url => "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
      http_method => "post"
      format => "json"
      mapping => {
        "text" => "High security threat detected: %{details}"
      }
    }
  }
}
```

### –ü—Ä–∏–º–µ—Ä 2: –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
```javascript
class IncidentResponseSystem {
  constructor() {
    this.alertQueue = [];
    this.responseTeams = {
      'critical': ['security-team', 'dev-team'],
      'high': ['security-team'],
      'medium': ['dev-team'],
      'low': ['monitoring-team']
    };
    this.responseProcedures = new Map();
    this.autoResponseRules = [];
  }

  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  addAutoResponseRule(condition, action) {
    this.autoResponseRules.push({ condition, action });
  }

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª–µ—Ä—Ç–∞
  async processAlert(alert) {
    // –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–∞
    alert.priority = this.classifyAlert(alert);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    for (const rule of this.autoResponseRules) {
      if (rule.condition(alert)) {
        await rule.action(alert);
        return; // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
      }
    }
    
    // –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –æ—á–µ—Ä–µ–¥—å –Ω–∞ —Ä—É—á–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
    this.alertQueue.push(alert);
    
    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã
    await this.notifyResponseTeam(alert);
  }

  // –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–∞
  classifyAlert(alert) {
    // –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if (alert.type === 'brute_force' || alert.type === 'sql_injection') {
      return 'critical';
    } else if (alert.type === 'suspicious_login') {
      return 'high';
    } else if (alert.type === 'slow_request') {
      return 'medium';
    } else {
      return 'low';
    }
  }

  // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  async notifyResponseTeam(alert) {
    const teams = this.responseTeams[alert.priority] || ['monitoring-team'];
    
    for (const team of teams) {
      await this.sendNotification(team, alert);
    }
  }

  // –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  async sendNotification(team, alert) {
    // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Slack, email, etc.
    console.log(`Sending alert to ${team}:`, alert);
    
    // –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Slack
    if (team === 'security-team') {
      await this.sendToSlack('#security-alerts', {
        text: `üö® *${alert.priority.toUpperCase()} Security Alert*`,
        blocks: [
          {
            type: 'section',
            text: {
              type: 'mrkdwn',
              text: `*Type:* ${alert.type}\n*Description:* ${alert.description}\n*IP:* ${alert.ip || 'N/A'}`
            }
          }
        ]
      });
    }
  }

  // –ü—Ä–∏–º–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  setupAutoResponses() {
    // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ brute force
    this.addAutoResponseRule(
      (alert) => alert.type === 'brute_force' && alert.attempts > 10,
      async (alert) => {
        console.log(`Blocking IP ${alert.ip} due to brute force attack`);
        await this.blockIP(alert.ip);
        await this.sendNotification('security-team', {
          ...alert,
          action: 'IP blocked automatically'
        });
      }
    );
    
    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ DoS
    this.addAutoResponseRule(
      (alert) => alert.type === 'high_request_rate' && alert.count > 1000,
      async (alert) => {
        console.log(`Rate limiting for IP ${alert.ip} due to high request rate`);
        await this.applyRateLimit(alert.ip);
      }
    );
  }

  // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP (–∑–∞–≥–ª—É—à–∫–∞)
  async blockIP(ip) {
    // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –±–ª–æ–∫-–ª–∏—Å—Ç, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ firewall
    console.log(`IP ${ip} blocked`);
  }

  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–∑–∞–≥–ª—É—à–∫–∞)
  async applyRateLimit(ip) {
    // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ rate limiting
    console.log(`Rate limit applied for IP ${ip}`);
  }

  // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Slack (–∑–∞–≥–ª—É—à–∫–∞)
  async sendToSlack(channel, message) {
    // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Slack API
    console.log(`Slack message to ${channel}:`, message);
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
const incidentResponse = new IncidentResponseSystem();
incidentResponse.setupAutoResponses();

// –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–ª–µ—Ä—Ç–∞
const sampleAlert = {
  type: 'brute_force',
  description: 'Multiple failed login attempts',
  ip: '192.168.1.100',
  attempts: 15,
  timestamp: new Date().toISOString()
};

incidentResponse.processAlert(sampleAlert);
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É
- –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–∏—Å—Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –±—é–¥–∂–µ—Ç–∞

### 2. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º

### 4. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä
- –ü–ª–∞–Ω —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏

### –û–±–ª–∞—á–Ω—ã–µ —Å—Ä–µ–¥—ã
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±–ª–∞—á–Ω—ã—Ö SIEM-—Å–∏—Å—Ç–µ–º
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –º—É–ª—å—Ç–∏–æ–±–ª–∞—á–Ω–æ–π —Å—Ä–µ–¥–µ

### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏

### –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ API-–∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –º–æ–±–∏–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ó–∞—â–∏—Ç–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö API-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –°–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–æ–≥—É—Ç –∑–∞–º–µ–¥–ª—è—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –†–µ—à–µ–Ω–∏–µ: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### 2. –û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–≥–æ–≤ –∏ —Å–æ–±—ã—Ç–∏–π
- –†–µ—à–µ–Ω–∏–µ: —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–≥—Ä–µ–≥–∞—Ü–∏—è

### 3. –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
- –°–∏—Å—Ç–µ–º—ã –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤
- –†–µ—à–µ–Ω–∏–µ: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤, –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µÊàêÁÜü–Ω—ã—Ö SIEM-—Å–∏—Å—Ç–µ–º
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä —É–≥—Ä–æ–∑
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ä–µ—à–µ–Ω–∏–π

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ç–∏–ø–æ–≤—ã–µ —É–≥—Ä–æ–∑—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –°–æ–∑–¥–∞–Ω–∏–µ runbook'–æ–≤ –¥–ª—è —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### 4. –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π –æ –Ω–æ–≤—ã—Ö —É–≥—Ä–æ–∑–∞—Ö
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### 1. –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä
- –ê–Ω–∞–ª–∏–∑ –Ω–æ–≤—ã—Ö —É–≥—Ä–æ–∑ –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–æ–≤

### 2. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –í–µ–¥–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ü–µ–¥—É—Ä
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤—ã–º–∏ —É–≥—Ä–æ–∑–∞–º–∏
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã

- [[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏]]
- [[–°–∏—Å—Ç–µ–º—ã-–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è-—É–≥—Ä–æ–∑]]
- [[–ê–Ω–∞–ª–∏–∑-–ª–æ–≥–æ–≤]]
- [[–†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–Ω–∞-–∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã]]

> [!tip] –°–æ–≤–µ—Ç
> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏ —Ä—É—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è —É–≥—Ä–æ–∑.

> [!warning] –í–∞–∂–Ω–æ
> –ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.