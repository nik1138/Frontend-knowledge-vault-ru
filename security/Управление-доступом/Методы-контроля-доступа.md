---
aliases: ["Методы контроля доступа", "Access Control Methods", "Контроль доступа"]
tags: [security, access-control, authorization]
created: 2025-11-18
updated: 2025-11-18
---

# Методы контроля доступа

Контроль доступа - это система правил и механизмов, определяющих, кто может получить доступ к каким ресурсам и какие действия может выполнять с этими ресурсами. Эффективный контроль доступа является фундаментальным элементом безопасности информационных систем.

## Введение

Контроль доступа обеспечивает защиту ресурсов системы от несанкционированного доступа. Он включает в себя аутентификацию (проверку личности), авторизацию (определение прав доступа) и аудит (журналирование действий).

## Основные концепции

### Основные элементы контроля доступа

- **Субъекты** - пользователи или процессы, запрашивающие доступ
- **Объекты** - ресурсы, к которым запрашивается доступ
- **Правила доступа** - политики, определяющие права доступа
- **Механизмы контроля** - инструменты реализации политик

### Цели контроля доступа

- Защита конфиденциальности данных
- Обеспечение целостности информации
- Гарантия доступности ресурсов
- Соблюдение принципа минимальных привилегий

## Типы контроля доступа

### DAC (Discretionary Access Control)

Дискреционный контроль доступа:

- Владелец ресурса определяет права доступа
- Основан на идентичности субъекта
- Гибкость в настройке прав
- Пример: файловые системы Unix/Linux

```bash
# Пример DAC в Unix
chmod 755 myfile.txt  # rwxr-xr-x
chown user:group myfile.txt
```

### MAC (Mandatory Access Control)

Обязательный контроль доступа:

- Права определяются системой
- Основан на метках безопасности
- Высокий уровень безопасности
- Пример: SELinux, AppArmor

```bash
# Пример меток безопасности в SELinux
ls -Z /etc/passwd
# system_u:object_r:etc_t:s0 /etc/passwd
```

### RBAC (Role-Based Access Control)

Контроль доступа на основе ролей:

- Права назначаются ролям, а не пользователям
- Пользователи получают права через роли
- Простота управления
- Широкое распространение в корпоративных системах

### ABAC (Attribute-Based Access Control)

Контроль доступа на основе атрибутов:

- Решения принимаются на основе атрибутов
- Гибкость в политике доступа
- Поддержка сложных правил
- [[Атрибутное-управление-доступом]]

## Архитектура контроля доступа

### Модель Белла-ЛаПадулы

Для обеспечения конфиденциальности:

- "No read up" - нельзя читать выше своего уровня
- "No write down" - нельзя писать ниже своего уровня
- Используется в военных и правительственных системах

### Модель Биба

Для обеспечения целостности:

- "No read down" - нельзя читать ниже своего уровня
- "No write up" - нельзя писать выше своего уровня
- Защита от несанкционированного изменения

### Модель Кларка-Вилсон

Для обеспечения целостности коммерческих данных:

- Ограничение транзакций
- Аудит изменений
- Разделение ответственности

## Реализация контроля доступа

### Списки управления доступом (ACL)

```javascript
// Пример ACL в приложении
const acl = {
  resource: 'document123',
  permissions: [
    { user: 'alice', permissions: ['read', 'write'] },
    { user: 'bob', permissions: ['read'] },
    { role: 'admin', permissions: ['read', 'write', 'delete'] }
  ]
};
```

### Матрица доступа

Таблица соответствия пользователей и прав:

| Пользователь | Файл1 | Файл2 | Файл3 |
|--------------|-------|-------|-------|
| Alice        | R, W  | R     | -     |
| Bob          | R     | R, W  | R, W  |
| Charlie      | -     | -     | R, W  |

### Ролевая модель

```javascript
// Пример RBAC реализации
const roles = {
  admin: ['read', 'write', 'delete', 'manage_users'],
  editor: ['read', 'write'],
  viewer: ['read']
};

const userRoles = {
  alice: ['admin'],
  bob: ['editor'],
  charlie: ['viewer']
};
```

## Современные подходы

### Zero Trust Architecture

"Ноль доверия":

- Проверка всех запросов
- Минимальные привилегии
- Постоянное подтверждение подлинности
- [[Потоки-авторизации]] на каждом шаге

### Context-Based Access Control

Контекстно-ориентированный контроль:

- Учет времени, местоположения, устройства
- Динамическая оценка рисков
- Адаптивные политики доступа

### Risk-Based Access Control

Контроль на основе рисков:

- Оценка уровня риска запроса
- Адаптация требований к аутентификации
- Баланс безопасности и удобства

## Технологии и стандарты

### OAuth 2.0

Протокол делегирования авторизации:

- Разделение прав доступа
- Временные токены доступа
- Поддержка различных типов клиентов
- [[Потоки-авторизации]]

### OpenID Connect

Протокол аутентификации поверх OAuth 2.0:

- Проверка личности пользователя
- Информация о пользователе в JWT
- Совместимость с OAuth 2.0
- [[Управление-доступом]] в распределенных системах

### SAML (Security Assertion Markup Language)

Стандарт для веб-авторизации:

- Единый вход (SSO)
- Обмен утверждениями безопасности
- Интеграция с корпоративными системами
- [[Управление-доступом]] в корпоративной среде

### JWT (JSON Web Tokens)

Токены для передачи утверждений:

- Самодостаточные токены
- Поддержка аудиторизации
- Подпись и шифрование
- [[Потоки-авторизации]] в распределенных системах

## Практическая реализация

### Пример на Node.js

```javascript
// Пример RBAC системы
class AccessControl {
  constructor() {
    this.roles = new Map();
    this.permissions = new Map();
    this.userRoles = new Map();
  }

  addRole(role, permissions) {
    this.roles.set(role, permissions);
  }

  assignRole(user, role) {
    if (!this.userRoles.has(user)) {
      this.userRoles.set(user, []);
    }
    this.userRoles.get(user).push(role);
  }

  hasPermission(user, resource, action) {
    const userRoles = this.userRoles.get(user) || [];
    
    for (const role of userRoles) {
      const rolePermissions = this.roles.get(role) || [];
      for (const perm of rolePermissions) {
        if (perm.resource === resource && perm.actions.includes(action)) {
          return true;
        }
      }
    }
    return false;
  }
}

// Использование
const ac = new AccessControl();

// Определение ролей
ac.addRole('admin', [
  { resource: 'users', actions: ['create', 'read', 'update', 'delete'] },
  { resource: 'documents', actions: ['create', 'read', 'update', 'delete'] }
]);

ac.addRole('editor', [
  { resource: 'documents', actions: ['create', 'read', 'update'] }
]);

ac.addRole('viewer', [
  { resource: 'documents', actions: ['read'] }
]);

// Назначение ролей пользователям
ac.assignRole('alice', 'admin');
ac.assignRole('bob', 'editor');
ac.assignRole('charlie', 'viewer');

// Проверка прав
console.log(ac.hasPermission('alice', 'documents', 'delete')); // true
console.log(ac.hasPermission('bob', 'documents', 'delete'));   // false
```

### Пример с использованием политик

```javascript
// Система на основе политик (Policy-Based Access Control)
const policyEngine = {
  evaluate: (user, resource, action, context) => {
    // Пример политики: доступ только в рабочее время
    const now = new Date();
    const hour = now.getHours();
    if (hour < 9 || hour > 17) {
      return false; // вне рабочего времени
    }
    
    // Пример политики: администраторы имеют полный доступ
    if (user.roles.includes('admin')) {
      return true;
    }
    
    // Пример политики: доступ к финансовым документам
    if (resource.category === 'financial' && !user.departments.includes('finance')) {
      return false;
    }
    
    // Проверка обычных прав
    return user.permissions.some(perm => 
      perm.resource === resource.type && perm.actions.includes(action)
    );
  }
};
```

## Лучшие практики

### Принцип минимальных привилегий

- Предоставление только необходимых прав
- Регулярный пересмотр прав доступа
- Временные права для специальных задач
- [[Управление-доступом]] на основе ролей

### Разделение обязанностей

- Разделение критических функций
- Требование нескольких одобрений
- Аудит критических операций
- [[Потоки-авторизации]] с несколькими уровнями

### Регулярный аудит

- Проверка соответствия политикам
- Анализ аномального поведения
- [[Анализ-логов]] доступа
- Интеграция с [[Сигнализация-безопасности]]

### Обновление и поддержка

- Регулярное обновление политик
- Обучение пользователей
- Тестирование систем контроля
- [[Инструменты-мониторинга-безопасности]]

## Безопасность реализации

### Защита от обхода

- Проверка на всех уровнях
- Защита от привилегий escalation
- Контроль за внутренними вызовами
- [[Предотвращение-инъекций]] в системах управления

### Аудит и логирование

- Журналирование всех попыток доступа
- [[Анализ-логов]] для выявления аномалий
- Хранение логов безопасности
- Интеграция с системами [[Сигнализация-безопасности]]

### Обработка ошибок

- Безопасные значения по умолчанию
- Не раскрывать информацию о системе
- Логирование ошибок безопасности
- [[Анализ-логов]] для улучшения системы

## Современные вызовы

### Облачные среды

- Контроль доступа в гибридных средах
- Совместимость с облачными провайдерами
- Управление доступом к API
- [[Управление-доступом]] в мультиоблачной среде

### Микросервисы

- Контроль доступа между сервисами
- Управление идентичностью сервисов
- Централизованные системы аутентификации
- [[Потоки-авторизации]] в распределенных системах

### IoT и мобильные устройства

- Управление доступом устройств
- Ограничение привилегий приложений
- Аутентификация устройств
- [[Управление-доступом]] в распределенных сетях

> [!tip] Совет
> Регулярно пересматривайте и обновляйте политики доступа в соответствии с изменениями в бизнесе и угрозами безопасности.

> [!warning] Важно
> Всегда используйте принцип "запрещено всё, что явно не разрешено" для критических систем.

## Заключение

Эффективный контроль доступа требует комплексного подхода, включающего правильный выбор модели, тщательную реализацию и постоянный мониторинг. Современные системы должны учитывать как традиционные, так и новые вызовы безопасности.