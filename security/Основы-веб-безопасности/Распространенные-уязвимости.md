---
aliases: ["Уязвимости", "Частые уязвимости", "OWASP Top 10"]
tags: [security, vulnerabilities, web-security, owasp]
---

# Распространенные уязвимости веб-приложений

## Введение

Распространенные уязвимости веб-приложений — это типичные ошибки в реализации безопасности, которые могут быть использованы злоумышленниками для получения несанкционированного доступа, раскрытия данных или нарушения работы приложения. Понимание этих уязвимостей критически важно для разработчиков и специалистов по безопасности.

## OWASP Top 10

OWASP (Open Web Application Security Project) публикует список из 10 наиболее критичных уязвимостей веб-приложений. Ниже представлены основные категории:

### 1. Уязвимости инъекций (Injection)

Инъекции происходят, когда не доверенные данные отправляются в интерпретатор в качестве команды или запроса.

#### SQL-инъекции

```javascript
// Плохо: уязвимость к SQL-инъекции
const query = `SELECT * FROM users WHERE id = ${userId}`;
db.query(query);

// Хорошо: использование подготовленных выражений
const query = 'SELECT * FROM users WHERE id = ?';
db.query(query, [userId]);
```

#### Command-инъекции

```javascript
// Плохо: уязвимость к command-инъекции
const { exec } = require('child_process');
exec(`ls ${userInput}`, (error, stdout) => {
  // ...
});

// Хорошо: валидация и экранирование
const path = require('path');
const safePath = path.join('/safe/directory', path.basename(userInput));
exec(`ls ${safePath}`, (error, stdout) => {
  // ...
});
```

### 2. Нарушение контроля доступа (Broken Authentication)

Слабая реализация аутентификации и сессионного управления может позволить злоумышленнику получить доступ к учетным записям других пользователей.

```javascript
// Плохо: неадекватная проверка сессии
app.get('/admin', (req, res) => {
  if (req.session.userId) { // Только проверка сессии
    res.send(adminPanel);
  }
});

// Хорошо: проверка прав доступа
app.get('/admin', (req, res) => {
  if (req.session.userId && req.session.role === 'admin') {
    res.send(adminPanel);
  } else {
    res.status(403).send('Forbidden');
  }
});
```

### 3. Уязвимости межсайтовый скриптинг (XSS)

XSS-уязвимости позволяют злоумышленникам внедрять вредоносный скрипт в веб-страницы, просматриваемые другими пользователями.

```javascript
// Плохо: уязвимость к XSS
app.get('/search', (req, res) => {
  const query = req.query.q;
  res.send(`<h2>Результаты поиска для: ${query}</h2>`);
});

// Хорошо: экранирование вывода
const escape = require('lodash/escape');
app.get('/search', (req, res) => {
  const query = escape(req.query.q);
  res.send(`<h2>Результаты поиска для: ${query}</h2>`);
});
```

### 4. Уязвимости CSRF (Cross-Site Request Forgery)

CSRF-атаки заставляют пользователя выполнить нежелательные действия в приложении, в котором он аутентифицирован.

```javascript
// Плохо: отсутствие защиты от CSRF
app.post('/transfer', (req, res) => {
  transferMoney(req.body.from, req.body.to, req.body.amount);
  res.send('Transfer completed');
});

// Хорошо: использование CSRF-токенов
const csrf = require('csurf');
const csrfProtection = csrf({ cookie: true });

app.post('/transfer', csrfProtection, (req, res) => {
  transferMoney(req.body.from, req.body.to, req.body.amount);
  res.send('Transfer completed');
});
```

### 5. Уязвимости небезопасной десериализации

Небезопасная десериализация может привести к удаленному выполнению кода, восстановлению сеанса, отказу в обслуживании и другим проблемам.

```javascript
// Плохо: десериализация непроверенных данных
app.post('/data', (req, res) => {
  const data = JSON.parse(req.body.serializedData); // Уязвимо!
  // ...
});

// Хорошо: валидация и безопасная десериализация
const safeParse = require('some-safe-parser');
app.post('/data', (req, res) => {
  const data = safeParse(req.body.serializedData);
  // ...
});
```

### 6. Использование компонентов с известными уязвимостями

Использование библиотек, фреймворков и других компонентов с известными уязвимостями может создать риски безопасности.

> [!warning] Пример уязвимости
> Использование jQuery версии 1.x или 2.x в продакшене, где известны XSS-уязвимости

### 7. Недостаточная защита данных

Приложения и API часто не защищают чувствительные данные, такие как финансовые, медицинские и персональные данные.

```javascript
// Плохо: хранение паролей в открытом виде
const user = {
  username: 'john',
  password: 'plaintext_password' // Очень плохо!
};

// Хорошо: хеширование паролей
const bcrypt = require('bcrypt');
const hashedPassword = await bcrypt.hash(password, 12);
```

### 8. Неправильная настройка безопасности

Неправильная конфигурация безопасности может предоставить злоумышленникам доступ к системе и данным.

```javascript
// Плохо: отладка в продакшене
app.use(morgan('dev')); // Показывает детали запросов
app.get('/debug', (req, res) => {
  res.json({ dbConfig: process.env.DB_CONFIG }); // Утечка конфиденциальных данных
});

// Хорошо: безопасная конфигурация
if (process.env.NODE_ENV !== 'production') {
  app.use(morgan('dev'));
}
```

### 9. Уязвимости в компонентах с открытым исходным кодом

Использование устаревших или уязвимых библиотек с открытым исходным кодом.

```bash
# Проверка уязвимостей в npm-пакетах
npm audit
npm audit fix
```

### 10. Недостаточная логика доступа на стороне сервера

Недостаточная проверка разрешений на стороне сервера может позволить злоумышленникам получить доступ к защищенным функциям.

## Другие распространенные уязвимости

### Clickjacking

Атака, при которой пользователь обманом заставляется кликнуть по элементу, который не виден или замаскирован.

```javascript
// Защита с помощью X-Frame-Options
app.use((req, res, next) => {
  res.setHeader('X-Frame-Options', 'DENY');
  next();
});
```

### MIME-уязвимости

Атаки, связанные с неправильной обработкой MIME-типов.

```javascript
// Защита с помощью заголовка X-Content-Type-Options
app.use((req, res, next) => {
  res.setHeader('X-Content-Type-Options', 'nosniff');
  next();
});
```

### Отказ в обслуживании (DoS)

Атаки, направленные на перегрузку системы и недоступность сервиса для легитимных пользователей.

```javascript
// Ограничение частоты запросов
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 минут
  max: 100 // ограничение 100 запросов на IP
});

app.use(limiter);
```

## Методы обнаружения уязвимостей

### Статический анализ кода

Инструменты для анализа исходного кода на наличие потенциальных уязвимостей:
- ESLint с плагинами безопасности
- SonarQube
- Snyk Code

### Динамическое тестирование

Тестирование работающего приложения с использованием инструментов:
- OWASP ZAP
- Burp Suite
- Nikto

### Анализ зависимостей

Проверка используемых библиотек на наличие известных уязвимостей:
- npm audit
- yarn audit
- Snyk
- Dependabot

## Методы предотвращения уязвимостей

### Валидация и экранирование данных

```javascript
// Пример валидации и экранирования
const validator = require('validator');
const escape = require('lodash/escape');

function sanitizeInput(input) {
  // Валидация
  if (!validator.isEmail(input.email)) {
    throw new Error('Invalid email');
  }
  
  // Экранирование
  return {
    email: validator.escape(input.email),
    name: escape(input.name)
  };
}
```

### Использование безопасных практик программирования

- Использование подготовленных выражений для SQL
- Валидация всех входных данных
- Правильное управление сессиями
- Шифрование конфиденциальных данных

### Регулярные обновления

- Обновление зависимостей
- Патчинг уязвимостей
- Обновление серверного ПО

## Связь с другими аспектами безопасности

Распространенные уязвимости тесно связаны с:
- [[Принципы-безопасности]] — понимание уязвимостей помогает реализовать принципы
- [[Моделирование-угроз]] — уязвимости являются частью анализа угроз
- [[XSS-защита]] — подробное рассмотрение XSS-уязвимостей
- [[CSRF-защита]] — защита от CSRF-атак
- [[Clickjacking-защита]] — защита от clickjacking-атак
- [[Тестирование-безопасности]] — методы обнаружения уязвимостей

## Заключение

Понимание распространенных уязвимостей и методов их предотвращения является ключевым аспектом разработки безопасных веб-приложений. Регулярное обучение, использование автоматизированных инструментов и следование лучшим практикам помогут минимизировать риски безопасности.

## Дополнительные ресурсы

- OWASP Top 10
- CWE (Common Weakness Enumeration)
- SANS Top 25
- CVE (Common Vulnerabilities and Exposures)