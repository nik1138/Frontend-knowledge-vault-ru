---
aliases: [Инструменты аудита CSRF, Сканирование CSRF, Тестирование CSRF]
tags: [security, csrf, testing, web-security, tools]
---

# Инструменты-аудита

## Обзор

Инструменты аудита CSRF - это программные решения, предназначенные для автоматического обнаружения уязвимостей подделки межсайтовых запросов в веб-приложениях. Эти инструменты помогают разработчикам и специалистам по безопасности находить потенциальные CSRF-уязвимости на ранних стадиях разработки.

## Классификация инструментов аудита CSRF

### 1. Инструменты динамического анализа (DAST)
- Тестируют работающее веб-приложение
- Имитируют атаки и проверяют реакцию системы
- Примеры: OWASP ZAP, Burp Suite, Acunetix

### 2. Инструменты статического анализа кода (SAST)
- Анализируют исходный код на наличие потенциальных уязвимостей
- Работают на этапе разработки
- Примеры: SonarQube, Checkmarx, ESLint с плагинами безопасности

### 3. Инструменты анализа зависимостей
- Проверяют используемые библиотеки и фреймворки на наличие известных уязвимостей
- Примеры: npm audit, Snyk, Dependabot

## Популярные инструменты аудита CSRF

### OWASP ZAP (Zed Attack Proxy)
- Бесплатный инструмент с открытым исходным кодом
- Автоматическое сканирование на CSRF-уязвимости
- Возможность ручного тестирования
- Интеграция с CI/CD

**Преимущества:**
- Бесплатный и с открытым исходным кодом
- Постоянное обновление базы уязвимостей
- Гибкие возможности настройки сканирования

**Недостатки:**
- Может требовать времени для настройки
- Возможны ложные срабатывания

### Burp Suite
- Коммерческий инструмент с мощными возможностями
- Расширенные возможности для ручного тестирования
- Сканер уязвимостей, включая CSRF
- Возможность создания пользовательских правил проверки

**Преимущества:**
- Мощные возможности ручного тестирования
- Точное обнаружение уязвимостей
- Профессиональная поддержка

**Недостатки:**
- Высокая стоимость
- Требует обучения для эффективного использования

###.csrf-protection-analyzer
- Инструмент для анализа защиты от CSRF в веб-приложениях
- Проверяет наличие и правильность реализации CSRF-токенов
- Анализирует заголовки и параметры запросов

## Настройка инструментов аудита

### Настройка OWASP ZAP для CSRF-аудита
1. Установка скан-политики, ориентированной на CSRF
2. Настройка контекста приложения
3. Конфигурация аутентификации для тестирования защищенных страниц
4. Настройка сканирования для проверки всех HTTP-методов

### Настройка Burp Suite для CSRF-тестирования
1. Конфигурация прокси для перехвата запросов
2. Настройка Intruder для тестирования CSRF-токенов
3. Создание пользовательских payloads для тестирования
4. Настройка сравнения ответов для обнаружения успешных атак

## Интеграция в процесс разработки

### Включение в CI/CD
- Автоматическое сканирование при каждом коммите
- Блокировка сборки при обнаружении критических уязвимостей
- Генерация отчетов о безопасности

### Интеграция с IDE
- Мгновенное обнаружение потенциальных уязвимостей
- Подсветка опасных паттернов кода
- Предложения по безопасной реализации

## Методы тестирования CSRF

### 1. Тестирование отсутствия токенов
- Проверка, что изменяющие запросы требуют CSRF-токенов
- Отправка запросов без токенов для проверки защиты

### 2. Тестирование предсказуемых токенов
- Анализ генерации токенов на предсказуемость
- Проверка длины и криптографической стойкости токенов

### 3. Тестирование повторного использования токенов
- Проверка, что токены не могут быть переиспользованы
- Тестирование сценариев с истекшими токенами

### 4. Тестирование атрибута SameSite
- Проверка правильности установки SameSite атрибутов
- Тестирование поведения при разных значениях (Strict, Lax, None)

## Автоматизированные тесты CSRF

### Пример теста с использованием Selenium
```python
from selenium import webdriver
from selenium.webdriver.common.by import By

def test_csrf_protection():
    driver = webdriver.Chrome()
    # Авторизация пользователя
    driver.get("https://example.com/login")
    # ... код аутентификации ...
    
    # Попытка выполнить действие без CSRF-токена
    driver.execute_script("""
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/transfer', false);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send('amount=100&to=attacker');
        return xhr.responseText;
    """)
    
    # Проверка, что запрос был отклонен
    assert "CSRF token required" in driver.page_source
```

### Пример теста с использованием OWASP ZAP API
```python
import zapv2
from pprint import pprint

# Подключение к ZAP
zap = zapv2.ZAPv2(proxies={'http': 'http://127.0.0.1:8080'})

# Сканирование конкретного URL на CSRF
scan_id = zap.ascan.scan(target='https://example.com/transfer', method='POST')

# Ожидание завершения сканирования
while int(zap.ascan.status(scan_id)) < 100:
    time.sleep(5)

# Получение результатов
alerts = zap.core.alerts(baseurl='https://example.com')
pprint(alerts)
```

## Ограничения инструментов аудита

### Ложные срабатывания
- Инструменты могут отмечать безопасный код как уязвимый
- Требуется ручная проверка результатов

### Пропуск уязвимостей
- Не все CSRF-уязвимости могут быть обнаружены автоматически
- Требуется комбинация автоматических и ручных методов тестирования

### Контекстные ограничения
- Инструменты могут не учитывать специфику архитектуры приложения
- Некоторые уязвимости проявляются только в определенных условиях

## Лучшие практики использования инструментов

1. **Комбинирование методов** - используйте несколько типов инструментов
2. **Регулярное обновление** - поддерживайте инструменты в актуальном состоянии
3. **Настройка под проект** - адаптируйте правила под специфику приложения
4. **Обучение команды** - обучите разработчиков интерпретации результатов
5. **Документирование** - ведите учет найденных и исправленных уязвимостей

## Связанные темы

- [[Тестирование-безопасности]]
- [[Методы-защиты-от-CSRF]]
- [[Типы-CSRF-атак]]
- [[Оценка-угроз]]

> [!tip] Совет
> Используйте комбинацию автоматических инструментов и ручного тестирования для наиболее полного покрытия потенциальных CSRF-уязвимостей.

> [!warning] Важно
> Автоматические инструменты не заменяют ручное тестирование и безопасное программирование, они лишь помогают в обнаружении потенциальных проблем.