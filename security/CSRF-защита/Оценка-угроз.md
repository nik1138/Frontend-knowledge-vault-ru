---
aliases: [Анализ CSRF угроз, Оценка рисков CSRF, Угрозы CSRF]
tags: [security, csrf, risk-assessment, web-security]
---

# Оценка-угроз

## Обзор

Оценка угроз CSRF (Cross-Site Request Forgery) - это процесс анализа потенциальных рисков, связанных с атаками подделки межсайтовых запросов, и определения вероятности и воздействия таких атак на веб-приложение. Эта оценка помогает определить приоритеты в реализации мер защиты.

## Модель угроз CSRF

### 1. Атакующий (Adversary)
- Имеет знания о структуре веб-приложения
- Может создать вредоносную страницу или отправить ссылку жертве
- Может использовать знания о доступных функциях приложения

### 2. Вектор атаки (Attack Vector)
- Внедрение запросов через вредоносные веб-сайты
- Использование электронной почты или мессенджеров для отправки ссылок
- Использование социальной инженерии для привлечения жертв

### 3. Воздействие (Impact)
- Выполнение нежелательных действий от имени пользователя
- Изменение настроек аккаунта
- Выполнение финансовых транзакций
- Удаление данных

## Категории угроз CSRF

### 1. Угрозы аутентификации
- Изменение пароля пользователя
- Добавление новых методов аутентификации
- Сброс учетных данных

### 2. Угрозы авторизации
- Изменение прав доступа
- Назначение административных ролей
- Добавление/удаление разрешений

### 3. Угрозы данных
- Изменение личной информации
- Перевод средств или ценностей
- Удаление или модификация документов

### 4. Угрозы функциональности
- Отправка сообщений от имени пользователя
- Изменение настроек приложения
- Создание/удаление контента

## Методы оценки угроз

### 1. Структурный анализ
- Идентификация всех точек входа, изменяющих состояние
- Классификация запросов по типам (GET, POST, PUT, DELETE)
- Определение критических функций приложения

### 2. Анализ потоков данных
- Отслеживание передачи данных между компонентами
- Определение точек, где могут быть внедрены вредоносные запросы
- Анализ механизмов аутентификации и авторизации

### 3. Оценка вероятности атаки
- Оценка доступности функций для внешних сайтов
- Анализ использования сессионных cookie
- Проверка наличия других векторов атаки

## Матрица угроз CSRF

| Категория | Вероятность | Воздействие | Риск | Рекомендации |
|-----------|-------------|-------------|------|--------------|
| Финансовые операции | Высокая | Критическое | Критический | Обязательная защита, многоуровневый контроль |
| Изменение профиля | Средняя | Высокое | Высокий | Обязательная защита |
| Отправка сообщений | Средняя | Среднее | Средний | Рекомендуемая защита |
| Настройки интерфейса | Низкая | Низкое | Низкий | Опциональная защита |

## Факторы, влияющие на уязвимость

### 1. Архитектурные факторы
- Использование сессионных cookie для аутентификации
- Отсутствие проверки источника запросов
- Неправильное использование HTTP-методов

### 2. Поведенческие факторы
- Продолжительность сессии пользователя
- Одновременное использование других сайтов
- Уровень осведомленности пользователя о безопасности

### 3. Технические факторы
- Поддержка современных браузерных функций
- Наличие других уязвимостей (XSS)
- Использование CORS без должной проверки

## Сценарии атак CSRF

### 1. Атака на банковский перевод
- Злоумышленник создает страницу с автоматическим запросом перевода
- Пользователь заходит на страницу, когда залогинен в банке
- Деньги переводятся без ведома пользователя

### 2. Изменение email в профиле
- Злоумышленник изменяет email пользователя
- Перенаправляет восстановление пароля на свой адрес
- Получает доступ к аккаунту

### 3. Подписка на услуги
- Злоумышленник подписывает пользователя на платные услуги
- Пользователь получает счета за неподписанные услуги

## Рекомендации по снижению угроз

### 1. Технические меры
- Внедрение CSRF-токенов для всех изменяющих запросов
- Использование SameSite атрибута для cookie
- Проверка HTTP Referer заголовка (с осторожностью)

### 2. Организационные меры
- Обучение разработчиков принципам безопасности
- Регулярные аудиты безопасности
- Внедрение безопасного SDLC

### 3. Пользовательские меры
- Обучение пользователей безопасному поведению
- Использование разных браузеров для разных задач
- Регулярный выход из учетных записей

## Связанные темы

- [[Типы-CSRF-атак]]
- [[Методы-защиты-от-CSRF]]
- [[Анти-CSRF-токены]]
- [[SameSite-куки]]

> [!tip] Совет
> Регулярно пересматривайте оценку угроз CSRF при добавлении новых функций в приложение.

> [!warning] Важно
> Даже кажущиеся безопасными GET-запросы могут быть уязвимы к CSRF при наличии побочных эффектов.