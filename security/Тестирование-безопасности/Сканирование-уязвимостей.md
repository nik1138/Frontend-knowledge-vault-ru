---
aliases: ["Vulnerability Scanning", "Security Scanning"]
tags: [security, testing, vulnerability-assessment, penetration-testing, #security-testing, #vulnerability-management, #cybersecurity]
---

# Сканирование уязвимостей

## Введение в сканирование уязвимостей

Сканирование уязвимостей - это процесс систематического поиска и анализа уязвимостей в системах, приложениях и сетевой инфраструктуре. Это важная часть стратегии обеспечения безопасности, направленная на выявление потенциальных точек атак до того, как они могут быть использованы злоумышленниками.

Сканирование уязвимостей позволяет организациям:

- Идентифицировать слабые места в системах безопасности
- Оценить уровень риска, связанного с эксплуатацией уязвимостей
- Принять обоснованные решения о приоритетах устранения уязвимостей
- Поддерживать актуальный уровень безопасности в соответствии с требованиями нормативных актов

> [!info] 
> Сканирование уязвимостей - это проактивный подход к обеспечению безопасности, который помогает выявлять потенциальные проблемы до того, как они могут быть использованы вредоносными актёрами.

## Типы сканирования уязвимостей

Существует несколько основных типов сканирования уязвимостей, каждый из которых имеет свои особенности и области применения:

### Сканирование сетевой инфраструктуры
- Сканирование IP-адресов и диапазонов для выявления активных хостов
- Определение открытых портов и работающих служб
- Идентификация операционных систем и версий программного обеспечения
- Обнаружение конфигурационных уязвимостей сетевых устройств

### Сканирование веб-приложений
- Анализ веб-интерфейсов на наличие уязвимостей
- Проверка на типичные уязвимости (XSS, SQL-инъекции, CSRF и т.д.)
- Оценка конфигурации безопасности веб-серверов
- Тестирование параметров аутентификации и авторизации

### Сканирование операционных систем
- Проверка на наличие известных уязвимостей в ОС
- Анализ конфигурации безопасности
- Проверка наличия и актуальности патчей безопасности
- Оценка настроек файловой системы и разрешений

### Сканирование баз данных
- Идентификация уязвимостей в системах управления базами данных
- Проверка конфигурации безопасности БД
- Анализ настроек аутентификации и разрешений
- Поиск чувствительных данных, хранящихся в небезопасной форме

### Сканирование мобильных приложений
- Анализ конфигурации безопасности приложений
- Проверка на утечки конфиденциальных данных
- Оценка шифрования и хранения данных
- Тестирование взаимодействия с API и сетевыми ресурсами

> [!tip]
> Комбинирование различных типов сканирования позволяет получить более полное представление о состоянии безопасности системы и выявить уязвимости на разных уровнях архитектуры.

## Автоматизированные инструменты

Автоматизированные инструменты сканирования уязвимостей значительно ускоряют процесс обнаружения потенциальных проблем безопасности. Вот основные категории и примеры таких инструментов:

### Сканеры уязвимостей сетевой инфраструктуры
- **Nessus** - один из самых популярных коммерческих сканеров, обладающий обширной базой уязвимостей
- **OpenVAS** - открытый фреймворк для оценки уязвимостей с богатыми возможностями
- **Nmap** - мощный инструмент для сканирования портов и определения ОС, часто используется в сочетании с NSE (Nmap Scripting Engine)
- **Nikto** - веб-сканер, специализирующийся на выявлении уязвимостей веб-серверов и приложений

### Сканеры веб-приложений
- **OWASP ZAP** - бесплатный инструмент от OWASP для автоматического тестирования веб-приложений на уязвимости
- **Burp Suite** - комплексный фреймворк для тестирования безопасности веб-приложений, включающий автоматизированные и ручные возможности
- **Acunetix** - коммерческий сканер веб-уязвимостей с высокой точностью обнаружения
- **AppScan** - решение IBM для автоматизированного тестирования безопасности веб-приложений

### Сканеры исходного кода (SAST)
- **SonarQube** - платформа для непрерывного анализа качества кода, включая обнаружение уязвимостей
- **Checkmarx** - статический анализатор безопасности для выявления уязвимостей в исходном коде
- **Fortify SCA** - решение Micro Focus для статического анализа безопасности кода
- **ESLint** с плагинами безопасности - для JavaScript/TypeScript проектов

### Сканеры зависимостей (SCA)
- **Snyk** - инструмент для поиска уязвимостей в зависимостях проектов
- **WhiteSource** - автоматизированное решение для управления уязвимостями в открытых исходных кодах
- **Dependency-Check** - инструмент NVD для обнаружения уязвимостей в проектных зависимостях
- **Retire.js** - специализированный сканер для выявления уязвимых JavaScript библиотек

### Сканеры контейнеров
- **Trivy** - простой и надежный сканер уязвимостей для контейнеров и файловых систем
- **Clair** - статический анализатор уязвимостей в слоях контейнеров
- **Anchore** - платформа для анализа безопасности образов контейнеров
- **Docker Bench** - инструмент для аудита безопасности конфигураций Docker

> [!warning]
> Автоматизированные инструменты не заменяют собой экспертизу специалиста по безопасности. Они должны использоваться в сочетании с ручным тестированием для достижения наилучших результатов.

## Ручное тестирование

Ручное тестирование безопасности - это процесс, при котором специалисты по безопасности вручную проверяют системы и приложения на наличие уязвимостей. Этот подход дополняет автоматизированное сканирование и позволяет выявить проблемы, которые могут быть пропущены инструментами.

### Преимущества ручного тестирования
- **Высокая точность** - специалист может оценить контекст и определить, является ли потенциальная уязвимость реальной угрозой
- **Глубокий анализ** - возможность проведения комплексного анализа сложных сценариев атак
- **Креативный подход** - способность мыслить нестандартно и находить неожиданные векторы атак
- **Оценка бизнес-логики** - проверка логических ошибок, которые трудно автоматизировать
- **Подтверждение уязвимостей** - возможность подтвердить или опровергнуть результаты автоматизированных сканеров

### Методы ручного тестирования
- **Проверка аутентификации и авторизации** - анализ схем входа, сброса пароля, привилегий пользователей
- **Тестирование ввода данных** - проверка на SQL-инъекции, XSS, командные инъекции и другие виды инъекций
- **Анализ сессий** - проверка управления сессиями, токенов, cookies
- **Тестирование обработки ошибок** - анализ информации об ошибках, которая может раскрыть внутреннюю структуру
- **Проверка конфигурации безопасности** - анализ настроек серверов, приложений, баз данных

### Инструменты для ручного тестирования
- **Postman/Burp Suite** - для тестирования API и веб-приложений
- **SQLMap** - для тестирования SQL-инъекций
- **DirBuster** - для перебора директорий и файлов
- **Custom scripts** - написанные на Python, Bash или других языках для специфических задач

> [!tip]
> Ручное тестирование особенно эффективно при проверке бизнес-логики приложений, где автоматизированные инструменты не могут понять контекст и логику работы системы.

## Подходы к сканированию

Существует несколько основных подходов к сканированию уязвимостей, каждый из которых имеет свои особенности, преимущества и ограничения:

### Черный ящик (Black Box Testing)
- Тестирование проводится без знания внутренней структуры системы
- Имитирует атаку извне, со стороны злоумышленника
- Наиболее реалистичный сценарий тестирования безопасности
- Применимо к веб-приложениям, сетевым сервисам и другим внешним интерфейсам

### Белый ящик (White Box Testing)
- Тестирование с полным знанием внутренней структуры системы
- Анализ исходного кода, архитектуры и конфигурации
- Позволяет выявить глубокие уязвимости на уровне реализации
- Требует доступа к исходному коду и документации

### Серый ящик (Gray Box Testing)
- Комбинированный подход с частичным знанием внутренней структуры
- Используются некоторые внутренние данные (например, архитектура, схемы БД)
- Баланс между реалистичностью и глубиной анализа
- Эффективен при ограниченном доступе к внутренней информации

### Сканирование без аутентификации
- Тестирование системы как анонимный пользователь
- Проверка уязвимостей, доступных без входа в систему
- Быстрое выявление очевидных проблем безопасности
- Подходит для первичной оценки уровня безопасности

### Сканирование с аутентификацией
- Тестирование с использованием учетных данных пользователя
- Проверка уязвимостей, доступных после аутентификации
- Анализ привилегий и возможностей разных ролей
- Более глубокий анализ безопасности приложения

> [!info]
> Комбинирование разных подходов позволяет получить более полное представление о состоянии безопасности системы и выявить уязвимости на разных уровнях.

## Планирование сканирования

Эффективное планирование сканирования уязвимостей - ключ к успешной программе обеспечения безопасности. Ниже приведены основные аспекты планирования:

### Определение области сканирования
- Идентификация всех систем, приложений и сетевых ресурсов, подлежащих сканированию
- Классификация активов по уровню критичности
- Учет требований нормативных актов и стандартов (PCI DSS, GDPR, HIPAA и др.)
- Определение принадлежности систем (внутренние, внешние, облачные)

### Определение частоты сканирования
- **Ежедневно** - для критических систем и в CI/CD процессах
- **Еженедельно** - для активно разрабатываемых приложений
- **Ежемесячно** - для стабильных производственных систем
- **Квартально** - для менее критичных систем
- **По событиям** - после значительных изменений или инцидентов

### Выбор подходящих инструментов
- Соответствие типу систем (веб-приложения, сетевая инфраструктура, базы данных)
- Совместимость с существующей инфраструктурой
- Возможности интеграции с другими инструментами безопасности
- Учет лицензионных ограничений и бюджета

### Учет времени и ресурсов
- Планирование времени для выполнения сканирования с минимальным влиянием на производительность
- Назначение ответственных лиц за выполнение и анализ результатов
- Обеспечение достаточных вычислительных ресурсов для выполнения сканирования
- Планирование времени на анализ результатов и устранение уязвимостей

### Учет производственных ограничений
- Избегание сканирования в часы пиковой нагрузки
- Согласование с командами эксплуатации
- Учет SLA и времени недоступности
- Подготовка плана действий на случай сбоев

### Документирование процесса
- Создание стандартов и процедур для сканирования
- Учет исторических данных для анализа тенденций
- Поддержание актуальности списка систем для сканирования
- Ведение отчетности о результатах и действиях

> [!warning]
> Неправильное планирование сканирования может привести к пропуску критических уязвимостей или нежелательному влиянию на производственные системы.

## Интерпретация результатов

Интерпретация результатов сканирования уязвимостей - критически важный этап, требующий глубокого понимания контекста системы и потенциальных рисков. Ниже приведены ключевые аспекты этого процесса:

### Классификация результатов
- **Критические уязвимости** - требуют немедленного внимания, потенциально позволяют получить полный контроль над системой
- **Высокие риски** - серьезные уязвимости, которые могут привести к компрометации данных или систем
- **Средние риски** - умеренные уязвимости, которые в сочетании могут привести к серьезным последствиям
- **Низкие риски** - относительно безопасные уязвимости, но требующие внимания в долгосрочной перспективе

### Анализ контекста
- Учет архитектуры системы и расположения уязвимого компонента
- Оценка вероятности эксплуатации уязвимости в реальных условиях
- Анализ существующих компенсирующих контрмер
- Учет бизнес-влияния потенциальной эксплуатации уязвимости

### Проверка достоверности
- Подтверждение уязвимости ручным тестированием
- Проверка на наличие ложных срабатываний
- Анализ версий ПО и патчей для подтверждения уязвимости
- Использование нескольких инструментов для подтверждения результатов

### Оценка влияния
- Оценка потенциального ущерба от эксплуатации уязвимости
- Анализ типа обрабатываемых данных
- Учет соответствия требованиям нормативных актов
- Оценка влияния на репутацию организации

### Документирование
- Подробное описание уязвимости с указанием всех деталей
- Скриншоты, логи и доказательства эксплуатации (если возможно)
- Рекомендации по устранению
- Ссылки на соответствующие CVE и источники

> [!tip]
> Всегда проводите дополнительную проверку результатов сканирования, особенно для критических уязвимостей, чтобы избежать ложных срабатываний и обеспечить точную оценку рисков.

## Ложные срабатывания

Ложные срабатывания (false positives) - это результаты сканирования, которые ошибочно указывают на наличие уязвимости, хотя на самом деле она отсутствует. Это одна из основных проблем автоматизированных инструментов сканирования уязвимостей.

### Причины ложных срабатываний
- **Неполная информация** - сканеры не всегда могут точно определить версию ПО или конфигурацию
- **Ограниченный контекст** - автоматизированные инструменты не понимают бизнес-логику приложения
- **Неправильные сигнатуры** - ошибки в базах уязвимостей или правилах обнаружения
- **Патчи и исправления** - система может быть обновлена, но сканер не распознает это
- **Кастомные конфигурации** - нестандартные настройки, снижающие уязвимость

### Категории ложных срабатываний
- **Полные ложные срабатывания** - уязвимость не существует вовсе
- **Частичные ложные срабатывания** - уязвимость существует, но не такая, как определено сканером
- **Устаревшие срабатывания** - уязвимость была устранена, но не отражена в результатах

### Методы проверки ложных срабатываний
- **Ручная проверка** - проверка уязвимости с помощью специалиста по безопасности
- **Использование разных инструментов** - сравнение результатов нескольких сканеров
- **Анализ логов и конфигураций** - проверка версий ПО и настроек системы
- **Тестирование эксплуатации** - попытка воспроизвести уязвимость в контролируемой среде

### Снижение ложных срабатываний
- **Калибровка инструментов** - настройка параметров сканирования под конкретную среду
- **Обновление баз уязвимостей** - использование актуальных сигнатур
- **Комбинирование автоматических и ручных методов** - двойная проверка критических результатов
- **Документирование исключений** - ведение списка известных ложных срабатываний

> [!warning]
> Игнорирование потенциальных ложных срабатываний может привести к пропуску реальных уязвимостей, но чрезмерное внимание к ним может отвлечь от реальных угроз.

## Приоритезация уязвимостей

Приоритезация уязвимостей - это процесс определения порядка устранения выявленных уязвимостей на основе рисков, которые они представляют для организации. Эффективная приоритезация позволяет оптимизировать ресурсы и сосредоточиться на наиболее критичных проблемах.

### Методы приоритезации

#### CVSS (Common Vulnerability Scoring System)
- Стандартизированная система оценки уязвимостей
- Оценивает уязвимости по шкале от 0.0 до 10.0
- Учитывает как технические, так и средовые факторы
- Позволяет сравнивать уязвимости между собой

#### Матрица рисков
- Комбинирует вероятность эксплуатации и потенциальный ущерб
- Обычно использует квадранты: низкий, средний, высокий, критический
- Учитывает бизнес-факторы и контекст системы

#### Метод DREAD
- Оценивает уязвимости по пяти критериям:
  - **D**amage (ущерб)
  - **R**eproducibility (воспроизводимость)
  - **E**xploitability (эксплуатируемость)
  - **A**ffected users (затронутые пользователи)
  - **D**iscoverability (обнаруживаемость)

#### Контекстно-зависимая приоритезация
- Учитывает специфику бизнеса и архитектуры
- Оценивает влияние на критические бизнес-процессы
- Учитывает чувствительность обрабатываемых данных

### Факторы приоритезации

#### Технические факторы
- Уровень доступа, который может быть получен
- Возможность эскалации привилегий
- Потенциал для атаки на другие системы
- Наличие публичных эксплойтов

#### Бизнес-факторы
- Критичность системы для бизнеса
- Тип обрабатываемых данных
- Влияние на репутацию компании
- Соответствие требованиям нормативных актов

#### Факторы эксплуатации
- Доступность уязвимости из внешней сети
- Сложность эксплуатации уязвимости
- Наличие известных атак в дикой природе
- Время с момента публикации уязвимости

### Практические рекомендации
- Сочетайте автоматическую и ручную приоритезацию
- Регулярно пересматривайте приоритеты уязвимостей
- Учитывайте контекст системы и бизнес-процессов
- Используйте комбинацию методов для более точной оценки

> [!tip]
> Приоритезация должна быть гибкой и адаптироваться к изменяющимся условиям и новой информации о рисках.

## Интеграция с CI/CD

Интеграция сканирования уязвимостей в CI/CD (Continuous Integration/Continuous Deployment) процессы позволяет выявлять уязвимости на ранних этапах разработки, что значительно снижает стоимость их устранения и повышает общую безопасность приложений.

### Этапы интеграции

#### Интеграция в CI (Continuous Integration)
- Сканирование исходного кода на наличие уязвимостей
- Проверка зависимостей проекта на известные уязвимости
- Статический анализ безопасности (SAST)
- Проверка конфигураций и файлов на потенциальные угрозы

#### Интеграция в CD (Continuous Deployment)
- Сканирование образов контейнеров
- Проверка безопасности конфигураций развертывания
- Динамическое тестирование безопасности (DAST)
- Сканирование запущенных контейнеров в тестовой среде

### Инструменты для интеграции

#### Для сканирования исходного кода
- **SonarQube** - интеграция через плагины и сканеры
- **Checkmarx** - предоставляет CLI для интеграции с CI/CD
- **Semgrep** - быстрый статический анализатор с поддержкой CI/CD
- **ESLint с плагинами безопасности** - для JavaScript/TypeScript проектов

#### Для сканирования зависимостей
- **Snyk** - интеграция с большинством систем CI/CD
- **npm audit** - для Node.js проектов
- **OWASP Dependency-Check** - универсальный инструмент для проверки зависимостей
- **Retire.js** - специализированный сканер для JavaScript зависимостей

#### Для сканирования контейнеров
- **Trivy** - легко интегрируется в CI/CD с поддержкой различных форматов вывода
- **Clair** - интеграция через API и CLI
- **Anchore** - предоставляет CLI и плагины для различных систем
- **Docker Scout** - интеграция с Docker-окружениями

### Практические рекомендации

#### Настройка политик безопасности
- Определение пороговых значений для прохождения сборки
- Настройка блокировки сборки при наличии критических уязвимостей
- Создание исключений для известных и контролируемых уязвимостей
- Настройка уведомлений для разных уровней уязвимостей

#### Оптимизация производительности
- Кэширование результатов сканирования
- Использование параллельных задач для разных типов сканирования
- Настройка сканирования только для измененных файлов
- Использование легковесных сканеров на ранних этапах

#### Обработка результатов
- Интеграция с системами отслеживания задач
- Генерация отчетов для команд разработки
- Автоматическое создание issue с результатами сканирования
- Настройка уведомлений для ответственных лиц

> [!warning]
> Интеграция инструментов безопасности в CI/CD может замедлить процесс сборки. Важно найти баланс между безопасностью и скоростью разработки.

## Отчетность

Отчетность по результатам сканирования уязвимостей является важной частью процесса обеспечения безопасности, позволяющей отслеживать состояние безопасности системы и демонстрировать прогресс в устранении уязвимостей.

### Компоненты эффективного отчета

#### Исполнительное резюме
- Общее количество обнаруженных уязвимостей
- Распределение по уровням критичности
- Сравнение с предыдущими отчетами
- Ключевые риски и рекомендации

#### Подробная информация по уязвимостям
- Идентификаторы уязвимостей (CVE, CWE)
- Описание уязвимости и потенциального воздействия
- Пораженные компоненты системы
- Рекомендации по устранению

#### Статистика и метрики
- Время устранения уязвимостей
- Среднее время жизни уязвимости
- Эффективность процесса устранения
- Тенденции безопасности во времени

#### Рекомендации по улучшению
- Предложения по улучшению процессов
- Рекомендации по обучению персонала
- Предложения по автоматизации
- Планы по улучшению безопасности

### Форматы отчетов

#### Интерактивные дашборды
- Визуализация данных с помощью графиков и диаграмм
- Возможность фильтрации и детализации
- Реальное время обновления данных
- Интеграция с системами мониторинга

#### Автоматические отчеты
- Регулярные отчеты (ежедневные, еженедельные, ежемесячные)
- Автоматическая генерация и рассылка
- Интеграция с корпоративными системами
- Поддержка различных форматов (PDF, HTML, JSON)

#### Отчеты для разных аудиторий
- Технические отчеты для инженеров
- Управленческие отчеты для руководства
- Комплианс-отчеты для аудиторов
- Публичные отчеты для заинтересованных сторон

### Лучшие практики отчетности

#### Четкость и понятность
- Использование понятного языка для разных аудиторий
- Визуализация данных для лучшего восприятия
- Структурированное представление информации
- Ясные рекомендации по действиям

#### Актуальность и регулярность
- Регулярное обновление данных
- Своевременная доставка отчетов
- Сравнение с предыдущими периодами
- Отслеживание прогресса в устранении

#### Конфиденциальность и безопасность
- Защита отчетов в соответствии с политиками безопасности
- Ограничение доступа к конфиденциальной информации
- Шифрование при передаче и хранении
- Управление версиями отчетов

> [!tip]
> Отчетность должна быть не просто формальностью, а инструментом принятия решений, который помогает улучшать уровень безопасности организации.

## Лучшие практики

Следование лучшим практикам при сканировании уязвимостей позволяет повысить эффективность процесса и обеспечить более высокий уровень безопасности. Ниже приведены ключевые рекомендации:

### Подготовка и планирование

#### Определение области охвата
- Проведение инвентаризации всех активов
- Классификация систем по уровню критичности
- Учет облачных и локальных ресурсов
- Регулярное обновление списка систем для сканирования

#### Установление частоты сканирования
- Ежедневное сканирование для критических систем
- Сканирование при каждом коммите в репозиторий
- Периодическое сканирование всей инфраструктуры
- Адаптация частоты в зависимости от изменений

### Выбор и настройка инструментов

#### Комбинирование подходов
- Использование нескольких инструментов для повышения точности
- Комбинация автоматизированных и ручных методов
- Сканирование с разных точек зрения (белый, серый, черный ящик)
- Регулярное обновление баз уязвимостей

#### Настройка инструментов
- Калибровка инструментов под конкретную среду
- Настройка параметров для снижения ложных срабатываний
- Оптимизация времени и ресурсов для сканирования
- Интеграция с существующими системами безопасности

### Анализ и интерпретация результатов

#### Проверка достоверности
- Подтверждение уязвимостей ручным тестированием
- Использование нескольких источников для проверки
- Анализ контекста системы при оценке рисков
- Документирование процесса проверки

#### Приоритезация
- Использование стандартизированных методов оценки (CVSS)
- Учет бизнес-влияния при определении приоритетов
- Регулярный пересмотр приоритетов уязвимостей
- Учет доступности эксплойтов и угроз в дикой природе

### Интеграция в процессы

#### Внедрение в CI/CD
- Сканирование кода и зависимостей на каждом коммите
- Интеграция с системами управления задачами
- Блокировка сборки при критических уязвимостях
- Автоматическое создание задач для разработчиков

#### Управление уязвимостями
- Создание процесса устранения уязвимостей
- Назначение ответственных лиц за устранение
- Установка SLA для устранения уязвимостей разного уровня
- Мониторинг прогресса устранения

### Обучение и осведомленность

#### Обучение команд
- Регулярное обучение по безопасности разработчиков
- Обучение операционных команд по анализу уязвимостей
- Обмен знаниями внутри команды безопасности
- Проведение тренингов по безопасной разработке

#### Создание культуры безопасности
- Интеграция безопасности в процесс разработки
- Поощрение инициатив, связанных с безопасностью
- Обратная связь по результатам сканирования
- Прозрачность в вопросах безопасности

> [!tip]
> Лучшие практики должны адаптироваться под конкретную организацию и регулярно пересматриваться в свете новых угроз и технологий.

## Примеры сканирования

Рассмотрим несколько практических примеров сканирования уязвимостей в различных сценариях:

### Пример 1: Сканирование веб-приложения с помощью OWASP ZAP

```bash
# Базовое сканирование веб-приложения
docker run -t owasp/zap2docker-stable zap-baseline.py -t https://example.com -g gen.conf -r report.html

# Расширенное сканирование с аутентификацией
docker run -v $(pwd):/zap/wrk/:rw -t owasp/zap2docker-stable zap-baseline.py \
  -t https://example.com \
  -I \
  --auto-auth \
  --auth-url https://example.com/login \
  --auth-username user@example.com \
  --auth-password securepassword \
  -g gen.conf \
  -r report.html
```

Этот пример показывает сканирование веб-приложения с использованием OWASP ZAP как в базовом, так и в расширенном режиме с аутентификацией. Использование Docker позволяет изолировать сканирование и обеспечивает воспроизводимость результатов.

### Пример 2: Сканирование зависимостей Node.js проекта

```json
// package.json
{
  "name": "example-app",
  "scripts": {
    "security-check": "npm audit --audit-level high",
    "security-fix": "npm audit fix"
  },
  "dependencies": {
    "express": "^4.18.0",
    "lodash": "^4.17.21"
  }
}
```

```bash
# Проверка уязвимостей в зависимостях
npm audit

# Проверка с фильтрацией по уровню критичности
npm audit --audit-level high

# Автоматическое устранение уязвимостей (где возможно)
npm audit fix

# Генерация отчета в формате JSON для последующей обработки
npm audit --json > audit-report.json
```

Этот пример демонстрирует проверку уязвимостей в зависимостях Node.js проекта с использованием встроенного инструмента npm audit. Это важный этап в процессе CI/CD для выявления уязвимостей в используемых библиотеках.

### Пример 3: Сканирование Docker образа с помощью Trivy

```bash
# Сканирование Docker образа на наличие уязвимостей
trivy image my-app:latest

# Сканирование с выводом в формате JSON
trivy image --format json --output result.json my-app:latest

# Сканирование файловой системы
trivy fs --security-checks vuln,config /path/to/project

# Сканирование репозитория на наличие секретов
trivy config --security-checks secret /path/to/project
```

Trivy - мощный инструмент для сканирования уязвимостей в контейнерах и файловой системах. Он поддерживает различные форматы вывода и может быть легко интегрирован в CI/CD процессы.

### Пример 4: Сканирование исходного кода с помощью SonarQube

```yaml
# .github/workflows/sonarqube.yml
name: SonarQube Scan
on:
  push:
    branches: [ main, develop ]
  pull_request:
    types: [ opened, synchronize, reopened ]

jobs:
  sonarqube:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 0  # Shallow clones should be disabled for a better relevancy of analysis
    - name: SonarQube Scan
      uses: SonarSource/sonarqube-scan-action@master
      env:
        SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
        SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
```

Этот пример показывает интеграцию SonarQube в GitHub Actions для автоматического сканирования исходного кода при каждом пуше или пул-реквесте. SonarQube анализирует код на наличие уязвимостей, багов и проблем с качеством кода.

### Пример 5: Сканирование сети с помощью Nmap и NSE

```bash
# Базовое сканирование портов
nmap -sV -sC target-host.com

# Расширенное сканирование с использованием скриптов NSE
nmap --script vuln target-host.com

# Сканирование конкретных уязвимостей
nmap --script http-sql-injection,http-xssed target-host.com

# Сканирование диапазона IP-адресов
nmap -sV -O 192.168.1.0/24
```

Nmap с NSE (Nmap Scripting Engine) позволяет проводить детальное сканирование сетевой инфраструктуры и выявлять потенциальные уязвимости на сетевом уровне.

> [!info]
> Все примеры следует адаптировать под конкретную среду и требования безопасности организации. Важно тестировать скрипты и команды в изолированной среде перед использованием в производственной инфраструктуре.

## Мониторинг уязвимостей

Мониторинг уязвимостей - это непрерывный процесс отслеживания состояния безопасности систем и выявления новых угроз. Он включает в себя не только регулярное сканирование, но и анализ изменений, тенденций и новых угроз.

### Компоненты системы мониторинга

#### Централизованный реестр уязвимостей
- Хранение информации обо всех обнаруженных уязвимостях
- Отслеживание статуса устранения
- Классификация по типам и уровням критичности
- Интеграция с системами управления задачами

#### Система оповещений
- Автоматические уведомления о новых уязвимостях
- Оповещения о просроченных задачах по устранению
- Уведомления о критических уязвимостях
- Интеграция с корпоративными системами коммуникации

#### Панель мониторинга
- Визуализация текущего состояния безопасности
- Отображение тенденций и статистики
- Индикаторы эффективности процесса устранения
- Сравнение с предыдущими периодами

### Методы мониторинга

#### Пассивный мониторинг
- Регулярное сканирование по расписанию
- Анализ логов безопасности
- Мониторинг патчей и обновлений
- Отслеживание новых CVE и уязвимостей

#### Активный мониторинг
- Непрерывное сканирование критических систем
- Реагирование на события безопасности
- Автоматическое тестирование после изменений
- Мониторинг в реальном времени

### Индикаторы эффективности (KPI)

#### Временные метрики
- Среднее время обнаружения уязвимости
- Среднее время устранения уязвимости
- Время жизни критических уязвимостей
- Частота сканирования

#### Количественные метрики
- Общее количество обнаруженных уязвимостей
- Количество устраненных уязвимостей
- Процент уязвимостей, устраненных в срок
- Количество ложных срабатываний

#### Качественные метрики
- Уровень зрелости процесса безопасности
- Процент автоматизации процессов
- Количество инцидентов, связанных с уязвимостями
- Уровень осведомленности команды о безопасности

### Интеграция с другими системами

#### SIEM (Security Information and Event Management)
- Интеграция результатов сканирования с SIEM
- Корреляция уязвимостей с событиями безопасности
- Анализ рисков на основе уязвимостей и активности
- Создание инцидентов на основе критических уязвимостей

#### ITSM (IT Service Management)
- Интеграция с системами управления задачами (Jira, ServiceNow)
- Автоматическое создание тикетов на устранение
- Отслеживание статуса устранения
- Управление изменениями в контексте безопасности

#### Asset Management
- Синхронизация инвентаря активов
- Приоритезация уязвимостей на основе критичности активов
- Отслеживание жизненного цикла систем
- Учет устаревших систем и технологий

> [!tip]
> Эффективный мониторинг уязвимостей требует не только регулярного сканирования, но и анализа тенденций, оценки эффективности принимаемых мер и постоянного улучшения процессов.

## Связанные темы

- [[Анализ-безопасности]]
- [[Тестирование-безопасности]]
- [[Управление-уязвимостями]]
- [[Пентестинг]]
- [[Сканеры-уязвимостей]]
- [[Безопасная-разработка]]
- [[Мониторинг-безопасности]]
- [[Реагирование-на-инциденты]]
- [[Безопасность-веб-приложений]]
- [[Безопасность-контейнеров]]
- [[Безопасность-API]]
- [[Криптографическая-безопасность]]
- [[Аутентификация-и-авторизация]]
- [[Сетевая-безопасность]]
- [[Безопасность-облачных-сервисов]]
- [[Сканеры-SAST]]
- [[Сканеры-DAST]]
- [[Сканеры-SCA]]
- [[Сканеры-контейнеров]]
- [[Кибербезопасность]]
- [[Сетевая-безопасность]]
- [[Безопасность-баз-данных]]
- [[Безопасность-мобильных-приложений]]

## Ссылки и ресурсы

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CVSS Specification](https://www.first.org/cvss/)
- [NVD - National Vulnerability Database](https://nvd.nist.gov/)
- [SANS Institute - Vulnerability Assessment](https://www.sans.org/white-papers/)
- [MITRE ATT&CK Framework](https://attack.mitre.org/)
- [Common Vulnerabilities and Exposures (CVE)](https://cve.mitre.org/)
- [Common Weakness Enumeration (CWE)](https://cwe.mitre.org/)
- [Vulnerability Detection with Nmap NSE](https://nmap.org/book/nse.html)
- [OWASP ZAP Documentation](https://www.zaproxy.org/docs/)
- [Trivy Vulnerability Scanner](https://aquasecurity.github.io/trivy/)
- [SonarQube Security](https://www.sonarqube.org/features/security/)
- [Snyk Vulnerability Database](https://snyk.io/vulnerability-database/)